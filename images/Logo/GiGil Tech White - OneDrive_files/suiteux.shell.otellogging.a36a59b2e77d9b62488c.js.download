var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_otellogging_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["otellogging"],{74141:function(e,n,t){t.r(n),t.d(n,{initializeLogging:function(){return vi}});var r=t(59312);var i,o=(i=[],{fireEvent:function(e){i.forEach((function(n){return n(e)}))},addListener:function(e){e&&i.push(e)}});function a(e,n,t){o.fireEvent({level:e,category:n,message:t})}function s(e,n,t){a(0,e,(function(){var e=t instanceof Error?t.message:"";return n+": "+e}))}var u,c={};!function(e){var n=9007199254740991,t=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,r=/^[a-zA-Z0-9_\.]{1,95}$/;function i(e){return r.test(e)}function o(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!i(e.name))throw new Error("Invalid dataField name");2===e.dataType&&a(e.value)}))}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>n)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;return t.test(e)}(e.eventName))throw new Error("Invalid eventName");var n=e.eventContract;if(n){if(n.name&&!i(n.name))throw new Error("Invalid eventContract");o(n.dataFields)}o(e.dataFields)},e.validateInt=a}(u||(u={}));function l(e,n){return{name:e,dataType:1,value:n,classification:4}}function f(e,n){return{name:e,dataType:2,value:n,classification:4}}function d(e,n){return{name:e,dataType:0,value:n,classification:4}}function v(e){var n={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.pi)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp};return e.eventContract&&(n.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),n}var p=function(){function e(e,n,t){var i,o;this.telemetrySinks=[],this.persistentDataFields=[],this.eventQueue=[],this.config=t||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,r.pi)((0,r.pi)({},e.getConfig()),this.config)),n&&(o=this.persistentDataFields).push.apply(o,n)}return e.prototype.sendTelemetryEvent=function(e){var n=v(e),t=n.telemetryProperties;if(t.customerContentVersion||t.customerContentType)a(0,0,(function(){return"Customer content"}));else{if(!t.ariaTenantToken||!t.nexusTenantToken){var r=function(e){for(var n=e.length;n>0;){var t=e.substr(0,n);if(c[t])return c[t];n=e.lastIndexOf(".",n-1)}}(n.eventName);if(!r)return void a(0,0,(function(){return"No tenant token: "+e.eventName}));t.ariaTenantToken=r.ariaTenantToken,t.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(n)}},e.prototype.sendCustomerContent=function(e){var n=v(e),t=n.telemetryProperties;return(!t.customerContentVersion||t.customerContentVersion>1)&&(t.customerContentVersion=1),t.ariaTenantToken=void 0,t.nexusTenantToken=void 0,n.dataFields.push(f("EventContent.Type",2)),this.sendTelemetryEventInternal(n)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):a(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void s(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(n){var t=e.telemetryProperties;t.customerContentVersion&&t.customerContentType?n.sendCustomerContent&&n.sendCustomerContent(e):n.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var n,t;e.dataFields&&(null===(t=e.dataFields)||void 0===t||t.unshift(d("OTelJS.Version","4.3.4")),this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.config.disableValidation||u.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,n=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&n.forEach((function(n){e.sendTelemetryEventInternal(n)}))},e.prototype.setTenantToken=function(e,n,t){!function(e,n){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?c[e]=n:a(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:n,nexusTenantToken:t})},e.prototype.cloneEvent=function(e){return v(e)},e.prototype.getConfig=function(){return this.config},e}();function h(e,n,t,r){t&&r.push(d(e+"."+n,t))}function g(e,n,t,r){"boolean"==typeof t&&r.push(l(e+"."+n,t))}function y(e,n,t,r){"number"==typeof t&&r.push(f(e+"."+n,t))}var m,C=function(e){var n="Activity.Result",t=[];return y(n,"Code",e.code,t),h(n,"Type",e.type,t),y(n,"Tag",e.tag,t),g(n,"IsExpected",e.isExpected,t),t.push(d("zC.Activity.Result","Office.System.Result")),t},T={contractName:"Office.System.Activity",getFields:function(e){var n="Activity",t=[];return h(n,"CV",e.cV,t),y(n,"Duration",e.duration,t),y(n,"Count",e.count,t),y(n,"AggMode",e.aggMode,t),g(n,"Success",e.success,t),e.result&&t.push.apply(t,C(e.result)),t.push(d("zC.Activity",this.contractName)),t}},S=function(e){var n="User",t=[];return h(n,"PrimaryIdentityHash",e.primaryIdentityHash,t),h(n,"PrimaryIdentitySpace",e.primaryIdentitySpace,t),h(n,"TenantId",e.tenantId,t),h(n,"TenantGroup",e.tenantGroup,t),g(n,"IsAnonymous",e.isAnonymous,t),t},x=function(e){var n="App",t=[];return h(n,"Name",e.name,t),h(n,"Platform",e.platform,t),h(n,"Version",e.version,t),t},w=function(e){var n=[];return h("Session","Id",e.id,n),n};!function(e){var n,t=0;e.getNext=function(){return void 0===n&&(n=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=22,t=[],r=0;r<n;r++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(n,++t)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,n){this.base=e,this.id=n,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(m||(m={}));var b=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(b=function(){return 1e3*Math.floor(window.performance.now())});var I=function(e){var n,t=b(),r=v(e.telemetryEvent);return{cv:e.parentCv?m.getNextChild(e.parentCv):m.getNext(),eventName:e.telemetryEvent.eventName,dataFields:r.dataFields,eventFlags:r.eventFlags,telemetryProperties:r.telemetryProperties,createChildActivity:function(n){return I({telemetryEvent:n,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,n,t){this.result={code:e,type:n,tag:t}},endNow:function(){if(!n){void 0===this.success&&void 0===this.result&&a(1,0,(function(){return"Activity does not have success or result set"}));var r=b();n=!0;var i={duration:r-t,count:1,aggMode:0,cV:this.cv.getString(),success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,T.getFields(i)),this.eventContract={name:T.contractName,dataFields:o},e.sendTelemetryEvent(this)}a(0,0,(function(){return"Already ended"}))}}},_=function(e){var n=[];return n.push(d("Error.ErrorGroup",e.errorGroup)),n.push(f("Error.Tag",e.tag)),void 0!==e.code&&n.push(f("Error.Code",e.code)),void 0!==e.id&&n.push(f("Error.Id",e.id)),void 0!==e.count&&n.push(f("Error.Count",e.count)),n},E=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.createActivity=function(e){return function(e,n){return I({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendTelemetryEvent(n)}})}(this,e)},n.prototype.sendActivity=function(e,n,t,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:T.contractName,dataFields:T.getFields(n)},dataFields:t,eventFlags:r})},n.prototype.sendError=function(e){var n=_(e.error);return null!=e.dataFields&&n.push.apply(n,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:n,eventFlags:e.eventFlags})},n.prototype.createCustomerContentActivity=function(e){return function(e,n){return I({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendCustomerContent(n)}})}(this,e)},n}(p),k="function",P="object",F="undefined";function N(){return typeof globalThis!==F&&globalThis?globalThis:typeof self!==F&&self?self:typeof window!==F&&window?window:typeof t.g!==F&&t.g?t.g:null}function M(e){var n=Object.create;if(n)return n(e);if(null==e)return{};var t=typeof e;if(t!==P&&t!==k)throw new TypeError("Object prototype may only be an Object:"+e);function r(){}return r.prototype=e,new r}function O(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}var D=function(e,n){return D=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},D(e,n)};function A(e,n){function t(){this.constructor=e}D(e,n),e.prototype=null===n?M(n):(t.prototype=n.prototype,new t)}var L,R,B,K=N()||{};R=O,B=A,(L=K).__assign||(L.__assign=Object.assign||R),L.__extends||(L.__extends=B),__assign||(__assign=K.__assign),__extends||(__extends=K.__extends);
/*!
 * Microsoft Dynamic Proto Utility, 1.1.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var z="constructor",U="prototype",q="function",H="_dynClass",V="_unknown_",j=Object,W=j.getPrototypeOf,Q=0;function G(e,n){return e&&j.prototype.hasOwnProperty.call(e,n)}function J(e){return e&&(e===j.prototype||e===Array.prototype)}function X(e){return J(e)||e===Function.prototype}function Z(e){if(e){if(W)return W(e);var n=e.__proto__||e.prototype||e.constructor;if(n)return n}return null}function $(e,n){var t=[],r=j.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"==typeof i&&G(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function Y(e,n,t){return n!==z&&typeof e[n]===q&&(t||G(e,n))}function ee(e){throw new TypeError("DynamicProto: "+e)}function ne(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function te(e,n,t,r){var i=null;if(e&&G(t,H)){var o=e._dynInstFuncs||{};if((i=(o[t._dynClass]||{})[n])||ee("Missing ["+n+"] "+q),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!G(e,n),s=Z(e),u=[];a&&s&&!X(s)&&!ne(u,s);){var c=s[n];if(c){a=c===r;break}u.push(s),s=Z(s)}try{a&&(e[n]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function re(e,n,t){var r=n[e];return r===t&&(r=Z(n)[e]),typeof r!==q&&ee("["+e+"] is not a "+q),r}function ie(e,n,t,r,i){if(!J(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),$(t,(function(n){Y(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!G(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function(){return(te(this,n,e,t)||re(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function oe(e,n){return G(e,U)?e.name||n||V:((e||{}).constructor||{}).name||n||V}function ae(e,n,t,r){G(e,U)||ee("theClass is an invalid class definition.");var i=e.prototype;(function(e,n){for(var t=Z(n);t&&!X(t);){if(t===e)return!0;t=Z(t)}return!1})(i,n)||ee("["+oe(e)+"] is not in class hierarchy of ["+oe(n)+"]");var o=null;G(i,H)?o=i._dynClass:(o="_dynCls$"+oe(e,"_")+"$"+Q,Q++,i._dynClass=o);var a=ae._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var n={};return $(e,(function(t){!n[t]&&Y(e,t,!1)&&(n[t]=e[t])})),n}(n),c=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};$(t,(function(e){o[e]=i(n,t,e)}));for(var a=Z(e),s=[];a&&!X(a)&&!ne(s,a);)$(a,(function(e){!o[e]&&Y(a,e,!W)&&(o[e]=i(n,a,e))})),s.push(a),a=Z(a);return o}(i,n,u,s);t(n,c);var l=!!W&&!!a.setInstFuncs;l&&r&&(l=!!r.setInstFuncs),ie(i,o,n,u,!1!==l)}ae._dfOpts={setInstFuncs:!0,useBaseInst:!0};var se=ae,ue=Object,ce=ue.prototype,le=ce.hasOwnProperty,fe=ue.defineProperty,de=ue.assign;ue.freeze,ue.seal;function ve(e){return ce.toString.call(e)}function pe(e){return void 0===e||typeof e===F}function he(e){return null===e||pe(e)}function ge(e){return!he(e)}function ye(e,n){return e&&le.call(e,n)}function me(e){return typeof e===P}function Ce(e){return typeof e===k}function Te(e,n,t,r){void 0===r&&(r=!1);var i=!1;if(!he(e))try{he(e.addEventListener)?he(e.attachEvent)||(e.attachEvent("on"+n,t),i=!0):(e.addEventListener(n,t,r),i=!0)}catch(e){}return i}function Se(e,n,t,r){if(void 0===r&&(r=!1),!he(e))try{he(e.removeEventListener)?he(e.detachEvent)||e.detachEvent("on"+n,t):e.removeEventListener(n,t,r)}catch(e){}}function xe(e,n){if(e)for(var t in e)le.call(e,t)&&n.call(e,t,e[t])}function we(e,n){if(e&&n){var t=n.length,r=e.length;if(e===n)return!0;if(r>=t){for(var i=r-1,o=t-1;o>=0;o--){if(e[i]!=n[o])return!1;i--}return!0}}return!1}function be(e,n){var t=!1;if(e&&n){var r=n.length;if(e===n)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==n[i])return!1;t=!0}}return t}function Ie(e,n){return!(!e||!n)&&-1!==e.indexOf(n)}function _e(e){return"[object Date]"===ve(e)}function Ee(e){return"[object Array]"===ve(e)}function ke(e){return"[object Error]"===ve(e)}function Pe(e){return"string"==typeof e}function Fe(e){return"number"==typeof e}function Ne(e){return"boolean"==typeof e}function Me(e){if(_e(e)){var n=function(e){var n=String(e);return 1===n.length&&(n="0"+n),n};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function Oe(e,n,t){for(var r=e.length,i=0;i<r&&(!(i in e)||-1!==n.call(t||e,e[i],i,e));i++);}function De(e,n,t){for(var r=e.length,i=t||0,o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===n)return o;return-1}function Ae(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}({toString:null}).propertyIsEnumerable("toString");function Le(e,n,t,r){if(fe)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),r&&(i.set=r),fe(e,n,i),!0}catch(e){}return!1}function Re(){var e=Date;return e.now?e.now():(new e).getTime()}function Be(e,n,t,r,i){var o=t;return e&&((o=e[n])===t||i&&!i(o)||r&&!r(t)||(o=t,e[n]=o)),o}function Ke(e){return!e}function ze(e){return!!e}function Ue(e){throw new Error(e)}function qe(e){return e&&(e=ue(de?de({},e):e)),e}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var He,Ve=function(){function e(n,t,r){var i,o=this,a=!1;(o.start=Re(),o.name=n,o.isAsync=r,o.isChildEvt=function(){return!1},Ce(t))&&(a=Le(o,"payload",(function(){return!i&&Ce(t)&&(i=t(),t=null),i})));o.getCtx=function(n){return n?n===e.ParentContextKey||n===e.ChildrenContextKey?o[n]:(o.ctx||{})[n]:null},o.setCtx=function(n,t){if(n)if(n===e.ParentContextKey)o[n]||(o.isChildEvt=function(){return!0}),o[n]=t;else if(n===e.ChildrenContextKey)o[n]=t;else{(o.ctx=o.ctx||{})[n]=t}},o.complete=function(){var n=0,r=o.getCtx(e.ChildrenContextKey);if(Ee(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(n+=s.time)}o.time=Re()-o.start,o.exTime=o.time-n,o.complete=function(){},!a&&Ce(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),je=function e(n){this.ctx={},se(e,this,(function(e){e.create=function(e,n,t){return new Ve(e,n,t)},e.fire=function(e){e&&(e.complete(),n&&n.perfEvent(e))},e.setCtx=function(n,t){n&&((e.ctx=e.ctx||{})[n]=t)},e.getCtx=function(n){return(e.ctx||{})[n]}}))},We="CoreUtils.doPerf";function Qe(e,n,t,r,i){if(e){var o=e;if(o&&Ce(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(We);try{if(a=o.create(n(),r,i)){if(s&&a.setCtx&&(a.setCtx(Ve.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(Ve.ChildrenContextKey);u||(u=[],s.setCtx(Ve.ChildrenContextKey,u)),u.push(a)}return o.setCtx(We,a),t(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx(We,s)}}}return t()}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(He||(He={}));var Ge={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103},Je=F,Xe=P,Ze="window",$e="JSON",Ye="msie",en="trident/",nn=null,tn=null,rn=!1;var on=N;function an(e){var n=on();return n&&n[e]?n[e]:e===Ze&&sn()?window:null}function sn(){return Boolean(typeof window===Xe&&window)}function un(){return sn()?window:an(Ze)}function cn(){return Boolean(typeof document===Xe&&document)?document:an("document")}function ln(){return Boolean(typeof navigator===Xe&&navigator)}function fn(){return ln()?navigator:an("navigator")}function dn(e){if(e&&rn){var n=an("__mockLocation");if(n)return n}return typeof location===Xe&&location?location:an("location")}function vn(){return Boolean(typeof JSON===Xe&&JSON||null!==an($e))}function pn(){return vn()?JSON||an($e):null}function hn(){var e=fn();return!(!e||!e.product)&&"ReactNative"===e.product}function gn(){var e=fn();if(e&&(e.userAgent!==tn||null===nn)){var n=((tn=e.userAgent)||"").toLowerCase();nn=Ie(n,Ye)||Ie(n,en)}return nn}function yn(e){var n=Object.prototype.toString.call(e),t="";return"[object Error]"===n?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":vn()&&(t=pn().stringify(e)),n+t}function mn(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var Cn=function(){function e(e,n,t,r){void 0===t&&(t=!1);var i=this;i.messageId=e,i.message=(t?"AI: ":"AI (Internal): ")+e;var o="";vn()&&(o=pn().stringify(r));var a=(n?" message:"+mn(n):"")+(r?" props:"+mn(o):"");i.message+=a}return e.dataType="MessageData",e}();var Tn=function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t=0,r={};se(e,this,(function(e){function i(e,t){var r=n[e];return he(r)?t:r}he(n)&&(n={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(n,t,i,o,a){void 0===a&&(a=!1);var s=new Cn(t,i,a,o);if(e.enableDebugExceptions())throw s;if(!pe(s)&&s&&!pe(s.message)){var u=e.consoleLoggingLevel();if(a){var c=+s.messageId;!r[c]&&u>=He.WARNING&&(e.warnToConsole(s.message),r[c]=!0)}else u>=He.WARNING&&e.warnToConsole(s.message);e.logInternalMessage(n,s)}},e.warnToConsole=function(e){var n=typeof console!==Je?console:an("console");if(n){var t="log";n.warn&&(t="warn"),Ce(n[t])&&n[t](e)}},e.resetInternalMessageCount=function(){t=0,r={}},e.logInternalMessage=function(n,i){if(!(t>=e.maxInternalMessageLimit())){var o=!0,a="AITR_"+i.messageId;if(r[a]?o=!1:r[a]=!0,o&&(n<=e.telemetryLoggingLevel()&&(e.queue.push(i),t++),t===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",u=new Cn(Ge.MessageLimitPerPVExceeded,s,!1);e.queue.push(u),e.warnToConsole(s)}}}}))},Sn=function(e,n){var t=this,r=null,i=Ce(e.processTelemetry),o=Ce(e.setNextPlugin);t._hasRun=!1,t.getPlugin=function(){return e},t.getNext=function(){return r},t.setNext=function(e){r=e},t.processTelemetry=function(a,s){s||(s=n);var u=e?e.identifier:"TelemetryPluginChain";Qe(s?s.core():null,(function(){return u+":processTelemetry"}),(function(){if(e&&i){t._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(t){var n=r&&r._hasRun;r&&n||s.diagLog().throwInternal(He.CRITICAL,Ge.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+t),r&&!n&&r.processTelemetry(a,s)}}else r&&(t._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function xn(e,n){var t=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&Ce(o.processTelemetry)){var a=new Sn(o,n);t.push(a),r&&r.setNext(a),r=a}}return t.length>0?t[0]:null}var wn=function e(n,t,r,i){var o=this,a=null;null!==i&&(n&&Ce(n.getPlugin)?a=function(e,n,t){var r=[],i=!t;if(e)for(;e;){var o=e.getPlugin();(i||o===t)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(t),xn(r,n)}(n,o,i||n.getPlugin()):i?a=function(e,n,t){var r=e,i=!1;return t&&e&&(r=[],Oe(e,(function(e){(i||e===t)&&(i=!0,r.push(e))}))),t&&!i&&(r||(r=[]),r.push(t)),xn(r,n)}(n,o,i):pe(i)&&(a=xn(n,o))),o.core=function(){return r},o.diagLog=function(){return function(e,n){return(e||{}).logger||new Tn(n)}(r,t)},o.getCfg=function(){return t},o.getExtCfg=function(e,n){var r;if(void 0===n&&(n={}),t){var i=t.extensionConfig;i&&e&&(r=i[e])}return r||n},o.getConfig=function(e,n,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!he(a[n])?i=a[n]:t&&!he(t[n])&&(i=t[n]),he(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var n=a;n&&(a=n.getNext(),n.processTelemetry(e,o))},o.createNew=function(n,i){return void 0===n&&(n=null),new e(n||a,t,r,i)}},bn="extensionConfig",In=function(){function e(){var e=this,n=!1,t=null,r=null;e.core=null,e.diagLog=function(n){return e._getTelCtx(n).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(e){n=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,n){n?n.processNext(e):r&&Ce(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(n){void 0===n&&(n=null);var i=n;if(!i){var o=t||new wn(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&Be(i,bn,[],null,he),!s&&o&&(s=o.getProcessTelContext().getNext());var u=r;r&&r.getPlugin&&(u=r.getPlugin()),e.core=o,t=new wn(s,i,o,u),n=!0}}return e.prototype.initialize=function(e,n,t,r){this._baseTelInit(e,n,t,r)},e}();function _n(e,n){for(var t=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&Ce(r.setNextPlugin)&&Ce(o.processTelemetry)&&r.setNextPlugin(o),Ce(o.isInitialized)&&o.isInitialized()||t.push(o),r=o,i=i.getNext())}Oe(t,(function(t){t.initialize(e.getCfg(),e.core(),n,e.getNext())}))}function En(e){return e.sort((function(e,n){var t=0,r=Ce(n.processTelemetry);return Ce(e.processTelemetry)?t=r?e.priority-n.priority:1:r&&(t=-1),t}))}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var kn=500,Pn=function(e){function n(){var t,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){Oe(e,(function(e){e.priority<kn&&Ue("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,n){return e.priority-n.priority}))),t.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,se(n,r,(function(e,n){e.setNextPlugin=function(e){},e.processTelemetry=function(e,n){t&&Oe(t,(function(t){t.length>0&&r._getTelCtx(n).createNew(t).processNext(e)}))},e.getChannelControls=function(){return t},e.initialize=function(r,o,a){e.isInitialized()||(n.initialize(r,o,a),function(e,n){t=[],e&&Oe(e,(function(e){return i(e)}));if(n){var r=[];Oe(n,(function(e){e.priority>kn&&r.push(e)})),i(r)}}((r||{}).channels,a),Oe(t,(function(e){return _n(new wn(e,r,o),a)})))}})),r}var t;return __extends(n,e),n._staticInit=(Le(t=n.prototype,"ChannelControls",t.getChannelControls),void Le(t,"channelQueue",t.getChannelControls)),n}(In),Fn="toGMTString",Nn="toUTCString",Mn="expires",On="",Dn=null,An=null,Ln=null,Rn=cn(),Bn={},Kn={};function zn(e){return!e||e.isEnabled()}function Un(e,n){var t=function(e){var n=e.cookieCfg=e.cookieCfg||{};if(Be(n,"domain",e.cookieDomain,ge,he),Be(n,"path",e.cookiePath||"/",null,he),he(n.enabled)){var t=void 0;pe(e.isCookieUseDisabled)||(t=!e.isCookieUseDisabled),pe(e.disableCookiesUsage)||(t=!e.disableCookiesUsage),n.enabled=t}return n}(e||Kn),r=t.path||"/",i=t.domain,o=!1!==t.enabled,a={isEnabled:function(){var e=o&&qn(n),t=Kn._ckMgr;return e&&t&&a!==t&&(e=zn(t)),e},setEnabled:function(e){o=!1!==e},set:function(e,n,o,s,u){if(zn(a)){var c={},l=Ae(n||On),f=l.indexOf(";");if(-1!==f&&(l=Ae(n.substring(0,f)),c=Hn(n.substring(f+1))),Be(c,"domain",s||i,ze,pe),!he(o)){var d=gn();if(pe(c.expires)){var v=Re()+1e3*o;if(v>0){var p=new Date;p.setTime(v),Be(c,Mn,Vn(p,d?Fn:Nn)||Vn(p,d?Fn:Nn)||On,ze)}}d||Be(c,"max-age",On+o,null,pe)}var h=dn();h&&"https:"===h.protocol&&(Be(c,"secure",null,null,pe),null===An&&(An=!Gn((fn()||{}).userAgent)),An&&Be(c,"SameSite","None",null,pe)),Be(c,"path",u||r,null,pe),(t.setCookie||Qn)(e,jn(l,c))}},get:function(e){var n=On;return zn(a)&&(n=(t.getCookie||Wn)(e)),n},del:function(e,n){zn(a)&&a.purge(e,n)},purge:function(e,r){if(qn(n)){var i=((o={}).path=r||"/",o.expires="Thu, 01 Jan 1970 00:00:01 GMT",o);gn()||(i["max-age"]="0"),(t.delCookie||Qn)(e,jn(On,i))}var o}};return a._ckMgr=a,a}function qn(e){if(null===Dn){Dn=!1;try{Dn=void 0!==(Rn||{}).cookie}catch(t){e&&e.throwInternal(He.WARNING,Ge.CannotAccessCookie,"Cannot access document.cookie - "+(ke(n=t)?n.name:""),{exception:yn(t)})}}var n;return Dn}function Hn(e){var n={};e&&e.length&&Oe(Ae(e).split(";"),(function(e){if(e=Ae(e||On)){var t=e.indexOf("=");-1===t?n[e]=null:n[Ae(e.substring(0,t))]=Ae(e.substring(t+1))}}));return n}function Vn(e,n){return Ce(e[n])?e[n]():null}function jn(e,n){var t=e||On;return xe(n,(function(e,n){t+="; "+e+(he(n)?On:"="+n)})),t}function Wn(e){var n=On;if(Rn){var t=Rn.cookie||On;Ln!==t&&(Bn=Hn(t),Ln=t),n=Ae(Bn[e]||On)}return n}function Qn(e,n){Rn&&(Rn.cookie=e+"="+n)}function Gn(e){return!!Pe(e)&&(!(!Ie(e,"CPU iPhone OS 12")&&!Ie(e,"iPad; CPU OS 12"))||(!!(Ie(e,"Macintosh; Intel Mac OS X 10_14")&&Ie(e,"Version/")&&Ie(e,"Safari"))||(!(!Ie(e,"Macintosh; Intel Mac OS X 10_14")||!we(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!Ie(e,"Chrome/5")&&!Ie(e,"Chrome/6"))||(!(!Ie(e,"UnrealEngine")||Ie(e,"Chrome"))||!(!Ie(e,"UCBrowser/12")&&!Ie(e,"UCBrowser/11")))))))}
/*!
 * Application Insights JavaScript SDK - Core, 2.6.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Jn=0,Xn=1,Zn=2,$n=4,Yn=5,et=function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;se(e,this,(function(e){e.addNotificationListener=function(n){e.listeners.push(n)},e.removeNotificationListener=function(n){for(var t=De(e.listeners,n);t>-1;)e.listeners.splice(t,1),t=De(e.listeners,n)},e.eventsSent=function(n){Oe(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(n)}),0)}))},e.eventsDiscarded=function(n,t){Oe(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(n,t)}),0)}))},e.eventsSendRequest=function(n,t){Oe(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(t)setTimeout((function(){return e.eventsSendRequest(n,t)}),0);else try{e.eventsSendRequest(n,t)}catch(e){}}))},e.perfEvent=function(n){n&&(!t&&n.isChildEvt()||Oe(e.listeners,(function(e){if(e&&e.perfEvent)if(n.isAsync)setTimeout((function(){return e.perfEvent(n)}),0);else try{e.perfEvent(n)}catch(e){}})))}}))},nt=function(e){function n(){var t=e.call(this)||this;return se(n,t,(function(e,n){function t(n){var t=e.getNotifyMgr();t&&t.eventsDiscarded([n],Zn)}e.initialize=function(e,t,r,i){n.initialize(e,t,r||new Tn(e),i||new et(e))},e.track=function(r){Qe(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(t(r),Ue("Invalid telemetry item")),function(e){if(he(e.name))throw t(e),Error("telemetry name required")}(r),n.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.addNotificationListener(n)},e.removeNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.removeNotificationListener(n)},e.pollInternalLogs=function(n){var t=e.config.diagnosticLogInterval;return t&&t>0||(t=1e4),setInterval((function(){var t=e.logger?e.logger.queue:[];Oe(t,(function(t){var r={name:n||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:Me(new Date),baseType:Cn.dataType,baseData:{message:t.message}};e.track(r)})),t.length=0}),t)}})),t}return __extends(n,e),n}((function e(){var n,t,r,i,o,a=!1;se(e,this,(function(e){e._extensions=new Array,t=new Pn,e.logger=M({throwInternal:function(e,n,t,r,i){void 0===i&&(i=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),n=[],e.isInitialized=function(){return a},e.initialize=function(n,i,o,s){var u,c,l,f;e.isInitialized()&&Ue("Core should not be initialized more than once"),n&&!he(n.instrumentationKey)||Ue("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=n||{},n.extensions=he(n.extensions)?[]:n.extensions,(c=bn,(u=n)?!(f=u[c])&&he(f)&&(f=pe(l)?{}:l,u[c]=f):f=pe(l)?{}:l,f).NotificationManager=s,o&&(e.logger=o);var d=[];d.push.apply(d,i.concat(n.extensions)),d=En(d);var v=[],p=[],h={};Oe(d,(function(e){(he(e)||he(e.initialize))&&Ue("Extensions must provide callback to initialize");var n=e.priority,r=e.identifier;e&&n&&(he(h[n])?h[n]=r:o.warnToConsole("Two extensions have same priority #"+n+" - "+h[n]+", "+r)),!n||n<t.priority?v.push(e):p.push(e)})),d.push(t),v.push(t),d=En(d),e._extensions=d,_n(new wn([t],n,e),d),_n(new wn(v,n,e),d),e._extensions=v,0===e.getTransmissionControls().length&&Ue("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return t.getChannelControls()},e.track=function(t){Be(t,"iKey",e.config.instrumentationKey,null,Ke),Be(t,"time",Me(new Date),null,Ke),Be(t,"ver","4.0",null,he),e.isInitialized()?e.getProcessTelContext().processNext(t):n.push(t)},e.getProcessTelContext=function(){var n=e._extensions,r=n;return n&&0!==n.length||(r=[t]),new wn(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=M({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,n){},eventsSendRequest:function(e,n){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return o||(o=Un(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&(i=new je(e.getNotifyMgr())),i},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){n.length>0&&(Oe(n,(function(n){e.getProcessTelContext().processNext(n)})),n=[])}}))})),tt=0,rt=13,it=32,ot=1,at=2,st=3,ut=4,ct=0,lt=1,ft=6,dt=7,vt=O(O({},Ge),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),pt=4294967296,ht=4294967295,gt=!1,yt=123456789,mt=987654321;function Ct(e){e<0&&(e>>>=0),yt=123456789+e&ht,mt=987654321-e&ht,gt=!0}function Tt(){try{var e=2147483647&Re();Ct((Math.random()*pt^e)+e)}catch(e){}}function St(e){return e>0?Math.floor(xt()/ht*(e+1))>>>0:0}function xt(e){var n,t=an("crypto")||an("msCrypto");return t&&t.getRandomValues?n=t.getRandomValues(new Uint32Array(1))[0]&ht:gn()?(gt||Tt(),n=wt()&ht):n=Math.floor(pt*Math.random()|0),e||(n>>>=0),n}function wt(e){var n=((mt=36969*(65535&mt)+(mt>>16)&ht)<<16)+(65535&(yt=18e3*(65535&yt)+(yt>>16)&ht))>>>0&ht|0;return e||(n>>>=0),n}function bt(e,n){var t=!1,r=un();r&&(t=Te(r,e,n),t=Te(r.body,e,n)||t);var i=cn();return i&&(t=Pt.Attach(i,e,n)||t),t}function It(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(kt,(function(e){var n=0|St(15);return("x"===e?n:3&n|8).toString(16)}))}function _t(){var e=an("performance");return e&&e.now?e.now():Re()}var Et,kt=/[xy]/g,Pt={Attach:Te,AttachEvent:Te,Detach:Se,DetachEvent:Se};
/**
 * Utils.ts
 * @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 * File containing utility functions.
 */
var Ft="1DS-Web-JS-3.1.1",Nt=((Et={})[0]=ct,Et[2]=ft,Et[1]=lt,Et[3]=dt,Et[4098]=ft,Et[4097]=lt,Et[4099]=dt,Et),Mt=null,Ot=(Boolean(cn()),Boolean(un()));function Dt(e){return!(""===e||he(e))}function At(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return""}function Lt(){return null===Mt&&(Mt=ln()&&Boolean(fn().sendBeacon)),Mt}function Rt(e){return!!(e&&Fe(e)&&e>=ot&&e<=ut)}function Bt(e,n,t){if(!n&&!Dt(n)||"string"!=typeof e)return null;var r=typeof n;if("string"===r||"number"===r||"boolean"===r||Ee(n))n={value:n};else if("object"!==r||n.hasOwnProperty("value")){if(he(n.value)||""===n.value||!Pe(n.value)&&!Fe(n.value)&&!Ne(n.value)&&!Ee(n.value))return null}else n={value:t?JSON.stringify(n):n};if(Ee(n.value)&&!jt(n.value))return null;if(!he(n.kind)){if(Ee(n.value)||!Vt(n.kind))return null;n.value=n.value.toString()}return n}function Kt(){if(void 0!==typeof XMLHttpRequest){var e=an("XMLHttpRequest");if(e){var n=new e;return Boolean(pe(n.withCredentials)&&void 0!==typeof XDomainRequest)}}}function zt(e,n,t){var r=-1;if(!pe(e))if(n>0&&(32===n?r=8192:n<=13&&(r=n<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(t))-1===r&&(r=0),r|=t;else{var i=Nt[Gt(e)]||-1;-1!==r&&-1!==i?r|=i:i===ft&&(r=i)}return r}function Ut(e){void 0===e&&(e="D");var n=It();return"B"===e?n="{"+n+"}":"P"===e?n="("+n+")":"N"===e&&(n=n.replace(/-/g,"")),n}function qt(e,n,t,r,i){var o={},a=!1,s=0,u=arguments.length,c=Object.prototype,l=arguments;for("[object Boolean]"===c.toString.call(l[0])&&(a=l[0],s++);s<u;s++){xe(e=l[s],(function(e,n){a&&n&&me(n)?Ee(n)?(o[e]=o[e]||[],Oe(n,(function(n,t){n&&me(n)?o[e][t]=qt(!0,o[e][t],n):o[e][t]=n}))):o[e]=qt(!0,o[e],n):o[e]=n}))}return o}var Ht=_t;function Vt(e){return e===tt||e>tt&&e<=rt||e===it}function jt(e){return e.length>0}function Wt(e){var n=bt("beforeunload",e);return n=bt("unload",e)||n,n=bt("pagehide",e)||n}function Qt(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=Ht()}function Gt(e){var n=0;if(null!=e){var t=typeof e;"string"===t?n=1:"number"===t?n=2:"boolean"===t?n=3:t===P&&(n=4,Ee(e)?(n=4096,e.length>0&&(n|=Gt(e[0]))):ye(e,"value")&&(n=8192|Gt(e.value)))}return n}var Jt=function(e){function n(){var t=e.call(this)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",se(n,t,(function(e,n){e.initialize=function(t,r,i,o){Qe(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=t.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");t.channels&&Oe(t.channels,(function(n){n&&Oe(n,(function(n){if(n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&Oe(r,(function(n){if(n&&n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{n.initialize(t,r,i,o)}catch(n){e.logger.throwInternal(He.CRITICAL,vt.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:t,extensions:r,logger:i,notificationManager:o}}))},e.track=function(t){Qe(e,(function(){return"AppInsightsCore.track"}),(function(){var r=t;if(r){r.timings=r.timings||{},r.timings.trackStart=Ht(),Rt(r.latency)||(r.latency=ot);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=Ft;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}n.track(r)}),(function(){return{item:t}}),!t.sync)}})),t}return A(n,e),n}(nt),Xt=Jt,Zt="REAL_TIME",$t=function(){function e(n,t){var r=t?[].concat(t):[],i=this;i.iKey=function(){return n},i.count=function(){return r.length},i.events=function(){return r},i.addEvents=function(e,n){return void 0===n&&(n=!0),e&&e.length>0?(r=n?r.concat(e):e.concat(r),e.length):0},i.split=function(t,i){var o=new e(n);if(t<r.length){var a=r.length-t;he(i)||(a=i<a?i:a),o.addEvents(r.splice(t,a),!0)}return o}}return e.create=function(n,t){return new e(n,t)},e}(),Yt="constructor",er="prototype",nr="function",tr="_dynClass",rr="_unknown_",ir=Object,or=ir.getPrototypeOf,ar=0;function sr(e,n){return e&&ir.prototype.hasOwnProperty.call(e,n)}function ur(e){return e&&(e===ir.prototype||e===Array.prototype)}function cr(e){return ur(e)||e===Function.prototype}function lr(e){if(e){if(or)return or(e);var n=e.__proto__||e.prototype||e.constructor;if(n)return n}return null}function fr(e,n){var t=[],r=ir.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"==typeof i&&sr(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function dr(e,n,t){return n!==Yt&&typeof e[n]===nr&&(t||sr(e,n))}function vr(e){throw new TypeError("DynamicProto: "+e)}function pr(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function hr(e,n,t,r){var i=null;if(e&&sr(t,tr)){var o=e._dynInstFuncs||{};if((i=(o[t._dynClass]||{})[n])||vr("Missing ["+n+"] "+nr),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!sr(e,n),s=lr(e),u=[];a&&s&&!cr(s)&&!pr(u,s);){var c=s[n];if(c){a=c===r;break}u.push(s),s=lr(s)}try{a&&(e[n]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function gr(e,n,t){var r=n[e];return r===t&&(r=lr(n)[e]),typeof r!==nr&&vr("["+e+"] is not a "+nr),r}function yr(e,n,t,r,i){if(!ur(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),fr(t,(function(n){dr(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!sr(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function(){return(hr(this,n,e,t)||gr(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function mr(e,n){return sr(e,er)?e.name||n||rr:((e||{}).constructor||{}).name||n||rr}function Cr(e,n,t,r){sr(e,er)||vr("theClass is an invalid class definition.");var i=e.prototype;(function(e,n){for(var t=lr(n);t&&!cr(t);){if(t===e)return!0;t=lr(t)}return!1})(i,n)||vr("["+mr(e)+"] is not in class hierarchy of ["+mr(n)+"]");var o=null;sr(i,tr)?o=i._dynClass:(o="_dynCls$"+mr(e,"_")+"$"+ar,ar++,i._dynClass=o);var a=Cr._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var n={};return fr(e,(function(t){!n[t]&&dr(e,t,!1)&&(n[t]=e[t])})),n}(n),c=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};fr(t,(function(e){o[e]=i(n,t,e)}));for(var a=lr(e),s=[];a&&!cr(a)&&!pr(s,a);)fr(a,(function(e){!o[e]&&dr(a,e,!or)&&(o[e]=i(n,a,e))})),s.push(a),a=lr(a);return o}(i,n,u,s);t(n,c);var l=!!or&&!!a.setInstFuncs;l&&r&&(l=!!r.setInstFuncs),yr(i,o,n,u,!1!==l)}Cr._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Tr=Cr,Sr=2e6,xr=Math.min(Sr,65e3),wr=/\./,br=function e(n,t,r,i){var o="data",a="baseData",s=!!i,u=t,c={};Tr(e,this,(function(e){function t(e,n,i,o,a,l,f){xe(e,(function(e,d){var v=null;if(d||Dt(d)){var p=i,h=e,g=a,y=n;if(s&&!o&&wr.test(e)){var m=e.split("."),C=m.length;if(C>1){g&&(g=g.slice());for(var T=0;T<C-1;T++){var S=m[T];y=y[S]=y[S]||{},p+="."+S,g&&g.push(S)}h=m[C-1]}}var x=o&&function(e,n){var t=c[e];return void 0===t&&(e.length>=7&&(t=be(e,"ext.metadata")||be(e,"ext.web")),c[e]=t),t}(p);if(v=!x&&u&&u.handleField(p,h)?u.value(p,h,d,r):Bt(h,d,r)){var w=v.value;if(y[h]=w,l&&l(g,h,v),f&&"object"==typeof w&&!Ee(w)){var b=g;b&&(b=b.slice()).push(h),t(d,w,p+"."+h,o,b,l,f)}}}}))}e.createPayload=function(e,n,t,r){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&Qe(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=r.events(),o=t.payloadBlob,a=t.numEvents,s=!1,u=[],c=t.isBeacon,l=c?65e3:3984588,f=c?xr:Sr,d=0,v=0;d<n.length;){var p=n[d];if(p){if(a>=i){t.overflow=r.split(d);break}var h=e.getEventBlob(p);if(h.length<=f){var g=h.length;if(o.length+g>l){t.overflow=r.split(d);break}o&&(o+="\n"),o+=h,++v>20&&(o.substr(0,1),v=0),s=!0,a++}else u.push(p),n.splice(d,1),d--}d++}if(u&&u.length>0&&t.sizeExceed.push($t.create(r.iKey(),u)),s){t.batches.push(r),t.payloadBlob=o,t.numEvents=a;var y=r.iKey();-1===De(t.apiKeys,y)&&t.apiKeys.push(y)}}),(function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){return Qe(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+At(e.iKey);var r={},i=e.ext;i&&(n.ext=r,xe(i,(function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)})));var s=n.data={};s.baseType=e.baseType;var u=s.baseData={};return t(e.baseData,u,a,!1,[a],(function(e,n,t){Ir(r,e,n,t)}),!0),t(e.data,s,o,!1,[],(function(e,n,t){Ir(r,e,n,t)}),!0),JSON.stringify(n)}),(function(){return{item:e}}))}}))};function Ir(e,n,t,r){if(r&&e){var i=zt(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),n)for(var s=0;s<n.length;s++){var u=n[s];a[u]||(a[u]={f:{}});var c=a[u].f;c||(c=a[u].f={}),a=c}a=a[t]={},Ee(r.value)?a.a={t:i}:a.t=i}}}
/*!
 * 1DS JS SDK POST plugin, 3.1.1
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* RetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var _r,Er=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)},e}(),kr=function e(){var n={};Tr(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=(a=e.split(","),s=[],a&&Oe(a,(function(e){s.push(Ae(e))})),s);if("this-request-only"===t)return r;for(var i=1e3*parseInt(t,10),o=0;o<r.length;++o)n[r[o]]=Re()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var t=n,r=Ae(e);return void 0!==t[r]&&t[r]>Re()||(delete t[r],!1)}}))},Pr=function e(){var n=!0,t=!0,r=!0,i="use-collector-delta",o=!1;Tr(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,t=!0,o=!0):t=!1,n=!0)}}))},Fr="POST",Nr="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Mr="drop",Or="send",Dr="requeue",Ar="rspFail",Lr="kill-duration",Rr="time-delta-millis",Br=((_r={})[1]=Dr,_r[100]=Dr,_r[200]="sent",_r[8004]=Mr,_r[8003]=Mr,_r);function Kr(e){try{return e.responseText}catch(e){}return""}var zr=function e(n,t,r,i){this._responseHandlers=[];var o,a,s,u,c="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-3.1.1",l=new kr,f=!1,d=new Pr,v=!1,p=0,h=!0,g=[],y={},m=[],C=null,T=!1;Tr(e,this,(function(e){var S=!0;function x(e,n){var t=new XDomainRequest;t.open(Fr,e.urlString),t.onload=function(){var e=Kr(t);I(n,200,{},e),R(e)},t.onerror=function(){I(n,400,{})},t.ontimeout=function(){I(n,500,{})},t.send(e.data)}function w(e,n){var t;fetch(e.urlString,(t={body:e.data,method:Fr,credentials:"include"},t[Nr]=!0,t.headers=e.headers,t)).then((function(e){var t={},r="";e.headers&&e.headers.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){r=e})),I(n,e.status,t,r),R(r)})).catch((function(e){I(n,0,{})}))}function b(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=Ae(r))}return e}function i(e){var n,t,i={};return e.getAllResponseHeaders?(n=e.getAllResponseHeaders(),t={},Pe(n)&&Oe(Ae(n).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=Ae(e.substring(0,n)).toLowerCase(),i=Ae(e.substring(n+1));t[r]=i}else t[Ae(e)]=1}})),i=t):(i=r(i,e,Rr),i=r(i,e,Lr),i=r(i,e,"kill-duration-seconds")),i}function o(e,t){I(n,e.status,i(e),t)}var a=new XMLHttpRequest;try{a[Nr]=!0}catch(e){}S&&(a.withCredentials=!0),a.open(Fr,e.urlString,!t),xe(e.headers,(function(e,n){a.setRequestHeader(e,n)})),a.onload=function(){var e=Kr(a);o(a,e),R(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function I(e,n,t,r){try{e(n,t,r)}catch(e){o.diagLog().throwInternal(He.WARNING,vt.SendPostOnCompleteFailure,e)}}function _(){return!f&&p<t}function E(){var e=m;return m=[],e}function k(e,n,t){var r=!1;return e&&e.length>0&&!f&&a&&C&&(r=n||_()&&(t>0||d.allowRequestSending())),r}function P(e){var n={};return e&&Oe(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function F(e,t,r,i,o,a){if(e&&0!==e.length)if(f)B(e,1,i);else{var u=e;Qe(s,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var u=[],c=null,f=Ht();k(e,i,t);){var d=e.shift();d&&d.count()>0&&(l.isTenantKilled(d.iKey())?u.push(d):(c=c||C.createPayload(t,r,i,a&&M()),C.appendPayload(c,d,n)?null!==c.overflow&&(e=[c.overflow].concat(e),c.overflow=null,D(c,f,Ht(),o),f=Ht(),c=null):(D(c,f,Ht(),o),f=Ht(),e=[d].concat(e),c=null)))}c&&D(c,f,Ht(),o),e.length>0&&(m=e.concat(m)),B(u,8004,i)}),(function(){return{batches:P(u),retryCount:t,isTeardown:r,isSynchronous:i,sendReason:o,useSendBeacon:a}}),!i)}}function N(e){var n=c,t="";Oe(e.apiKeys,(function(e){t.length>0&&(t+=","),t+=e})),t.length>0&&(n+="&apikey="+t),n+="&upload-time="+Re().toString();var r=function(e){for(var n=0;n<e.batches.length;n++)for(var t=e.batches[n].events(),r=0;r<t.length;r++){var i=(t[r].ext||{}).intweb||{};if(Dt(i.msfpc))return encodeURIComponent(i.msfpc)}return""}(e);if(Dt(r)&&(n=n+"&ext.intweb.msfpc="+r),d.shouldAddClockSkewHeaders()&&(n+="&time-delta-to-apply-millis="+d.getClockSkewHeaderValue()),s.getWParam){var i=s.getWParam();i>=0&&(n+="&w="+i)}for(var o=0;o<g.length;o++)n+="&"+g[o].name+"="+g[o].value;return n}function M(){return!h&&v&&Lt()}function O(e,n,t){e[n]=e[n]||{},e[n][o.identifier]=t}function D(n,t,i,u){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var c=N(n),f=Ht();Qe(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var v=0;v<n.batches.length;v++)for(var h=n.batches[v].events(),g=0;g<h.length;g++){var m=h[g];if(T){var S=m.timings=m.timings||{};O(S,"sendEventStart",f),O(S,"serializationStart",t),O(S,"serializationCompleted",i)}m.sendAttempt>0?m.sendAttempt++:m.sendAttempt=1}B(n.batches,1e3+(u||0),n.isSync,!0);var x={data:n.payloadBlob,urlString:c,headers:y},w=null,b=!!e.sendHook;M()&&n.isBeacon?(b=!1,w=function(t){!function(e,n,t){try{if(Lt()){var r=fn();if(r.sendBeacon(e.urlString,e.data))return void A(n,200,t,!1);var i=null;Oe(n.batches,(function(n){if(i&&n&&n.count()>0){for(var t=n.events(),o=0;o<t.length;o++)if(!r.sendBeacon(e.urlString,C.getEventBlob(t[o]))){i.push(n.split(o));break}}else i.push(n.split(0))})),A(n,200,t,!1),B(i,8003,n.isSync,!0)}}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(t,n,u),e.sendListener&&e.sendListener(x,t,n.isSync||n.isTeardown,!0)}):a&&(w=function(t){d.firstRequestSent();var i=function(e,t){!function(e,n,t,i){var o=9e3,a=null,s=!1,u=!1;try{var c=!0;if(typeof e!==Je){if(n){d.setClockSkew(n[Rr]);var f=n["kill-duration"]||n["kill-duration-seconds"];Oe(l.setKillSwitchTenants(n["kill-tokens"],f),(function(e){Oe(t.batches,(function(n){if(n.iKey()===e){a=a||[];var r=n.split(0);t.numEvents-=r.count(),a.push(r)}}))}))}if(200===e)return void(o=200);(!Er.shouldRetryForStatus(e)||t.numEvents<=0)&&(c=!1),o=9e3+e%1e3}if(c){o=100;var v=t.retryCnt;t.isSync||(v<r?(s=!0,L((function(){t.isSync||p--,F(t.batches,v+1,t.isTeardown,t.isSync,5,t.isBeacon)}),!0,Er.getMillisToBackoffForRetry(v))):u=!0)}}finally{s||(d.setClockSkew(),A(t,o,i,u)),B(a,8004,t.isSync)}}(e,t,n,u)};try{a.sendPOST(t,i,n.isTeardown||n.isSync),e.sendListener&&e.sendListener(x,t,n.isSync||n.isTeardown,!1)}catch(e){I(i,0,{})}}),Qe(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(w)if(n.isSync||p++,b){var t={data:x.data,urlString:x.urlString,headers:x.headers},r=!1;Qe(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){r=!0,w(e)}),n.isSync||n.isTeardown)}catch(e){r||w(x)}}))}else w(x)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:i,sendReason:u}}),n.isSync)}B(n.sizeExceed,8003,n.isSync)}function A(n,t,r,i){try{i&&o._backOffTransmission(),200===t&&(i||n.isSync||o._clearBackOff(),function(e){if(T){var n=Ht();Oe(e,(function(e){var t,r;e&&e.count()>0&&(t=e.events(),r=n,T&&Oe(t,(function(e){O(e.timings=e.timings||{},"sendEventCompleted",r)})))}))}}(n.batches)),B(n.batches,t,n.isSync,!0)}finally{n.isSync||(p--,5!==r&&e.sendQueuedRequests(r,!n.isSync,n.isBeacon))}}function L(e,n,t){n?e():o._setTimeoutOverride(e,t)}function R(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){o.diagLog().throwInternal(He.CRITICAL,vt.PostResponseHandler,"Response handler failed: "+e)}if(n){var i=JSON.parse(n);Dt(i.webResult)&&Dt(i.webResult.msfpc)&&u.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function B(e,n,t,r){if(e&&e.length>0&&i){var a=i[(u=n,c=Br[u],Dt(c)||(c="oth",u>=9e3&&u<=9999?c=Ar:u>=8e3&&u<=8999?c=Mr:u>=1e3&&u<=1999&&(c=Or)),c)];a&&Qe(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){L((function(){try{a.call(i,e,n,t)}catch(e){o.diagLog().throwInternal(He.CRITICAL,vt.NotificationException,"send request notification failed: "+e)}}),r||t,0)}),(function(){return{batches:P(e),reason:n,isSync:t,sendSync:r}}),!t)}var u,c}e.initialize=function(e,n,t,r,i){i||(i={}),c=e+c,s=n,u=n.getCookieMgr(),T=!s.config.disableEventTimings;var l=!!s.config.enableCompoundKey;o=t;var f=i.valueSanitizer,d=i.stringifyObjects;if(pe(i.enableCompoundKey)||(l=!!i.enableCompoundKey),C=new br(s,f,d,l),!(a=r)){h=!1,v=!hn();var p=dn();p&&p.protocol&&"file:"===p.protocol.toLowerCase()&&(S=!1);var g=null;Kt()?g=x:hn()?g=w:"undefined"!=typeof XMLHttpRequest&&(g=b),a={sendPOST:g}}},e._getDbgPlgTargets=function(){return[a,l,C]},e.addQueryStringParameter=function(e,n){for(var t=0;t<g.length;t++)if(g[t].name===e)return void(g[t].value=n);g.push({name:e,value:n})},e.addHeader=function(e,n){y[e]=n},e.canSendRequest=function(){return _()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,n,t){var r=!he(n)&&!n;k(m,r,0)&&F(E(),0,!1,r,e||0,!!t)},e.isCompletelyIdle=function(){return!f&&0===p&&0===m.length},e.addBatch=function(e){if(e&&e.count()>0){if(l.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&F(E(),0,!0,!0,2,!0)},e.pause=function(){f=!0},e.resume=function(){f=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&F([e],0,!1,!0,n||0,!!t)}}))},Ur=zr,qr=Ot?window:void 0,Hr="eventsDiscarded",Vr=function(e){function n(){var t,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.1.1";var i,o,a,s,u,c=!1,l=[],f=null,d=!1,v=0,p=500,h=0,g=1e4,y={},m=Zt,C=null,T=null,S=0,x=0,w={},b=-1;return Tr(n,r,(function(e,n){function r(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=ot),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.ext=qe(e.ext),e.baseData&&(e.baseData=qe(e.baseData)),e.data&&(e.data=qe(e.data)),e.sync)if(S||d)e.latency=st,e.sync=!1;else if(o)return e=qe(e),void o.sendSynchronousBatch($t.create(e.iKey,[e]),3);var t=e.latency,r=h,i=g;t===ut&&(r=v,i=p);var a=!1;if(r<i)a=!O(e,n);else{var s=ot,u=20;t===ut&&(s=ut,u=1),a=!0,function(e,n,t,r){for(;t<=n;){var i=N(e,n,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return t===ut?v-=a:h-=a,U(Hr,[o],Yn),!0}t++}return D(),!1}(e.iKey,e.latency,s,u)&&(a=!O(e,n))}a&&z(Hr,[e],Yn)}function I(e,n,t,r){var i=A(e,n,t);return o.sendQueuedRequests(n,t,r),i}function _(){return h>0}function E(){if(b>=0&&A(b,u,!0)&&o.sendQueuedRequests(u,!0,!1),v>0&&!T&&!d){var e=y[m][2];e>=0&&(T=k((function(){T=null,I(ut,1,!0),E()}),e))}var n=y[m][1];!C&&!f&&n>=0&&!d&&(_()?C=k((function(){C=null,I(0===x?st:ot,1,!0),x++,x%=2,E()}),n):x=0)}function k(n,t){0===t&&S&&(t=1);var r=1e3;return S&&(r=Er.getMillisToBackoffForRetry(S-1)),e._setTimeoutOverride(n,t*r)}function P(){null!==C&&(e._clearTimeoutOverride(C),C=null,x=0)}function F(n,t){P(),f&&(e._clearTimeoutOverride(f),f=null),d||I(ot,n,t,!0)}function N(e,n,t){var r=w[n];r||(r=w[n=ot]);var i=r.iKeyMap[e];return!i&&t&&(i=$t.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function M(n,t){o.canSendRequest()&&!S&&(a>0&&h>a&&(t=!0),t&&null==f&&e.flush(n,null,20))}function O(e,n){var t=(e=qe(e)).latency,r=N(e.iKey,t,!0);return!!r.addEvents([e],n)&&(t!==ut?(h++,n&&0===e.sendAttempt&&M(!e.sync,s>0&&r.count()>=s)):v++,!0)}function D(){for(var e=0,n=0,t=function(t){var r=w[t];r&&r.batches&&Oe(r.batches,(function(r){t===ut?e+=r.count():n+=r.count()}))},r=ot;r<=ut;r++)t(r);h=n,v=e}function A(n,t,r){var i=!1;return!r||o.canSendRequest()?Qe(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=ut;t>=n;){var r=w[t];r&&r.batches&&(Oe(r.batches,(function(n){o.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),t===ut?v-=n.count():h-=n.count()})),r.batches=[],r.iKeyMap={}),t--}e.length>0&&z(Hr,e,$n),i&&b>=n&&(b=-1,u=0)}),(function(){return{latency:n,sendReason:t}}),r):(b=b>=0?Math.min(b,n):n,u=Math.max(u,t)),i}function L(e,n){I(ot,n,!0),R((function(){e&&e(),l.length>0?f=k((function(){return L(l.shift(),n)}),0):(f=null,_()&&E())}))}function R(e){o.isCompletelyIdle()?e():f=k((function(){R(e)}),.25)}function B(){(y={}).REAL_TIME=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function K(n,t){var r=e._notificationManager||{},i=r[n];if(i)try{i.apply(r,t)}catch(t){e.diagLog().throwInternal(He.CRITICAL,vt.NotificationException,n+" notification failed: "+t)}}function z(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&K(e,[n].concat(t))}function U(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&Oe(n,(function(n){n&&n.count()>0&&K(e,[n.events()].concat(t))}))}function q(){s=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,g/6)}B(),w[ut]={batches:[],iKeyMap:{}},w[st]={batches:[],iKeyMap:{}},w[at]={batches:[],iKeyMap:{}},w[ot]={batches:[],iKeyMap:{}},q(),o=new Ur(500,2,1,{requeue:function(n,t){var i=[];Oe(n,(function(n){n&&n.count()>0&&Oe(n.events(),(function(n){n&&(n.sync&&(n.latency=st,n.sync=!1),n.sendAttempt<6?(Qt(n,e.identifier),r(n,!1)):i.push(n))}))})),i.length>0&&z(Hr,i,Xn)},send:function(e,n,t){e&&e.length>0&&K("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])},sent:function(e,n){U("eventsSent",e,n),E()},drop:function(e,n){U(Hr,e,n>=8e3&&n<=8999?n-8e3:Jn)},rspFail:function(e){U(Hr,e,Xn),E()},oth:function(e,n){U(Hr,e,Jn),E()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,s,u){Qe(s,(function(){return"PostChannel:initialize"}),(function(){var c=s;n.initialize(r,s,u),e.setInitialized(!1);var l=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},t=l.getExtCfg(e.identifier),e._setTimeoutOverride=t.setTimeoutOverride?t.setTimeoutOverride:setTimeout.bind(qr),e._clearTimeoutOverride=t.clearTimeoutOverride?t.clearTimeoutOverride:clearTimeout.bind(qr);var f=c.getWParam;c.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},t.eventsLimitInMem>0&&(g=t.eventsLimitInMem),t.immediateEventLimit>0&&(p=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(a=t.autoFlushEventsLimit),q(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(i=t.httpXHROverride),Dt(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=t.payloadPreprocessor,o.sendListener=t.payloadListener;var d=t.overrideEndpointUrl?t.overrideEndpointUrl:r.endpointUrl;e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(d,e.core,e,i,t),Wt((function(){F(2,!1)})),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:u}}))},e.processTelemetry=function(n,i){Qt(n,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!t.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=n;a||c||(t.overrideInstrumentationKey&&(s.iKey=t.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),r(s,!0),E()),e.processNext(s,i)},e.setEventQueueLimits=function(e,n){g=e>0?e:1e4,a=n>0?n:0,q();var t=h>e;if(!t&&s>0)for(var r=ot;!t&&r<=st;r++){var i=w[r];i&&i.batches&&Oe(i.batches,(function(e){e&&e.count()>=s&&(t=!0)}))}M(!0,t)},e.teardown=function(){F(2,!1),c=!0,o.teardown()},e.pause=function(){P(),d=!0,o.pause()},e.resume=function(){d=!1,o.resume(),E()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){P(),B(),m=Zt,E(),xe(e,(function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),y[e]=n}}))},e.flush=function(e,n,t){void 0===e&&(e=!0),d||(P(),t=t||1,e?(A(ot,t,e),D(),null==f?f=k((function(){L(n,t)}),0):l.push(n)):(I(ot,t,!1),null!=n&&n()))},e.setMsaAuthTicket=function(e){o.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=_,e._setTransmitProfile=function(e){m!==e&&void 0!==y[e]&&(P(),m=e,E())},e._backOffTransmission=function(){S<4&&(S++,P(),E())},e._clearBackOff=function(){S&&(S=0,P(),E())}})),r}return A(n,e),n}(In),jr=Vr,Wr=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t){this._postChannel=new jr;var r=[];t&&(r=r.concat(t)),n.channels=[[this._postChannel]],n.extensionConfig=n.extensionConfig||[],n.extensionConfig[this._postChannel.identifier]=n.channelConfiguration?n.channelConfiguration:{};try{e.prototype.initialize.call(this,n,r)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},n.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var n=e/1e3,t=n/2,r={};r.OTelCustomTransmissionProfile=[n,t],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},n.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},n.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},n}(Xt),Qr="Data.",Gr="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function Jr(e,n,t){n&&n.forEach((function(n){if(!n.classification||4===n.classification||1===n.classification||t.customerContentEnabled&&32===n.classification){var r,i;switch(r=t.prependDataToken?"zC."===n.name.substr(0,3)?"zC.Data."+n.name.substr(3):Qr+n.name:n.name,n.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof n.value?n.value.substr(0,25e3):n.value);default:return void(e[r]=n.value)}var o={value:n.value,propertyType:i};e[r]=o}}))}function Xr(e,n){try{return e()}catch(e){return s(1,"1DS Sink",e),n}}function Zr(e){return e<10?"0"+e:e.toString()}var $r,Yr=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.identifier="PartAPlugin",n.priority=3,n._properties={},n}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t,r){e.prototype.initialize.call(this,n,t,r)},n.prototype.processTelemetry=function(e,n){e.data=qt(e.data,this._properties);var t=this._getTelCtx(n);this.processNext(e,t)},n.prototype.addDataFields=function(e){Jr(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},n}(In),ei="HttpManager:_sendBatches",ni="HttpManager:_sendBatchesNotification",ti=function(){function e(e,n,t){this.start=Date.now(),this.name=e,this.isAsync=!0===t,this.payload=n}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),ri=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,n,t){return e===ei||e===ni?new ti(e,n,t):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case ei:this.handleSendBatches(e);break;case ni:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,n){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var n=e.payload();if(n.batches&&n.reason&&n.reason>=1e3&&n.reason<=1999){var t=0;for(var r in n.batches)t+=n.batches[r].evts.length;this._callbacks.requestProcessingStats(0,t)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/"}($r||($r={}));var ii=function(){function e(){this._optionalEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._optionalEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var n=this._optionalEventsEnabled||!!e.eventFlags&&(10===e.eventFlags.diagnosticLevel||110===e.eventFlags.diagnosticLevel||120===e.eventFlags.diagnosticLevel);return n||a(2,1,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),n},e.prototype.setOptionalEventsEnabled=function(e){this._optionalEventsEnabled=e},e}(),oi=void 0,ai=function(e){function n(n,t){var r,i,o=e.call(this,n,t)||this;o.usePartAPlugin=!0;var s=new Yr,u=function(e){e&&e.addNotificationListener({eventsSent:function(e){a(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),a(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),o.eventsSent+=e.length},eventsDiscarded:function(e,n){a(0,2,(function(){return"Discarded "+e.length+" event(s) because "+n})),a(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),o.eventsDiscarded+=e.length}})};function c(e,n,t,r){var i={instrumentationKey:n,endpointUrl:t,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0},disableCookiesUsage:!0,extensionConfig:e.extensionConfig,enableCompoundKey:e.enableCompoundKey};e.stats&&e.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(n,t){var r,i=t||n;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var o=new Wr;return o.initialize(i,r),o.setUploadFrequency(e.uploadFrequency),e.notificationListener&&o.addNotificationListener(e.notificationListener),e.stats&&o.setPerfMgr(new ri(e.stats)),o}o.sendTelemetryEvent=function(e){return Xr((function(){var n=o.getOneDSTelemetryEvent(e);n&&r&&r.track(n)}),oi)},o.sendCustomerContent=function(e){return Xr((function(){var n=o.getOneDSCustomerContent(e);n&&i&&i.track(n)}),oi)},o.addPersistentDataFields=function(e){s.addDataFields(e)},o.flush=function(e){r&&r.flush(e)},o.shutdown=function(){try{r&&r.shutdown()}catch(e){a(0,2,(function(){return"An error occurred on shutdown"}))}};var l=[s];if(t.plugins&&l.push.apply(l,t.plugins),!t.endpointUrl)throw new Error("Missing Endpoint Url");return r=c(t,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",t.endpointUrl,l),t.enableCustomerContent&&t.endpointUrl===$r.PUBLIC&&(i=c(t,Gr,$r.CUSTOMER_CONTENT,l)),t.disableStatsTracking||(u(r),u(i)),o.addPersistentDataFields(n),o}return(0,r.ZT)(n,e),n}((function(e,n){var t=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var i=[],o=new ii,a={},s=Ut(),u=(new Date).getTime().toString(),c=function(e,n){if(1===n.eventType)return Gr;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},l=function(e,n){return Xr((function(){var o,l,f,d=v(e);if(function(e){for(var n=0;n<i.length;n++)if(!i[n].processEvent(e))return!1;return!0}(d)){t.eventsProcessed++;var p={"Event.Sequence":{value:t.eventsProcessed,propertyType:4},"Event.Name":d.eventName,"Event.Source":"OTelJS","Event.Time":{value:(f=e.timestamp,l=f?new Date(f):new Date,l.getUTCFullYear()+"-"+Zr(l.getUTCMonth()+1)+"-"+Zr(l.getUTCDate())+"T"+Zr(l.getUTCHours())+":"+Zr(l.getUTCMinutes())+":"+Zr(l.getUTCSeconds())+"."+(o=l.getUTCMilliseconds(),(o<10?"00"+o:o<100?"0"+o:o.toString())+"Z")),propertyType:9}};Jr(p,d.dataFields,{prependDataToken:!0,customerContentEnabled:1===n.eventType}),p["Event.Id"]=s+"."+t.eventsProcessed;var h="custom";d.eventContract&&(d.eventContract.name&&(p["Event.Contract"]=d.eventContract.name,h+="."+d.eventContract.name.toLowerCase().replace(/\./g,"_")),Jr(p,d.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===n.eventType}));var g={iKey:c(d,n),name:d.eventName,data:p,time:(new Date).toISOString(),baseType:h,ext:{sdk:{seq:t.eventsProcessed,epoch:u}}};return t.usePartAPlugin||(g.data=(0,r.pi)((0,r.pi)({},g.data),a)),g}}),void 0)};this.getOneDSTelemetryEvent=function(e){return l(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(n.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return l(e,{eventType:1})},this.addPreprocessor=function(e){i.push(e)},this.addPersistentDataFields=function(e){Jr(a,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){o.setOptionalEventsEnabled(e)},this.setFullEventsEnabled=this.setOptionalEventsEnabled,this.addPersistentDataFields(e),this.addPreprocessor(o)})),si=t(81887),ui=t(40218),ci=t(49447),li=t(94875),fi=null,di=function(){function e(e,n,t){void 0===t&&(t=5),this.serverRequestInfluxControl=t,this.otelLogger=new E,this.intentionalPageViewLogTime=null;var r=new ai(e,{endpointUrl:$r.PUBLIC});this.otelLogger.addSink(r);this.otelLogger.setTenantToken("Office.Taos.Shell",n,-1),this.serverRequestInfluxControl<0?this.serverRequestInfluxControl=0:this.serverRequestInfluxControl>100&&(this.serverRequestInfluxControl=100)}return e.prototype.registerContextParam=function(){},e.prototype.writeEvent=function(e){if(null!=e){if(e.name===si.F5.ServerRequest){var n=e.properties.filter((function(e){return"ServerRequest_Status"===e.name}));if(n.length>0&&n[0].value>=200&&n[0].value<300)if(Math.floor(100*Math.random())+1>this.serverRequestInfluxControl)return}var t=[];if(e.name===si.F5.Click){var r=void 0;null===this.intentionalPageViewLogTime||this.intentionalPageViewLogTime>e.timestamp+864e5?(this.intentionalPageViewLogTime=e.timestamp,r=!0):r=!1,t.push(l("Click_IntentionalPageView",r))}t.push(d("Event_Type",si.hi[e.type])),e.properties.forEach((function(e){switch(e.type){case 1:t.push(l(e.name,e.value));break;case 3:t.push((n=e.name,r=e.value,{name:n,dataType:3,value:r,classification:4}));break;case 4:t.push(function(e,n){return{name:e,dataType:4,value:n,classification:4}}(e.name,e.value));break;case 2:t.push(f(e.name,e.value));break;default:t.push(d(e.name,e.value))}var n,r})),this.otelLogger.sendTelemetryEvent({eventName:e.elementName?"Office.Taos.Shell."+si.F5[e.name]+"."+e.elementName:"Office.Taos.Shell."+si.F5[e.name],dataFields:t,eventFlags:{dataCategories:4,diagnosticLevel:110}})}},e}();function vi(e,n){if(null==fi){var t=si.cO.getNewID(),i=(0,ci.aH)(),o=(0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)([],x({name:"OfficeTaosShell",platform:"Web",version:window.O365ShellVerStr||"unknown"})),w({id:n.SHSID})),S({primaryIdentityHash:n.PUID,primaryIdentitySpace:n.IsConsumerShell?"MSAPUID":"OrgIdPUID",isAnonymous:!1,tenantId:n.TID,tenantGroup:n.IsConsumerShell?"Consumer":"Commercial"})),[d("Context_Env",n.Environment||"unknown"),d("Context_Site",n.WorkloadId),d("Context_SiteSubId",e.CurrentMainLinkElementID),d("Context_WorkloadAppId",(0,li.Dd)(n.WorkloadId,e.CurrentMainLinkElementID,document.URL)),d("Context_CID",ui.Eu(i.correlationID)),d("Context_PID",t),d("Context_UID",n.UID),d("Context_Language",e.CultureName),d("Context_Flights",e.FlightName),d("Context_FlightRings",n.FlightRing),d("Context_Segment",n.ActiveExperiences)]);window.O365ShellContext.SID=n.SHSID,window.O365ShellContext.PID=t,i.correlationID&&(window.O365ShellContext.CID=i.correlationID),fi=new di(o,"b0c82c6598ad49f3848b1d3dc0d8dd25-299cbfe9-b72e-4e9d-a5e3-20319efba5b5-7268",n.AriaTelemetryServerRequestInfluxControl);var a=(0,ci.jl)();a.registerService(fi),a.IsConsumer=n.IsConsumerShell}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_otellogging_end"),shellPerformance.measure("shell_otellogging","shell_otellogging_start","shell_otellogging_end"));