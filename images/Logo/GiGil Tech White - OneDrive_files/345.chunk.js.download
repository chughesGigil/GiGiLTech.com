(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[345],{4479:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return v});var r=n(0),i=n(74),s=n(147),o=n(82),u=n(625),a=n(64),f=n(417),l=(function(){function e(e,t){this._graphDataSource=t.graphDataSource;this._makeXHR=t.makeXHR||u.e.start;this._offlineDetection=t.offlineDetection}e.prototype.getContents=function(e,t){var n=this;return this._makeXHR({url:t}).then(function(t){var n=t.status;if(!(n>=200&&n<300))return i.n.reject(t);try{var r=JSON.parse(t.responseText).metadata,s=r.delimiter,o=r.error,u=r.list,f=void 0===u?[]:u;return{delimiter:s,error:o,root:{children:f,date:e.dateModified,extension:e.extension,isFolder:!0,name:e.name,childCount:f.length,parentFolder:void 0,path:"",size:0}}}catch(e){return i.n.reject(new a.e({code:n+".InvalidResponse",message:e&&e.message,correlationId:c(t),isExpected:!0,extraData:{responseText:t.responseText}}))}}).catch(function(e){if(e instanceof a.e)return i.n.reject(e);var t,r=!1,s=e&&e.message,o="GetZipContents";if(e instanceof XMLHttpRequest){var u=e&&e.status;r=!!u&&u>=400&&u<500;u&&!n._offlineDetection.offline||(r=!0);t=c(e);o=e.getResponseHeader("X-ErrorCode")||"";try{for(var f=JSON.parse(e.responseText),l=f&&f.error;l.innererror;)l=l.innererror;if(l){s=l.message;o=l.code}}catch(t){s=e.responseText?"Invalid JSON response":"Empty response";r=!0}o=u+"."+o}return i.n.reject(new a.e({code:o,message:s,isExpected:r,correlationId:t,extraData:{responseText:e instanceof XMLHttpRequest?e.responseText:""}}))})};return e})();function c(e){return e.getResponseHeader("X-CorrelationId")||void 0}Object(s.s)("ZipDataSource",l,{graphDataSource:o.b,makeXHR:void 0,offlineDetection:f.e});var h=n(26),p=n(129),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._isOneDriveWinApp=Object(p.e)();return r}t.prototype.getContents=function(t,n){var r=this;return n?i.n.resolve().then(function(){if(t.queryType===h.e.SharedWithMe&&r._isOneDriveWinApp&&r._graphDataSource.refreshAccessToken)return r._graphDataSource.refreshAccessToken(t)}).then(function(i){var s=i&&i.accessToken;n.indexOf("access_token")<0&&s&&(n=n+"&access_token="+s);return e.prototype.getContents.call(r,t,n)}):i.n.reject(new Error("No data."))};return t})(l),v=(t.default=d,Object(s.s)("ZipDataSource",d,{graphDataSource:o.b,makeXHR:void 0,offlineDetection:f.e}))}}]);