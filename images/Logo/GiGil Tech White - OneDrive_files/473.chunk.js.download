(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[473],Array(1143).concat([function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"i",function(){return N});n.d(t,"s",function(){return k});n.d(t,"e",function(){return L});n.d(t,"n",function(){return A});n.d(t,"o",function(){return O});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(624),v=n(2052),m=n(403),g=n(18),y=n(260),b=n(350),w=n(305),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function T(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=H(u,-1),f=H(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=M(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,j({month:"short",day:"numeric"},r));if(o<w.o)return n?v.n:v.t;if(h&&o<w.t)return B(o,v.i,w.n);if(w.l(u,e))return g?B(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,j({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,j({weekday:"long"},r))}return w.c(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.e.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function O(e,t){return w.p(e,M(m.e.language),t)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}}],Array(505),[function(e,t,n){"use strict";n.r(t);n.d(t,"encodeItemSetParentKeyKey",function(){return A});n.d(t,"resourceKey",function(){return M});var r=n(0),i=(n(1852),n(1832)),s=n(1908),o=n(1874),u=n(1854),a=n(74),f=n(374),l=n(82),c=n(725),h=n(551),p=n(1921),d=n(1042),v=n(1978),m=n(2072);function g(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}var y=n(1474),b=n(10),w=n(147),E=n(1872),S=n(262),x=n(2056),T=n("knockout-lib"),N=n(32),C=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&g(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);if(Object(N.isFeatureEnabled)(N.SupportMountPointInMoveCopyPanel)&&(t.remoteItem||t.isMountPointFolder)){s[l].peek().isMountPointFolder=!0;s[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl}c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,n,r,i){var s=this._isExpandingGroup?r.group:null,o=r.itemsPerGroup,u=e&&e.length>0?e[0].itemGroups:null,a=null;u&&u.length>0&&u[u.length-1].isPlaceholder&&(a=u.pop());var f=this._mergeGroupings(e,t,i,n);if(s&&f){f[0].isAllCollapsed(!1);s.state({isCollapsed:!1})}if(n&&n.length>0&&!n[n.length-1]&&(u=f&&f.length>0?f[0].itemGroups:null)&&u.length>0){var l=u[u.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var c=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),h=f[0].isAllCollapsed.peek();if(c||this._isFetchingNextGroup||h){var p=l.startIndex+l.count;a?a.startIndex=p:a={groupingId:"__next__",startIndex:p,count:1,isPlaceholder:!0,state:T.observable({isCollapsed:!1})};n.length<p&&(n.length=p+1);u.push(a)}}return f};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})(),k=n(3),L=n(49),A=new b.t({name:"ItemProvider.encodeItemSetParentKey",factory:new b.e(Object(k.Hi)(k.yi))}),O=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._encodeItemSetParentKey=n.encodeItemSetParentKey||!1;r._smartFiltersStore=n.smartFiltersStore;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function r(e,t){t&&(n+="&"+e+"="+t)}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var s=new o.e(n),u=e.queryType,a=void 0===u?s.queryType:u;s.queryType=a;this._store.setItem(s);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new m.e(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,s=void 0!==i&&i,o=n.emptyAllOtherSets,u=void 0!==o&&o,a=n.refreshSchema,f=void 0!==a&&a,l=n.updateGrouping,c=void 0!==l&&l,h=n.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(d=this._store.getItemSetFromItemKey(e))&&d.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);if(s){var d=this._store.getItemSetFromItemKey(e);this._getItem(Object(r.__assign)(Object(r.__assign)({parentKey:e},d&&d.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return a.n.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return a.n.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new E.e(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return a.n.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:d.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(h.e.started);n.progress.maximum(1);return r.then(function(e){n.state(h.e.completed);n.progress.current(1);return e},function(e){n.state(h.e.failed);n.error(new v.e({message:e}));return a.n.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new p.e,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:d.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(h.e.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(h.e.completed)}var u=e.items[0].UNSAFE_parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new v.e({message:e}));i.state(h.e.failed)}return a.n.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new E.e(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new m.e(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var n,i=this,s=y.e(e),o=this._store;if(e.keyAlias){n=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=n.peek().key}else n=this.getItemSync(e).item;var u=e.skipCache,f=void 0!==u&&u,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,v=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!f&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||g(d,{start:0,end:d.length})),w=e.startIndex,E=void 0===w?0:w,x=e.pageSize,T=void 0===x?100:x,N=e.endIndex||E+T;N=d&&d.length>0&&!v?Math.min(d.length,N):N;E=Math.max(0,Math.min(N,E));var k=!L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")?p&&!p.isExpired?o.getNextRequestToken(h):void 0:o.getNextRequestToken(h);e.requestToken="end"===k?"":k;var A=new C(e,o,v,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,E);var O=!1,M=p&&p.content.peek();if(M&&(1===M.partialResultStatus||2===M.partialResultStatus)){O=!0;1===M.partialResultStatus&&p.content({items:M.items,groupings:M.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!O&&A.isResultSetValid(d,{start:E,end:N}))return a.n.wrap(p);if(n&&n.peek().isStub){var _=e.startKey;if(_){if(o.getItem(_)){p.content.peek().items=[o.getItem(_)];p.isPlaceholder=!0;p.isExpired=!1;var D=this._schemaDataSource,P=D&&D.getColumns(n.peek());P&&P.length>0&&p.schema(P);p.content.valueHasMutated&&p.content.valueHasMutated()}}return a.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,E,N,!b);var B=this._getRequestKey(e),j=this._pendingGetItemRequests[B];if(j)return e.itemSetProjections?j.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):j.getPromise();v&&!k&&(e.startIndex=0);this._pendingGetItemRequests[B]=j=new S.e;this.resources.consumeAsync(l.y.bypass).then(function(t){return t.getItem(Object(r.__assign)(Object(r.__assign)({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var r=e.itemSetProjections?i.getItemSetKey(e,!0):c;n=o.getItem(e.parentKey);var u=o.getItemSet(r);b=!(!n||!u);var a=A.computeNewChildren(t,e,u,r,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(v=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new m.e(r,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=v;o.setItemSet(r,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;v&&e.mergeGroupings&&(w=A.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[B];if(e.requestAllChildren&&!g(f,{start:0,end:t.totalChildren})){var L=y.e(e),O=L.startIndex,M=void 0===O?0:O;L.startIndex=M+100;return i._getItem(L)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[B];return a.n.wrapError(e)}).then(function(e){j.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(-2147024860)&&!e.noGroupReplace?i._groupThrottle(!0):j.error(t)});return j.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new p.e,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(h.e.started)}return u.then(function(t){r.invalidateItem(s.key);(null==e?void 0:e.itemsScopeInvalidate)&&r.resources.consumeAsync(l._).then(function(e){e.invalidateItems(null==s?void 0:s.key)});for(var n=0,i=o;n<i.length;n++){var u=i[n];u.progress.current(1);u.state(h.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(h.e.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return a.n.resolve(this.resources.consumeAsync(l.H))};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{groupThrottle:f.g.optional,schemaDataSource:l.ee.optional,itemsStore:u.t,operationProvider:s.resourceKey,smartFiltersStore:c.e.optional,updateQuota:x.e,encodeItemSetParentKey:A.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(i.n),M=(t.default=O,Object(w.s)("ItemProvider",O))}],Array(182),[function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"i",function(){return h});n.d(t,"r",function(){return p});n.d(t,"e",function(){return v});var r=n(0),i=n(10),s=n(147),o=n(194),u=n(175),a=n(1840),f=n(263),l="@ms/odsp-shared/lib/base/BaseModel",c=new i.t({name:l+".asyncType",factory:new i.e(u.e)}),h=new i.t({name:l+".observablesFactoryType",factory:new s.r(a.e,{asyncType:c.optional})}),p=new i.t({name:l+".eventGroupType",factory:new i.e(o.t)}),d=new i.t({name:l+".errorHandler"}),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.id,s=void 0===i?"":i;r.id=s;r._BaseModel_dependencies=n;return r}Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!0,configurable:!0});t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})};t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)};t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)};t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)};t.prototype.addDisposable=function(e){return this.scope.attach(e)};t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.wrapObservable=function(e){return this.observables.wrap(e)};t.prototype.peekUnwrapObservable=function(e){return Object(a.r)(e)};t.prototype.createObservable=function(e){return this.observables.create(e)};t.prototype.unwrapObservable=function(e){return Object(a.i)(e)};t.prototype.isObservable=function(e){return Object(a.n)(e)};t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getAsync=function(){return e};return e};t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getEvents=function(){return e};return e};t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});this._BaseModel_getObservables=function(){return e};return e};t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(c.optional)||u.e};t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t};t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(h.optional)||Object(i.i)(a.e,{asyncType:this._BaseModel_getAsyncType()}))||a.e};t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(d.optional)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.e.dependencies),{asyncType:c.optional,observablesFactoryType:h.optional,eventGroupType:p.optional,errorHandler:d.optional});return t})(f.e);t.n=v},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1832),s=n("knockout-lib"),o=n(1867),u=n(10),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.element=t.element;r.valueAccessor=t.valueAccessor;r.allBindingsAccessor=t.allBindingsAccessor;r.bindingContext=t.bindingContext;r.controlsDescendantBindings=!1;return r}t.init=function(e,t,n,r,i){var a=new u.n(o.e(i)),f=new(this.supportsDependencies?a.resolved(this):a.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});s.utils.domNodeDisposal.addDisposeCallback(e,function(){return f.dispose()});return{controlsDescendantBindings:f.controlsDescendantBindings}};t.dependencies=Object(r.__assign)({},i.n.dependencies);t.supportsVirtualElements=!1;t.supportsDependencies=!1;return t})(i.n);t.t=a},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(1832),s=n(18),o=n(1933),u=n("knockout-lib");var a={init:function(e,t,n,r,i){u.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i);if(i){var s=i.$component;if(s){var o=u.utils.unwrapObservable(t());if(o){var a=s.__automationTypeBinding$elements;a||(a=s.__automationTypeBinding$elements={});var f=a[o];f||(f=a[o]=[]);f.push(e);u.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=f.indexOf(e);if(-1!==t){delete f[t];f.splice(t,1)}})}}}}},f=n(1833),l=n(29),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.element.getAttribute("class");n.element.setAttribute("class",n._expandIconClassNames(r));return n}t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),r=[],i=0,s=n;i<s.length;i++){var o=s[i];this._lastClassesAdded&&this._lastClassesAdded[o]||r.push(o);if(0===o.indexOf("ms-Icon--")){var u=o.substring(9),a=Object(l.C)(u);if(a&&-1===n.indexOf(a)){t[a]=!0;r.push(a)}}}this._lastClassesAdded=t;return r.join(" ")}return e};t.after=["css","class"];return t})(f.e),h=n(164),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.bindingHandlers={};r.automationId=t&&t.automationId||void 0;r.addBindingHandlers({automation:o.e,automationType:a,icon:c});return r}t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(s.format)(e,t)};t.prototype.addBindingHandlers=function(e){Object(h.e)(this.bindingHandlers,e)};return t})(i.n);t.t=p},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n("knockout-lib"),i=n(1142);function s(e){var t=e.tagName,n=e.template,i=e.viewModel,s=e.synchronous,o=void 0!==s&&s;r.components.register(t,{viewModel:i,template:n,synchronous:o});return e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.e.setText(n,t);document.head.appendChild(n)}},,,,function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});function r(e,t){return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;for(var n in e)if(e[n]!==t[n])return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0}function s(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}},function(e,t,n){"use strict";n.d(t,"r",function(){return l});n.d(t,"i",function(){return c});n.d(t,"n",function(){return h});n.d(t,"t",function(){return p});var r=n(0),i=(n(1852),n(83)),s=n("knockout-lib");s.onError=function(e){i.e.log(e)};var o=n(486),u=n(175),a=n(1839),f=n(164);function l(e){return h(e)?e.peek():e}function c(e){return s.unwrap(e)}function h(e){return s.isObservable(e)}function p(e){return{defaultValue:e,reducer:function(e,t){return t}}}var d=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});this._owner=e.owner;this._asyncType=t.asyncType}Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!0,configurable:!0});e.prototype.subscribe=function(e,t,n){var r,i=(void 0===n?{}:n).isBeforeChange;void 0!==i&&i&&(r="beforeChange");return this.scope.attach(e.subscribe(t,this._owner,r))};e.prototype.create=function(e){return s.observable(e)};e.prototype.createArray=function(e){return s.observableArray(e)};e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,s=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return s(e,c(t))},c(i))});o.equalityComparer=a.n;return Object(f.e)(o,{register:function(e){var i,s=""+ ++t;n(Object(r.__assign)(Object(r.__assign)({},n.peek()),((i={})[s]=e,i)));return{dispose:function(){var e=n.peek(),t=s,i=(e[t],Object(r.__rest)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})};e.prototype.compute=function(e,t){var n=this,r={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i=(function(e){return"object"==typeof e})(e)?e:{read:e},o=s.utils.extend(r,i);t&&s.utils.extend(o,t);var u=s.computed(o);return this.scope.attach(u)};e.prototype.pureCompute=function(e,t){var n={pure:!0};t&&s.utils.extend(n,t);return this.compute(e,n)};e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};t&&s.utils.extend(n,t);return this._setupBackgroundTask(this.compute(e,n))};e.prototype.wrap=function(e){return h(e)?e:this.create(e)};e.prototype.peekUnwrap=function(e){return h(e)?e.peek():e};e.prototype.unwrap=function(e){return c(e)};e.prototype.isObservable=function(e){return h(e)};e.prototype.ignore=function(e){return(function(e){return s.ignoreDependencies(e)})(e)};e.prototype.dispose=function(){this._scope&&this._scope.dispose()};e.prototype._setupBackgroundTask=function(e){var t=this;this._backgroundTasks||(this._backgroundTasks=[]);this._backgroundTasks.push(e);this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()}));return e};e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId;delete this._backgroundTasks};e.prototype._getAsync=function(){var e=this._asyncType||u.e,t=this.scope.attach(new e(this));this._getAsync=function(){return t};return t};return e})();t.e=d},function(e,t,n){"use strict";var r=n(262),i=(function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var n=new r.e(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);n.complete(e)},function(e){t._clear(!1);n.error(e)});return n.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e})();t.e=i},,function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n(1832),s=n(10),o=n(147),u={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},a={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},f=new s.t({name:"ResponsiveUI.breakpoints",factory:new s.e(a)}),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._containerElement=t.containerElement||window;var i=r.observables;r._breakpoints=i.wrap(n.breakpoints);r.events.on(r._containerElement,"resize, orientationchange",r._onContainerResize);r.windowWidth=i.create(0);r.windowHeight=i.create(0);r.formFactorSize=i.pureCompute(r._computeFormFactorSize);r.isHamburgerVisible=i.pureCompute(r._computeIsHamburgerVisible);r.showLabels=i.pureCompute(r._computeShowLabels);r.cssClass=i.pureCompute(r._computeCssClass);r._onContainerResize();return r}t.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};t.determineWindowSize=function(e,t){void 0===t&&(t=a);if(0===e)return"Medium";for(var n in a)if(e<t[n])return n};t.determineCssClass=function(e){return u[e]};t.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};t.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};t.prototype._onContainerResize=function(e){var t=this._containerElement,n=document.body,r=document.documentElement,i=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,s=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight;this.windowWidth(i);this.windowHeight(s)};t.prototype._computeFormFactorSize=function(){var e=this._breakpoints(),n=this.windowWidth();return this._containerElement===window?t.determineWindowSize(n,e):"Medium"};t.prototype._computeCssClass=function(){return t.determineCssClass(this.formFactorSize())};t.prototype._computeShowLabels=function(){return this.compareSize(this.formFactorSize(),"Medium")>0};t.prototype._computeIsHamburgerVisible=function(){return this.windowWidth()<a.Large};t.dependencies={breakpoints:f};t.DEFAULT_BREAKPOINTS=a;t.MAC_SCROLL_BAR_WIDTH=8;return t})(i.n);t.e=l;var c=Object(o.s)("ResponsiveUI",l)},function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}return t})(n(2050).e);t.e=i},,,function(e,t,n){"use strict";var r=n(0),i=n(1833),s=n(194),o=n(1862),u=n(403),a=n(1890),f={Left:"Right",Right:"Left"},l={Esc:!0},c=(function(e){Object(r.__extends)(t,e);function t(n){var r=e.call(this,n)||this,i=r.valueAccessor();if(i instanceof Array)for(var s=function(e){return function(){return e}},u=function(e){new(r.managed(t))({element:r.element,valueAccessor:s(e),bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor})},a=0,f=i;a<f.length;a++){u(f[a])}else{if("object"!=typeof i)throw new Error("KeyboardBinding only accepts an object for input. See documentation.");var l=i.mappings&&i||{mappings:i},c=l.target||r.element,h=l.useCapture,p=void 0!==h&&h;r._options=l;r.events.on(c,"keydown",r._onKeyDown,p);r._isActive=l.isActive||r.observables.create(!1);new(r.managed(o.t))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return{isActive:r._isActive}}})}return r}t.prototype._onKeyDown=function(e){var t=this._options,n=t.allowInputEvents,r=t.allowButtonEvents,i=t.context,o=void 0===i?this.bindingContext.$data:i,c=t.preventDefault,h=t.eventFilter,p=e.target,d=(function(e){var t;t=(function(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 117:t="F6";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t})(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t})(e),v=!r&&p!==this.element&&a.e(p),m=!l[d]&&!n&&p!==this.element&&a.t(p),g=t.target===document&&!this._isActive.peek(),y=(function(e,t){for(;e!==t&&t;){if(t.hasAttribute("data-suppresskeyboardbinding"))return!0;t=t.parentElement}return!1})(this.element,p);if(v||m||g||y)return!0;var b=(function(e,t){var n=!!e.useRtlMappings&&u.e.isRightToLeft&&f[t]||t;return e.mappings[n]})(t,d);if(b){c&&e.preventDefault&&e.preventDefault();if(h&&!h(d,o,e))return!0;for(var w=0,E=b instanceof Array?b:[b];w<E.length;w++){if(!1===E[w].call(o,o,e)){s.t.stopPropagation(e);return!1}}}return!0};return t})(i.t);t.e=c},function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"n",function(){return l});n.d(t,"t",function(){return c});n.d(t,"r",function(){return h});n(0);var r=n("react-lib"),i=n(76),s=n(1840),o=n(1832),u=n(164),a=n(264);function f(e,t){return l((function(e,t){var n=h(),i=c(r.useMemo(function(){return e},t)),s=r.useRef();return s.current||(s.current=Object(u.e)(n.pureCompute(function(){return i()()}),{equalityComparer:a.e}))})(e,t))}function l(e){var t=h(),n=t.peekUnwrap(e),i=r.useState(function(){return n})[1];r.useEffect(function(){if(t.isObservable(e)){i(function(){return e.peek()});var n=t.subscribe(e,function(e){i(function(){return e})});return function(){n.dispose()}}},[e]);return n}function c(e,t){var n,i=null!==(n=null==t?void 0:t.inline)&&void 0!==n&&n,s=h(),o=r.useRef(),f=o.current||(o.current=Object(u.e)(s.create(e),{equalityComparer:a.e}));(i?r.useMemo:r.useEffect)(function(){f(e)},[e]);return f}function h(){var e=Object(i.t)(),t=r.useRef(),n=t.current||(t.current=new(e.consume(o.i.optional)||s.e));r.useLayoutEffect(function(){return function(){n.dispose()}},[]);return n}},function(e,t,n){"use strict";var r=n(0),i=n(1969),s=n(726),o=n(1832),u=n(82),a=n(74),f=n(83),l=n(56),c=n(26),h=n(41),p=n(223),d=n(1041),v=n(64),m=n(1687),g=n(195),y=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,o=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(u.ve.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(p.u.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r.enableCustomerPromiseLogging=!1;r._executingInstanceCount=o.create(0);var h={deferEvaluation:!0};r.isAvailable=o.pureCompute(r._computeIsAvailable,h);r.isToggled=o.pureCompute(r._computeIsToggled,h);r.isExecuting=o.pureCompute(r._computeIsExecuting,h);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i?this.getEngagement():void 0;try{if(i){this._logEngagementEvent(i.data.extraData,s);this.trackUserAction(this.name)}if(!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,i))))throw new Error("Action did not return a promise")}catch(e){f.e.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);i&&i.end(e)},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!a.n.isCanceled(t)&&f.e.log(t);i&&i.end(r.onCreateErrorEventArg(e,t,!1))})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=a.n.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&c.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&a.n.isCanceled(t)?{resultType:h.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof v.e?{resultType:t.isExpected?h.e.ExpectedFailure:h.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:h.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?""+(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:h.e.Failure};return a.n.resolve(n)};t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new m.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&c.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,s=e.error,o=e.extraData;i.end({resultType:n,errorCode:t,extraData:Object(r.__assign)(Object(r.__assign)({},o),{error:s})});return e}).catch(function(e){var t;if(a.n.isCanceled(e))t={resultType:h.e.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(g.e)(e),s=n.resultType,o=n.resultCode,u=n.error,f=n.extraData;t={resultType:s,errorCode:o,extraData:Object(r.__assign)(Object(r.__assign)({},f),{error:u})}}i.end(t);throw e})}return t};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(d.e)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:s.e[s.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(r.__assign)(Object(r.__assign)({},e||{}),n&&n.getEngagementData()||{})})}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.n.dependencies),{urlDataSource:u.ve,instrumentationProvider:p.u.optional});return t})(o.n);t.e=y},function(e,t,n){"use strict";n.d(t,"e",function(){return x});var r=n(0),i=n(1833),s=n(74),o=n(262),u=n(1078),a=n(1044),f=n("react-lib"),l=n("react-dom-lib"),c=n(115),h=n("knockout-lib"),p=n(354),d=n(1841),v=n(76),m=n(224),g=n(83),y=n(781),b=n(300),w=n(1848),E=n(1871),S=new((function(){function e(){this._promises={}}e.prototype.load=function(e){var t=e.path,n=e.getModule,r=window.require.toUrl(t+"_unmapped"),i=this._promises,a=i[r];a||(a=i[r]=s.n.as(Object(u.e)({path:t,getModule:n}))).done(void 0,function(e){delete i[r]});var f=new o.e;a.done(function(e){return f.complete(e)},function(e){return f.error(e)});return f.getPromise()};e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var r=t(e);if(r)if("object"==typeof r){if(Object.keys(r).length>0){var i=Object(a.e)(r);i&&(n=i)}}else n=r}return n};return e})());function x(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,s=Object(r.__rest)(e,["applyBindings","bindingContext","children"]),o=f.useRef(null),u=Object(E.e)(),a=u[0],l=u[1],c=Object(w.t)({children:i}),p=f.useCallback(function(e){return f.createElement(f.Fragment,null,e.children)},[]);f.useEffect(function(){if(o.current&&t){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children");o.current.appendChild(e)}var s=t(o.current,n.extend(Object(r.__assign)({$react:a},i?{$data:{bindingHandlers:{react:T},Children:{componentType:p,props:c}}}:{})));return function(){s&&s.dispose();o.current&&h.cleanNode(o.current)}}},[]);var d=Object(b.e)(function(){return f.createElement("div",Object(r.__assign)({key:"root",ref:o,role:"presentation","data-is-ko-react-root":"true"},s))},s);return f.createElement(f.Fragment,null,d,l)}var T=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r,i=n.observables;n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())});if(n._value.peek().useDOMContext){var o=Object(y.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(r=h.contextFor(o))}else r=n.bindingContext;n._context=r&&r.$react;n._transcludedTemplateNodes=Array.prototype.slice.call(h.virtualElements.childNodes(n.element));h.virtualElements.emptyNode(n.element);n._renderDependencies=n.createObservable();n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)});n._componentProps.equalityComparer=p.t;n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)});n._rootProps.equalityComparer=p.t;var u=n.scope.attach(new d.e);n.createComputed(function(){var e,t=n._value();if((function(e){return!!e.componentType})(t)){var r=n.observables.unwrap(t.componentType);n._componentNameForLogging=r.displayName||"";c.n.mark("EUPL.ReactBinding.LoadStart."+n._componentNameForLogging);e=s.n.wrap(r)}else{t.getModule||console.error("ReactBinding instantiated with componentPath "+t.componentPath+" but missing getModule");n._componentNameForLogging=t.componentPath;c.n.mark("EUPL.ReactBinding.LoadStart."+n._componentNameForLogging);e=S.load({path:t.componentPath,getModule:t.getModule})}n.trackPromise(u.debounce(s.n.all({componentType:e}).then(function(e){c.n.mark("EUPL.ReactBinding.Loaded."+n._componentNameForLogging);var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){l.unmountComponentAtNode(n.element)}});n._renderDependencies(e)})))});n.createComputed(n._computeRenderComponent);return n}t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),s=this._rootProps(),o=this._transcludedTemplateNodes;c.n.mark("EUPL.ReactBinding.AsyncRender."+this._componentNameForLogging);try{this.observables.ignore(function(){var t=o.length>0?function(e,t){h.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,u=f.createElement(v.e,{resources:e.resources},f.createElement(m.e,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},f.createElement(n,Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)({},i),t?{children:f.createElement(x,Object(r.__assign)({bindingContext:e.bindingContext,applyBindings:t},s||{}))}:{})))));e._context?e._context.render(u,e.element):l.render(u,e.element)})}catch(e){g.e.logError(e)}}};return t})(i.t);t.t=T},,function(e,t,n){"use strict";n("knockout-projections-lib")},,function(e,t,n){"use strict";n.d(t,"t",function(){return b});var r=n(0),i=n(1874),s=n(123),o=n(1840),u=n(10),a=n(147),f=n(550),l=n(1839),c=n(210),h=n(2000),p=n(1146),d=n(32),v=Object(d.isFeatureEnabled)(d.ReadOnlyItemsStore);function m(e){return e&&e.item&&e.item.peek().key}function g(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var y=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new o.e({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(r.__spreadArrays)([e],t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&g(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&g(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=m(t=this.getValue(n));if(r){var i=f.e(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(r.__spreadArrays)(this._vaultItemsToPurge);e<t.length;e++){var n=t[e],s=void 0;if(n.vault&&n.vault.root){(s=new i.e(n.key)).name=n.name;s.displayName=n.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(n,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case c.e.Folder:case c.e.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),f=a.item&&a.item.peek(),l=f&&f.key;if(l&&(l===e||s&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(f);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e);Object(p.default)(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];v&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);for(var s=function(t){var n="item="+t,r=v?"item_write="+t:n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=l.n;o.setValue(r,u);s=v?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,a=Object(h.e)(Object(r.__spreadArrays)([e.key],t));u<a.length;u++){var f=a[u];s(f)}return i[0]};return t})(s.e),b=new u.t({name:"ItemsStore",factory:new a.i(y)});t.e=y},,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1854),i=n(147),s=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.UNSAFE_parent&&s.UNSAFE_parent.key)}return n};e.dependencies={itemsStore:r.t};return e})(),o=Object(i.s)("ItemParentHelper",s)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(74),s=n(1832),o=n(374),u=n(1964),a=n(147),f=n(1874),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.s.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.C.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.t.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.n),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{currentItem:o.s.lazy.optional,itemSetSelectionModel:o.C.lazy.optional,selectionHelper:u.t.lazy.optional}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1833),s=n(1878),o=n("knockout-lib"),u=n(323),a="InteractionScopeBinding_scope",f=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._parentScope=(function(e){var t,n=e;for(;!(t=o.utils.domData.get(n,a))&&n!==document.body&&Object(u.e)(n);)n=Object(u.e)(n);return n!==document.body&&t||void 0})(r.element);var i=r.valueAccessor(),f=i.isScope,l=void 0!==f&&f,c=i.isRoot,h=void 0!==c&&c;if(l){r._childScopes=o.observableArray();r._hasFocus=o.observable(!1);r._isRoot=h;r._isActive=r.createPureComputed(r._computeIsActive,{deferEvaluation:!0});r._isDescendantActive=r.createPureComputed(r._computeIsDescendantActive,{deferEvaluation:!0});r._scope={isActive:r._isActive,isDescendantActive:r._isDescendantActive,isDescendantOrSelfActive:r.createComputed(r._computeIsDescendantOrSelfActive),register:function(e){return r._registerScope(e)},_owner:r};o.utils.domData.set(r.element,a,r._scope);var p=n.ChildFocusBinding,d=void 0===p?s.e:p;new(r.managed(d))({element:r.element,bindingContext:r.bindingContext,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return r._hasFocus}});r._parentScope&&r.addDisposable(r._parentScope.register(r._scope))}else if(r._parentScope){r._isActive=r._parentScope.isActive;r._isDescendantActive=r._parentScope.isDescendantActive}else{r._isActive=o.observable(!0);r._isDescendantActive=o.observable(!1)}i.isActive&&r.createComputed(function(){return i.isActive(r._isActive())});i.isDescendantActive&&r.createComputed(function(){return i.isDescendantActive(r._isDescendantActive())});return r}t.prototype._registerScope=function(e){var t=this;this._childScopes.push(e);return{dispose:function(){t._childScopes.remove(e)}}};t.prototype._computeIsDescendantOrSelfActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return e||t};t.prototype._computeIsActive=function(){var e=this._hasFocus(),t=this._isDescendantActive();return(this._isRoot||e)&&!t};t.prototype._computeIsDescendantActive=function(){for(var e=!1,t=0,n=this._childScopes();t<n.length;t++){n[t].isDescendantOrSelfActive()&&(e=!0)}return e};return t})(i.t);t.t=f},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n(1832),s=n(147),o=n("knockout-lib"),u=n(74),a=n(262),f=n(158),l=n(2009),c=function(){this.icon=null;this.isAvailable=o.observable(!0);this.isVisible=o.observable(!0);this.isDefault=!1;this.automationId="";this.instrumentationId="";this.isExecuting=o.observable(!1);this.isLink=!1;this.execute=function(){return u.n.wrap(1)}},h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var r=t.title,i=t.titleAction,s=t.titleIcon,u=t.titleIconAriaLabel,f=t.customCssClasses,h=t.actions,p=void 0===h?[]:h,d=t.component,v=t.control,m=t.isDismissable,g=void 0===m||m,y=t.isSoftDismissable,b=void 0===y||y,w=t.isDismissableOnResize,E=void 0!==w&&w,S=t.isDismissableOnScroll,x=void 0!==S&&S,T=t.size,N=void 0===T?"Small":T,C=t.automationId,k=t.executeDefaultAction,L=void 0===k||k,A=t.isCallout,O=t.isOverlayHidden,M=void 0!==O&&O,_=t.overlayColor,D=void 0===_?"rgba(255,255,255,.4)":_,P=t.invokerEvent,H=t.calloutHeight,B=t.instrumentationId,j=void 0===B?"":B,F=t.shouldPreserveFocus,I=void 0===F||F,q=t.stayAsPopup,R=void 0!==q&&q,U=t.template,z=void 0===U?1:U,W=t.style,X=void 0===W?l.e.normal:W,V=t.focusOnPrimaryAction,$=void 0!==V&&V,J=t.dismissOnEsc,K=void 0!==J&&J;n.title=o.isObservable(r)?r:o.observable(r);n.titleAction=i;n.titleIcon=s;n.titleIconAriaLabel=u;n.customCssClasses=f;n.actions=p;n.component=d;n.control=v;n.isDismissable=g;n.isSoftDismissable=b;n.isDismissableOnResize=E;n.isDismissableOnScroll=x;n.size=N;n.automationId=C||"";n.executeDefaultAction=L;n.isCallout=!!A&&!!P;n.isOverlayHidden=M;n.overlayColor=D;n.invokerEvent=P;n.calloutHeight=H;n.instrumentationId=j;n.shouldPreserveFocus=o.isObservable(I)?I:o.observable(I);n.stayAsPopup=R;n.template=z;n.style=X;n.focusOnPrimaryAction=$;n.dismissOnEsc=K;n.actions=n.actions.map(function(e){return o.utils.extend(new c,e)});n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,r=n.actions;t<r.length;t++){r[t].isVisible()&&(e=!0)}return e},{disposeWhen:function(){return 1!==n.state()}});var Q=new a.e;n.createComputed(function(){var e=n.state();1!==e&&(2===e?Q.complete():Q.cancel())});n._promise=Q.getPromise();n.events.on(document,"keydown",n._keyDownEvent);return n}t.prototype.complete=function(){this.state(2)};t.prototype.dismiss=function(){this.state(3)};t.prototype.wait=function(){return this._promise};t.prototype._keyDownEvent=function(e){e.keyCode===f.e.escape&&this.dismissOnEsc&&this.state(3)};return t})(i.n),p=n(1150),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogs=[];r.currentDialog=r.observables.create();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,r=new h(e);if(e.queueDialog){t.push(r);1===t.length&&n(r)}else{t.unshift(r);n(r)}var i=function(){var e=t.indexOf(r);if(e>=0){t.splice(e,1);n(t[0])}r.dispose()};r.wait().then(i,i);return r};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:p.e});return t})(i.n),v=Object(s.s)("DialogProvider",d)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var s=n(10),o=n(594),u=n(1880);function a(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var f={loadViewModel:function(e,t,n){n(function(n,f){void 0===n&&(n={});var l,c=i.contextFor(f.element),h=i.utils.unwrapObservable(n.resources)||a(c),p={owner:e,useFactoriesOnKeys:!0},d=h?new s.n(h,p):new s.n(p);n=Object(r.__assign)(Object(r.__assign)({},n),{resources:d});l=(function(e){return"function"==typeof e.createViewModel})(t)?t.createViewModel(n,f):new(d.injected(t))(n);var v=new u.e({name:e,viewModel:l,element:f.element,bindingContext:c});return Object(o.e)(l,function(){v.dispose();d.dispose()})})}};i.components.loaders.unshift(f)},function(e,t,n){"use strict";var r=n("knockout-lib");n(1867),n(1869);window.__ko=r},function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){this._originalProvider=new r.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}e.getInstance=function(){return e._instance};e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||r.bindingHandlers[e]};e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,s=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;this._bindingHandlers[s]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)};this._bindingHandlers[s].after=t.after;t.supportsVirtualElements&&(r.virtualElements.allowedBindings[s]=!0);return s};e.prototype._remapKeys=function(e,t){var n=e,r=this._getLocalBindingHandlers(t);if(r){n={};for(var i in e){var s=r[i];n[s&&this.getUniqueKeyForBindingHandler(s,i)||i]=e[i]}}return n};e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};e._instance=new e;e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";e._lastUniqueKeyOrdinal=0;return e})(),s=i.getInstance();r.getBindingHandler=s.getBindingHandler.bind(s);r.bindingProvider.instance=s},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n("react-dom-lib"),o=n(94),u=n(137),a=0,f=Object(o.e)(function(e){return""+ ++a});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(u.e)(function(e,t){n(function(n){var i,o=f(t);return Object(r.__assign)(Object(r.__assign)({},n),((i={})[o]=s.createPortal(e,t),i))})}),a=Object(u.e)(function(e){n(function(t){var n=f(e);t[n];return Object(r.__rest)(t,["symbol"==typeof n?n:n+""])})}),l=i.useRef(),c=l.current||(l.current={render:o,unmount:a}),h=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[c,h]},[c,h])}},function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},,function(e,t,n){"use strict";var r=n(26),i=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.e.Files;this.displayType=r.e.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.e=i},,,,function(e,t,n){"use strict";var r=n(0),i=n(1140),s=n(1833),o=n(1881),u=(function(e){Object(r.__extends)(t,e);function t(t){var n,r,i,s=e.call(this,t)||this,u=t.valueAccessor();if((function(e){return"object"==typeof e})(u)){n=u.isBodyActive;r=u.activeElement;i=u.isDescendantOrSelfActive}else i=u;s._focusTracker=s.resources.consume(o.e);var a=s.observables;if(i){var f=a.pureCompute(s._computeIsDescendantOrSelfActive);a.compute(function(){i(f())}).extend({deferred:!0})}if(n){var l=a.pureCompute(s._computeIsBodyActive);a.compute(function(){n(l())}).extend({deferred:!0})}if(r){var c=a.pureCompute(s._computeActiveElement);a.compute(function(){r(c())}).extend({deferred:!0})}return s}t.prototype._computeIsDescendantOrSelfActive=function(){var e=this.element,t=this._focusTracker.activeElement();return!!t&&(e===t||Object(i.e)(e,t))};t.prototype._computeIsBodyActive=function(){var e=this._focusTracker.activeElement();return!e||e===document.body};t.prototype._computeActiveElement=function(){return this._focusTracker.activeElement()};return t})(s.t);t.e=u},,function(e,t,n){"use strict";var r=0,i=(function(){function e(e){var t=this._viewModel=e.viewModel,n=t.__ResourceComponentLoader$componentId=""+ ++r;t.__ResourceComponentLoader$componentBindingElement=e.element;t.__ResourceComponentLoader$childComponents={};t.__ResourceComponentLoader$componentName=e.name;for(var i=e.bindingContext;i&&(!i.$data||i.$data===t||!i.$data.__ResourceComponentLoader$childComponents);)i=i.$parentContext;if(i){var s=this._parentViewModel=i.$data;s.__ResourceComponentLoader$childComponents[n]=t;t.__ResourceComponentLoader$parentComponentViewModel=s}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e.__ResourceComponentLoader$componentId,r=t&&t.__ResourceComponentLoader$childComponents;n&&r&&delete r[n];if(e){delete e.__ResourceComponentLoader$parentComponentViewModel;delete e.__ResourceComponentLoader$childComponents;delete e.__ResourceComponentLoader$componentBindingElement;delete e.__ResourceComponentLoader$componentName}};return e})();t.e=i},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(1832),s=n(1839),o=n(147),u=n(182),a=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r.observables;r._activeElement=i.create({});r.activeElement=i.pureCompute(r._computeActiveElement);r.activeElement.equalityComparer=s.n;r.isWindowActive=i.create(!0);r._isWithinWindowBlur=!1;r._platform=n.platFormDetection;var o=r.async.throttle(function(){r._activeElement({})},350),u=r._platform&&r._platform.isEdge,a=r._platform&&r._platform.isIE;if(u||a){var f=new MutationObserver(o);f.observe(document.body,{childList:!0,subtree:!0});r.scope.attach({dispose:function(){f&&f.disconnect()}})}r.events.onAll(window,{focus:r._onWindowFocus,blur:r._onWindowBlur},!1);r.events.onAll(document.body,{focus:r._onDocumentFocus,blur:r._onDocumentBlur},!0);return r}t.prototype._computeActiveElement=function(){this._activeElement();return document.activeElement};t.prototype._onWindowFocus=function(e){this.async.clearTimeout(this._windowBlurTimeout);this._isWithinWindowBlur=!1;this.isWindowActive(!0)};t.prototype._onDocumentFocus=function(e){if(!this._isWithinWindowBlur){this.isWindowActive(!0);var t=document.activeElement;this.async.clearTimeout(this._blurTimeout);window.__debugFocus&&console.log("[focus] active:",t);this._activeElement({})}};t.prototype._onWindowBlur=function(e){var t=this;this._isWithinWindowBlur=!0;this.isWindowActive(!1);this._windowBlurTimeout=this.async.setTimeout(function(){t._isWithinWindowBlur=!1},10)};t.prototype._onDocumentBlur=function(e){var t=this;if(!this._isWithinWindowBlur){this.isWindowActive(!0);var n=document.activeElement;this.async.clearTimeout(this._blurTimeout);if(n&&n!==document.body){window.__debugFocus&&console.log("[focus] blur:",n);this._activeElement({})}else{window.__debugFocus&&console.log("[focus] wait:",n);this._blurTimeout=this.async.setTimeout(function(){window.__debugFocus&&console.log("[focus] blur:",n);t._activeElement({})},0)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{platFormDetection:u.e});return t})(i.n),f=Object(o.s)("FocusTracker",a,Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{platFormDetection:u.e}))},,,,,,function(e,t,n){"use strict";var r,i=n(0),s=n(1833),o=n(1832),u=n(262),a=n(147),f=n(1158),l=n(1916),c=n(764),h=n(119);(function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"})(r||(r={}));var p=r,d=Object(c.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:r,type:6}},h.e),v=n(41),m=n(1888),g=n(64),y=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new l.e(16);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,o={url:n,width:0,height:0},u=this._thumbnailCache,a=function(){return f.e.authenticate(n).then(function(){return t._waitForImageLoad(i,n,s)}).then(function(e){u.record(o);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;return{url:n,width:e,height:t}})};return u.isLoaded(o)?a():this._semaphore.enqueue(a)};t.prototype._waitForImageLoad=function(e,t,n){var r,i,s,o=this.async,a=this.events,f=function(){s&&o.clearTimeout(s);a.off(e)},l=new u.e(function(){f();e.setAttribute("src","")}),c=t&&t.indexOf("&encodeFailures=1")>=0;a.onAll(e,{load:function(){f();if(c&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?v.e.ExpectedFailure:v.e.Failure,resultCode:""+t,error:"Encoded failure"});l.error(new g.e({code:""+t,isExpected:n,message:"Server returned encoded failure "+t}))}else{i&&i.end({resultType:v.e.Success});l.complete(r)}},error:function(){f();i&&i.end({resultType:v.e.Failure});l.error(new Error("Image '"+t+"' failed to load"))}});s=o.setTimeout(function(){l.cancel()},3e4);n&&(i=new d({name:n,loadType:p.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(l.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new u.e(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{thumbnailCache:m.e});return t})(o.n),b=Object(a.s)("ImageLoader",y),w=n(1841),E=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new w.e;r._imageLoader=r.resources.consume(b);var i=r.valueAccessor(),s=i.src,o=i.image,u=i.error,a=i.isLoaded,f=i.isError,l=i.actualSize,c=i.scenarioName;r._src=r.wrapObservable(s);r._image=r.wrapObservable(o);r._error=r.wrapObservable(u);r._scenarioName=c;var h=n.outputExtenders,p=void 0===h?{deferred:!0}:h;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();a&&a(!!e);if(l){var t=void 0;if(e){t={width:e.width,height:e.height}}l(t)}o&&o(e)}).extend(p);r.createBackgroundComputed(function(){var e=r._error();u&&u(e);f&&f(!!e)}).extend(p);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src);this._image(void 0);this._scenarioName&&(e=new d({name:this._scenarioName,loadType:p.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:v.e.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?v.e.ExpectedFailure:v.e.Failure})})};return t})(s.t);t.e=E},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(1832),s=n(147),o=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,o=void 0===s?{rateLimit:{timeout:6e5}}:s;i.backgroundCompute(r._pruneThumbnails).extend(o);return r}t.prototype.getCoveragePercent=function(e,t){var n=l(e),r=l(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=f(this.getCoveragePercent(e,n)),o=a(e),u=a(t),l=this._recordsByThumbnailKey,c=this._bucketsByImageKey,h=l[o]||{lastAccessed:void 0,buckets:{}};h.lastAccessed=i.peek();var p=h.buckets[s];if(!p||this.getCoveragePercent(p.size,n)>1){p&&delete c[p.key];p=h.buckets[s]={key:u,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}c[u]=p;l[o]=h};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=a(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=a(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var o=i.buckets;i.lastAccessed=s.peek();var u=f(t),l=f(n),c=-1/0,h=!1;for(var p in o){var d=Number(p);if(d<=u&&d>=l&&o[d].isLoaded){c=Math.max(c,d);h=!0}}var v=h&&o[c];return v&&v.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();c(this._recordsByThumbnailKey,e);c(this._bucketsByImageKey,e)};return t})(i.n),u=Object(s.s)("ThumbnailCache",o);function a(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function f(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function c(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r={INPUT:!0,TEXTAREA:!0},i={A:!0,BUTTON:!0};function s(e){var t=e;return!!(t&&(t.tagName in r||t.isContentEditable))}function o(e){return!!(e&&e.tagName in i)}}],Array(16),[function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.text;return n}return t})(n(1834).t),s=n(1835).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=s},function(e,t,n){"use strict";n.r(t);n.d(t,"OperationProvider",function(){return p});n.d(t,"resourceKey",function(){return d});var r=n(0),i=n(1832),s=n(551),o=n(1921),u=n(1042),a=n(1998),f=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name;n.iconName=t.iconName;n.state=i.create(s.e.created);n.warning=i.create("");n.error=i.create();n.count=i.create(1);var a=Object(r.__assign)({minimum:0,maximum:0,current:0},t.progress||{});n.progress={minimum:i.create(a.minimum),maximum:i.create(a.maximum),current:i.create(a.current)};n.type=i.create(t.type||u.e.multiple);n.batch=t.batch||new o.e;n._initializeActions(t.actions);n.payloads=i.create(t.payloads||{});n.visibility=i.create(t.visibility||0);return n}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new a.e({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(i.n),l=n(2088),c=n(1999),h=n(147),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new o.e;r._observers=i.createArray();var u=r.operations=i.createArray(),a=r.scope.attached(l.e),f=r.groups=r.addDisposable(c.e.group(u,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new a({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(l.e))({batch:s,operations:f});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new f(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=Object(r.__spreadArrays)(e.operations.peek());this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],o=i.state.peek();if(o===s.e.completed||!e&&(o===s.e.expired||o===s.e.canceled||o===s.e.failed))for(var u=i.operations.peek(),a=void 0,f=0;f<u.length;f++){a=!0;var l=u[f];if(o===s.e.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(u[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(i.n),d=Object(h.s)("OperationProvider",p);t.default=p},,function(e,t,n){"use strict";n.r(t);n.d(t,"focusFirstTabStop",function(){return i});n.d(t,"focusLastTabStop",function(){return s});n.d(t,"focusNextTabStop",function(){return o});n.d(t,"focusPreviousTabStop",function(){return u});n.d(t,"getFirstTabStop",function(){return a});n.d(t,"getLastTabStop",function(){return f});n.d(t,"getNextTabStop",function(){return l});n.d(t,"getPreviousTabStop",function(){return c});n.d(t,"isTabStop",function(){return h});var r=n(323);function i(e,t){p(e,a,t)}function s(e,t){p(e,f,t)}function o(e,t){p(e,l,t)}function u(e,t){p(e,c,t)}function a(e,t){return e&&g(e,t)}function f(e,t){return e&&y(e,t)}function l(e,t){return e&&(m(e.firstElementChild,d,g,t)||b(e,d,g,t))}function c(e,t){return e&&b(e,v,y,t)}function h(e,t){return!(!e||!E(e,t))}function p(e,t,n){var r=t(e,n);r&&r.focus()}function d(e){return e.nextElementSibling}function v(e){return e.previousElementSibling}function m(e,t,n,r){for(;e;e=t(e)){var i=n(e);if(i)return i}}function g(e,t){return E(e,t)||m(e.firstElementChild,d,g)}function y(e,t){return m(e.lastElementChild,v,y)||E(e,t)}function b(e,t,n,i){for(;e;e=Object(r.e)(e)){var s=m(t(e),t,n);if(s)return s}}var w={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1};function E(e,t){var n=e.tagName.toLowerCase();if((n in w||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&!(0===e.offsetWidth&&0===e.offsetHeight||e.disabled||"input"===n&&"hidden"===e.type.toLowerCase()))return e}},,,,,,function(e,t,n){"use strict";var r=n(74),i=n(262),s=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0;r.n.is(n.result)&&n.result.cancel()});this._queue.push(n);t=n.signal.getPromise()}return r.n.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.e=s},,,,,function(e,t,n){"use strict";var r=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(5),i=n("react-lib"),s=n(1630),o=n(1628),u=n(1653),a=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement(u.e,Object(r.e)({},this.props,{primary:!0,onRenderDescription:s.t}))};return t=Object(r.n)([Object(o.e)("PrimaryButton",["theme","styles"],!0)],t)})(i.Component)},,,,,function(e,t,n){"use strict";var r=n(155);Object(r.n)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var i=n(0),s=n("knockout-lib"),o=n(1834),u=n(1887),a=n(2001),f=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=a.e;n.addBindingHandlers({imageLoader:u.e});n.isVisible=s.observable(!0);n.isImageLoaded=s.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t})(o.t),l=n(1835).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:f,synchronous:!0});t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t){return void 0!==e[t]&&null!==e[t]}},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r=n("knockout-lib");function i(e,t){var n=e.__automationBinding$elements;return n&&n[t]}t.e={init:function(e,t,n,i,s){r.applyBindingsToNode(e,{attr:{"data-automationId":t()}},s);if(s){var o=s.$component;if(o){var u=r.utils.unwrapObservable(t());if(u){var a=o.__automationBinding$elements;a||(a=o.__automationBinding$elements={});a[u]=e;r.utils.domNodeDisposal.addDisposeCallback(e,function(){a[u]&&delete a[u]})}}}}}}],Array(25),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(1832),s=n(147),o=n(74),u=n("knockout-lib"),a=(function(){function e(e){var t=this,n=e.noTitle,r=void 0!==n&&n,i=e.title,s=void 0===i?u.observable(""):i,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?u.observable({width:0,height:0}):L,O=e.isBlocking,M=e.disableEscape,_=void 0!==M&&M,D=e.overridePanelStyle;this.size=p;this.title=u.isObservable(s)?s:u.observable(s);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=r;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=O;this.disableEscape=_;this.overridePanelStyle=D;this.state=u.observable(0);this._promise=new o.n(function(e){var n=u.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e})(),f=n(1150),l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new a(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:f.e});return t})(i.n),c=Object(s.s)("PanelProvider",l)},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});var r=n(0),i=n(1832),s=n(1866),o=n(1907),u=n(74),a=n(128),f=n(2161),l=n(1844),c=n(374),h=n(1840),p=n(147),d=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(f.e),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(f.t);r(!1);i(!0)}return u.n.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=u.n.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:f.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:a.cancelActionText,execute:function(){return u.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:a.ok,execute:function(){return u.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{dialogProvider:s.e,promiseTracker:c.O.optional,itemSetSelectionModel:c.C});return t})(i.n);function v(e){var t=e.selection();if(1===t.length){var n=Object(h.i)(t[0]);return n.appMap?n.appMap:"nonOfficeApp"}}var m=Object(p.s)("SelectionHelper",d)},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(764),i=n(119),s=Object(r.e)({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},i.e)},,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.errorType=t.errorType||0;n.payloads=t.payloads||{};return n}return t})(n(64).e);t.e=i}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(1557),i=n(5),s=n("react-lib"),o=n(103),u=n(549),a=Object(u.e)({cacheSize:100}),f=(function(e){Object(i.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,r=e.children,u=e.className,f=e.disabled,l=e.styles,c=e.required,h=e.theme,p=a(l,{className:u,disabled:f,required:c,theme:h});return s.createElement(n,Object(i.e)({},Object(o.u)(this.props,o.s),{className:p.root}),r)};return t})(s.Component),l=n(29),c=Object(r.e)(f,function(e){var t,n=e.theme,r=e.className,s=e.disabled,o=e.required,u=n.semanticColors,a=l.i.semibold,f=u.bodyText,c=u.disabledBodyText,h=u.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:a,color:f,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},s&&{color:c,selectors:(t={},t[l.s]=Object(i.e)({color:"GrayText"},Object(l.T)()),t)},o&&{selectors:{"::after":{content:"' *'",color:h,paddingRight:12}}},r]}},void 0,{scope:"Label"})},,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1832),s=n(74),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,o=t.isAvailable,a=void 0===o?r.create(!0):o,f=t.onExecute,l=void 0===f?u:f;n.count=s;n.isAvailable=a;n._onExecute=l.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=u};t.prototype.execute=function(){return this._onExecute()};return t})(i.n);function u(){return s.n.wrap()}t.e=o},function(e,t,n){"use strict";n(1852);var r=n(594),i=n("knockout-lib"),s=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();Object(r.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),s=e._groupsByKeyId[r];if(s)s.values.push(t);else{s={key:n,values:i.observableArray([t])};e._groupsByKeyId[r]=s;e.groups.push(s)}return{mappedValue:r,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(s)}}}}})};return e})();t.e=s},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=""+s;if(!t[o]){t[o]=!0;n.push(s)}}return n}},,,,,,,,,function(e,t,n){"use strict";var r;(function(e){e[e.normal=0]="normal";e[e.blocker=1]="blocker";e[e.vaultBlocker=2]="vaultBlocker"})(r||(r={}));t.e=r}],Array(29),[function(e,t,n){"use strict";var r=n(0),i=n(1833),s=n("knockout-lib"),o=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n.createComputed(n._computeRefreshChildElements);return n}t.prototype._computeRefreshChildElements=function(){var e=s.unwrap(this.valueAccessor());s.virtualElements.emptyNode(this.element);this.element.innerHTML=e;s.applyBindingsToDescendants(this.bindingContext,this.element)};return t})(i.t);t.e=o},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(106),i=function(){var e,t,n=Object(r.e)();return!!(null===(t=null===(e=n)||void 0===e?void 0:e.navigator)||void 0===t?void 0:t.userAgent)&&n.navigator.userAgent.indexOf("rv:11.0")>-1}},,,function(e,t,n){"use strict";var r=n(1170),i=(function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){var e=this.value?Object(r.e)(this.value):void 0;0;return"ms-Icon ms-Icon--"+this.value+" "+(e||"")+(this.extraClasses?" "+this.extraClasses:"")};e.prototype.getExtraClasses=function(){return this.extraClasses};e.prototype.toString=function(){return this.value};return e})();t.e=i},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1832),i=new(n(10).t)({name:"UserStateProvider.key.updateQuota",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(165),s=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(20,2256)];case 1:return[2,e.sent().WithKnockoutResourcesAndItemCacheData]}})})})},function(e,t,n){"use strict";n.r(t);n.d(t,"createItemsScopeActionFromKnockout",function(){return l});var r=n(0),i=(n(1868),n("react-lib")),s=n(19),o=n(76),u=n(1848),a=n(2058),f=n(1049);function l(e,t){void 0===t&&(t={});return function(n){var r=n.itemKey;return i.createElement(a.e,{itemKey:r},i.createElement(c,{createKnockoutAction:e,options:t,actionProps:n}))}}function c(e){var t=this,n=e.createKnockoutAction,a=e.options,l=e.actionProps,c=a.isToggleable,h=void 0!==c&&c,p=a.isExecutorOnly,d=void 0!==p&&p,v=Object(o.t)(),m=Object(f.e)(function(){return n(v,l)},[]),g=Object(u.n)(!!d||m.isAvailable),y=Object(u.n)(h?m.isToggled:void 0);return i.createElement(s.e,{isAvailable:g,onExecute:function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,m.execute(e.event)];case 1:t.sent();return[2]}})})},isToggled:y})}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return C});var r=n(1557),i=n(5),s=n("react-lib"),o=n(1992),u=n(831),a=n(549),f=n(1039),l=n(242),c=n(754),h=n(1631);0;var p,d=n(556),v=n(1928),m=n(103),g=n(106),y=n(2047),b=Object(a.e)(),w=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._textElement=s.createRef();n._onFocus=function(e){n.props.onFocus&&n.props.onFocus(e);n.setState({isFocused:!0},function(){n.props.validateOnFocusIn&&n._validate(n.value)})};n._onBlur=function(e){n.props.onBlur&&n.props.onBlur(e);n.setState({isFocused:!1},function(){n.props.validateOnFocusOut&&n._validate(n.value)})};n._onRenderLabel=function(e){var t=e.label,r=e.required,i=n._classNames.subComponentStyles?n._classNames.subComponentStyles.label:void 0;return t?s.createElement(o.e,{required:r,htmlFor:n._id,styles:i,disabled:e.disabled,id:n._labelId},e.label):null};n._onRenderDescription=function(e){return e.description?s.createElement("span",{className:n._classNames.description},e.description):null};n._onRevealButtonClick=function(e){n.setState(function(e){return{isRevealingPassword:!e.isRevealingPassword}})};n._onInputChange=function(e){var t=e.target.value;if(void 0!==t&&t!==n._lastChangeValue){n._lastChangeValue=t;e.persist();var r;n.setState(function(e,i){var s=E(i,e)||"";return(r=t===s)||n._isControlled?null:{uncontrolledValue:t}},function(){var i=n.props.onChange;!r&&i&&i(e,t)})}};Object(f.e)(n);n._async=new l.e(n);0;n._fallbackId=Object(c.e)("TextField");n._descriptionId=Object(c.e)("TextFieldDescription");n._labelId=Object(c.e)("TextFieldLabel");n._warnControlledUsage();var r=t.defaultValue,i=void 0===r?"":r;"number"==typeof i&&(i=String(i));n.state={uncontrolledValue:n._isControlled?void 0:i,isFocused:!1,errorMessage:""};n._delayedValidate=n._async.debounce(n._validate,n.props.deferredValidationTime);n._lastValidation=0;return n}Object.defineProperty(t.prototype,"value",{get:function(){return E(this.props,this.state)},enumerable:!0,configurable:!0});t.prototype.componentDidMount=function(){this._adjustInputHeight();this.props.validateOnLoad&&this._validate(this.value)};t.prototype.componentWillUnmount=function(){this._async.dispose()};t.prototype.getSnapshotBeforeUpdate=function(e,t){return{selection:[this.selectionStart,this.selectionEnd]}};t.prototype.componentDidUpdate=function(e,t,n){var r=this.props,i=(n||{}).selection,s=void 0===i?[null,null]:i,o=s[0],u=s[1];if(!!e.multiline!=!!r.multiline&&t.isFocused){this.focus();null!==o&&null!==u&&o>=0&&u>=0&&this.setSelectionRange(o,u)}var a=E(e,t),f=this.value;if(a!==f){this._warnControlledUsage(e);this.state.errorMessage&&!r.errorMessage&&this.setState({errorMessage:""});this._adjustInputHeight();this._lastChangeValue=void 0;S(r)&&this._delayedValidate(f)}};t.prototype.render=function(){var e=this.props,t=e.borderless,n=e.className,r=e.disabled,o=e.iconProps,a=e.inputClassName,f=e.label,l=e.multiline,c=e.required,d=e.underlined,v=e.prefix,m=e.resizable,w=e.suffix,E=e.theme,S=e.styles,x=e.autoAdjustHeight,T=e.canRevealPassword,N=e.type,C=e.onRenderPrefix,k=void 0===C?this._onRenderPrefix:C,L=e.onRenderSuffix,A=void 0===L?this._onRenderSuffix:L,O=e.onRenderLabel,M=void 0===O?this._onRenderLabel:O,_=e.onRenderDescription,D=void 0===_?this._onRenderDescription:_,P=this.state,H=P.isFocused,B=P.isRevealingPassword,j=this._errorMessage,F=!!T&&"password"===N&&(function(){var e;if("boolean"!=typeof p){var t=Object(g.e)();if(null===(e=t)||void 0===e?void 0:e.navigator){var n=/Edg/.test(t.navigator.userAgent||"");p=!(Object(y.e)()||n)}else p=!0}return p})(),I=this._classNames=b(S,{theme:E,className:n,disabled:r,focused:H,required:c,multiline:l,hasLabel:!!f,hasErrorMessage:!!j,borderless:t,resizable:m,hasIcon:!!o,underlined:d,inputClassName:a,autoAdjustHeight:x,hasRevealButton:F});return s.createElement("div",{className:I.root},s.createElement("div",{className:I.wrapper},M(this.props,this._onRenderLabel),s.createElement("div",{className:I.fieldGroup},(void 0!==v||this.props.onRenderPrefix)&&s.createElement("div",{className:I.prefix},k(this.props,this._onRenderPrefix)),l?this._renderTextArea():this._renderInput(),o&&s.createElement(u.e,Object(i.e)({className:I.icon},o)),F&&s.createElement("button",{className:I.revealButton,onClick:this._onRevealButtonClick,type:"button"},s.createElement("span",{className:I.revealSpan},s.createElement(u.e,{className:I.revealIcon,iconName:B?"Hide":"RedEye"}))),(void 0!==w||this.props.onRenderSuffix)&&s.createElement("div",{className:I.suffix},A(this.props,this._onRenderSuffix)))),this._isDescriptionAvailable&&s.createElement("span",{id:this._descriptionId},D(this.props,this._onRenderDescription),j&&s.createElement("div",{role:"alert"},s.createElement(h.e,null,s.createElement("p",{className:I.errorMessage},s.createElement("span",{"data-automation-id":"error-message"},j))))))};t.prototype.focus=function(){this._textElement.current&&this._textElement.current.focus()};t.prototype.blur=function(){this._textElement.current&&this._textElement.current.blur()};t.prototype.select=function(){this._textElement.current&&this._textElement.current.select()};t.prototype.setSelectionStart=function(e){this._textElement.current&&(this._textElement.current.selectionStart=e)};t.prototype.setSelectionEnd=function(e){this._textElement.current&&(this._textElement.current.selectionEnd=e)};Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._textElement.current?this._textElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._textElement.current?this._textElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});t.prototype.setSelectionRange=function(e,t){this._textElement.current&&this._textElement.current.setSelectionRange(e,t)};t.prototype._warnControlledUsage=function(e){this._id,this.props;if(null===this.props.value&&!this._hasWarnedNullValue){this._hasWarnedNullValue=!0;Object(d.e)("Warning: 'value' prop on 'TextField' should not be null. Consider using an empty string to clear the component or undefined to indicate an uncontrolled component.")}};Object.defineProperty(t.prototype,"_id",{get:function(){return this.props.id||this._fallbackId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isControlled",{get:function(){return Object(v.e)(this.props,"value")},enumerable:!0,configurable:!0});t.prototype._onRenderPrefix=function(e){var t=e.prefix;return s.createElement("span",{style:{paddingBottom:"1px"}},t)};t.prototype._onRenderSuffix=function(e){var t=e.suffix;return s.createElement("span",{style:{paddingBottom:"1px"}},t)};Object.defineProperty(t.prototype,"_errorMessage",{get:function(){var e=this.props.errorMessage;return(void 0===e?this.state.errorMessage:e)||""},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isDescriptionAvailable",{get:function(){var e=this.props;return!!(e.onRenderDescription||e.description||this._errorMessage)},enumerable:!0,configurable:!0});t.prototype._renderTextArea=function(){var e=Object(m.u)(this.props,m.w,["defaultValue"]),t=this.props["aria-labelledby"]||(this.props.label?this._labelId:void 0);return s.createElement("textarea",Object(i.e)({id:this._id},e,{ref:this._textElement,value:this.value||"",onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-labelledby":t,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":!!this._errorMessage,"aria-label":this.props.ariaLabel,readOnly:this.props.readOnly,onFocus:this._onFocus,onBlur:this._onBlur}))};t.prototype._renderInput=function(){var e=Object(i.e)(Object(i.e)({type:this.state.isRevealingPassword?"text":this.props.type||"text",id:this._id},Object(m.u)(this.props,m.h,["defaultValue","type"])),{"aria-labelledby":this.props["aria-labelledby"]||(this.props.label?this._labelId:void 0),ref:this._textElement,value:this.value||"",onInput:this._onInputChange,onChange:this._onInputChange,className:this._classNames.field,"aria-label":this.props.ariaLabel,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:this.props["aria-describedby"],"aria-invalid":!!this._errorMessage,onFocus:this._onFocus,onBlur:this._onBlur}),t=function(e){return s.createElement("input",Object(i.e)({},e))};return(this.props.onRenderInput||t)(e,t)};t.prototype._validate=function(e){var t=this;if(this._latestValidateValue!==e||!S(this.props)){this._latestValidateValue=e;var n=this.props.onGetErrorMessage,r=n&&n(e||"");if(void 0!==r)if("string"!=typeof r&&"then"in r){var i=++this._lastValidation;r.then(function(n){i===t._lastValidation&&t.setState({errorMessage:n});t._notifyAfterValidate(e,n)})}else{this.setState({errorMessage:r});this._notifyAfterValidate(e,r)}else this._notifyAfterValidate(e,"")}};t.prototype._notifyAfterValidate=function(e,t){e===this.value&&this.props.onNotifyValidationResult&&this.props.onNotifyValidationResult(t,e)};t.prototype._adjustInputHeight=function(){if(this._textElement.current&&this.props.autoAdjustHeight&&this.props.multiline){var e=this._textElement.current;e.style.height="";e.style.height=e.scrollHeight+"px"}};t.defaultProps={resizable:!0,deferredValidationTime:200,validateOnLoad:!0,canRevealPassword:!1};return t})(s.Component);function E(e,t){var n=e.value,r=void 0===n?t.uncontrolledValue:n;return"number"==typeof r?String(r):r}function S(e){return!(e.validateOnFocusIn||e.validateOnFocusOut)}var x=n(29),T={root:"ms-TextField",description:"ms-TextField-description",errorMessage:"ms-TextField-errorMessage",field:"ms-TextField-field",fieldGroup:"ms-TextField-fieldGroup",prefix:"ms-TextField-prefix",suffix:"ms-TextField-suffix",wrapper:"ms-TextField-wrapper",revealButton:"ms-TextField-reveal",multiline:"ms-TextField--multiline",borderless:"ms-TextField--borderless",underlined:"ms-TextField--underlined",unresizable:"ms-TextField--unresizable",required:"is-required",disabled:"is-disabled",active:"is-active"};function N(e){var t=e.underlined,n=e.disabled,r=e.focused,i=e.theme,s=i.palette,o=i.fonts;return function(){var e;return{root:[t&&n&&{color:s.neutralTertiary},t&&{fontSize:o.medium.fontSize,marginRight:8,paddingLeft:12,paddingRight:0,lineHeight:"22px",height:32},t&&r&&{selectors:(e={},e[x.s]={height:31},e)}]}}}var C=Object(r.e)(w,function(e){var t,n,r,s,o,u,a,f,l,c,h,p,d=e.theme,v=e.className,m=e.disabled,g=e.focused,y=e.required,b=e.multiline,w=e.hasLabel,E=e.borderless,S=e.underlined,C=e.hasIcon,k=e.resizable,L=e.hasErrorMessage,A=e.inputClassName,O=e.autoAdjustHeight,M=e.hasRevealButton,_=d.semanticColors,D=d.effects,P=d.fonts,H=Object(x.x)(T,d),B={background:_.disabledBackground,color:m?_.disabledText:_.inputPlaceholderText,display:"flex",alignItems:"center",padding:"0 10px",lineHeight:1,whiteSpace:"nowrap",flexShrink:0,selectors:(t={},t[x.s]={background:"Window",color:m?"GrayText":"WindowText"},t)},j=[P.medium,{color:_.inputPlaceholderText,opacity:1,selectors:(n={},n[x.s]={color:"GrayText"},n)}],F={color:_.disabledText,selectors:(r={},r[x.s]={color:"GrayText"},r)};return{root:[H.root,P.medium,y&&H.required,m&&H.disabled,g&&H.active,b&&H.multiline,E&&H.borderless,S&&H.underlined,x.j,{position:"relative"},v],wrapper:[H.wrapper,S&&[{display:"flex",borderBottom:"1px solid "+(L?_.errorText:_.inputBorder),width:"100%"},m&&{borderBottomColor:_.disabledBackground,selectors:(s={},s[x.s]=Object(i.e)({borderColor:"GrayText"},Object(x.T)()),s)},!m&&{selectors:{":hover":{borderBottomColor:L?_.errorText:_.inputBorderHovered,selectors:(o={},o[x.s]=Object(i.e)({borderBottomColor:"Highlight"},Object(x.T)()),o)}}},g&&[{position:"relative"},Object(x.k)(L?_.errorText:_.inputFocusBorderAlt,0,"borderBottom")]]],fieldGroup:[H.fieldGroup,x.j,{border:"1px solid "+_.inputBorder,borderRadius:D.roundedCorner2,background:_.inputBackground,cursor:"text",height:32,display:"flex",flexDirection:"row",alignItems:"stretch",position:"relative"},b&&{minHeight:"60px",height:"auto",display:"flex"},!g&&!m&&{selectors:{":hover":{borderColor:_.inputBorderHovered,selectors:(u={},u[x.s]=Object(i.e)({borderColor:"Highlight"},Object(x.T)()),u)}}},g&&!S&&Object(x.k)(L?_.errorText:_.inputFocusBorderAlt,D.roundedCorner2),m&&{borderColor:_.disabledBackground,selectors:(a={},a[x.s]=Object(i.e)({borderColor:"GrayText"},Object(x.T)()),a),cursor:"default"},E&&{border:"none"},E&&g&&{border:"none",selectors:{":after":{border:"none"}}},S&&{flex:"1 1 0px",border:"none",textAlign:"left"},S&&m&&{backgroundColor:"transparent"},L&&!S&&{borderColor:_.errorText,selectors:{"&:hover":{borderColor:_.errorText}}},!w&&y&&{selectors:(f={":before":{content:"'*'",color:_.errorText,position:"absolute",top:-5,right:-10}},f[x.s]={selectors:{":before":{color:"WindowText",right:-14}}},f)}],field:[P.medium,H.field,x.j,{borderRadius:0,border:"none",background:"none",backgroundColor:"transparent",color:_.inputText,padding:"0 8px",width:"100%",minWidth:0,textOverflow:"ellipsis",outline:0,selectors:(l={"&:active, &:focus, &:hover":{outline:0},"::-ms-clear":{display:"none"}},l[x.s]={background:"Window",color:m?"GrayText":"WindowText"},l)},Object(x.L)(j),b&&!k&&[H.unresizable,{resize:"none"}],b&&{minHeight:"inherit",lineHeight:17,flexGrow:1,paddingTop:6,paddingBottom:6,overflow:"auto",width:"100%"},b&&O&&{overflow:"hidden"},C&&!M&&{paddingRight:24},b&&C&&{paddingRight:40},m&&[{backgroundColor:_.disabledBackground,color:_.disabledText,borderColor:_.disabledBackground},Object(x.L)(F)],S&&{textAlign:"left"},g&&!E&&{selectors:(c={},c[x.s]={paddingLeft:11,paddingRight:11},c)},g&&b&&!E&&{selectors:(h={},h[x.s]={paddingTop:4},h)},A],icon:[b&&{paddingRight:24,alignItems:"flex-end"},{pointerEvents:"none",position:"absolute",bottom:6,right:8,top:"auto",fontSize:x.u.medium,lineHeight:18},m&&{color:_.disabledText}],description:[H.description,{color:_.bodySubtext,fontSize:P.xSmall.fontSize}],errorMessage:[H.errorMessage,x.e.slideDownIn20,P.small,{color:_.errorText,margin:0,paddingTop:5,display:"flex",alignItems:"center"}],prefix:[H.prefix,B],suffix:[H.suffix,B],revealButton:[H.revealButton,"ms-Button","ms-Button--icon",{height:30,width:32,border:"none",padding:"0px 4px",backgroundColor:"transparent",color:_.link,selectors:{":hover":{outline:0,color:_.primaryButtonBackgroundHovered,backgroundColor:_.buttonBackgroundHovered,selectors:(p={},p[x.s]={borderColor:"Highlight",color:"Highlight"},p)},":focus":{outline:0}}},C&&{marginRight:28}],revealSpan:{display:"flex",height:"100%",alignItems:"center"},revealIcon:{margin:"0px 4px",pointerEvents:"none",bottom:6,right:8,top:"auto",fontSize:x.u.medium,lineHeight:18},subComponentStyles:{label:N(e)}}},void 0,{scope:"TextField"})},,function(e,t,n){"use strict";var r=n(0),i=n(1849),s=n(1856),o=n(1860),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.item,u=n.getItemSelectionHelperType,a=void 0===u?r.resources.consume(o.e.lazy):u,f=n.itemParentHelper,l=void 0===f?r.resources.consume(s.e):f;r.isItemSpecified=!!i;r.item=i||new(r.scope.attached(a()))({canFallback:!0,ignoreSelection:!0}).currentItem;r.itemParentHelper=l;return r}t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var r=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(r):this.unwrapObservable(r)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:s.e});return t})(i.e);t.e=u},,,,,,,function(e,t,n){"use strict";var r=n(2081),i=n("knockout-lib"),s=n(1839),o=function(e,t,n){this.key=e||"";this.content=i.observable(new r.e(n));this.content.equalityComparer=s.n;this.schema=i.observableArray([]);this.schema.equalityComparer=s.e;this.context=i.utils.extend({},t);this.contentTypes=i.observableArray([]);this.isPlaceholder=!0;this.version=0};t.e=o},,,,,,,,,function(e,t,n){"use strict";var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.e=r},,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1042),s=n(551),o=n(1998),u=n(74),a=n(1832),f=n(2098),l=n(1999),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(l.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||i.e.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return s.e[t.state()]}),r=e.addDisposable(f.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(f.t(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(f.t(t.progress.current,e.progress.current)),u=e.addDisposable(f.e(n,e.states)),a=e.addDisposable(f.n(t.error,e.error)),l=e.addDisposable(f.t(t.count,e.count)),c=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();i.dispose();o.dispose();u.dispose();c.dispose();a.dispose();l.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?s.e.started:e.created?s.e.created:e.failed?s.e.failed:e.completed?s.e.completed:e.canceled?s.e.canceled:s.e.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new o.e({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return u.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||u.n.wrap()}))}}))};return t})(a.n);t.e=c},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n("knockout-lib");function i(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}function s(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=r.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}}],Array(188),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});n.d(t,"r",function(){return a});var r=n(2546),i=n(18);function s(){return r.g}function o(e){return i.format(r.u,"'"+e+"'")}function u(e,t){var n=r.o,i=a(e,4),s=a(e,2),o=a(e,1);i?n=r.f:s?n=r.o:o&&(n=r.a);t&&(n=n+' <a href=";" data-bind="click: '+t+'">'+r.g+"</a>");return n}function a(e,t){return e&&(e&t)===t}}],Array(278),[function(e,t,n){"use strict";var r=n(0),i=n(149),s=n(1143),o=n(1649),u=n(2706),a=n(2546),f=n(2287),l=n(82),c=n(1850),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.item,i=t.policyTipInfo;n._item=r;n._policyTipInfo=i;n.addBindingHandlers({react:c.t});n._itemProvider=n.resources.consume(o.resourceKey);n._policyTipDataSource=n.resources.consume(l.V);n._showJustificationInput=n.createObservable(!1);n._confirmationText=n.createObservable("").extend({notify:"always"});n.policyTipComponent=u.e;n.policyTipComponentProps=n.createPureComputed(n._computePolicyTipComponentParams);return n}t.prototype._computePolicyTipComponentParams=function(){var e=this._confirmationText(),t=this._showJustificationInput(),n=this._getPolicyTipStrings();return{confirmationText:e,onDismissed:this._onDismissed.bind(this),onOverrideClicked:this._onOverrideClicked.bind(this),onOverrideSubmitClicked:this._onOverrideSubmitClicked.bind(this),overrideRequiresJustification:this._policyTipInfo?2===this._policyTipInfo.overrideOption:void 0,showJustificationInput:t,onReportClicked:this._onReportClicked.bind(this),strings:n}};t.prototype._getPolicyTipStrings=function(){var e=this._policyTipInfo;if(!e)return{noPolicyTipInfoError:a.n,titleText:f.t(this._item.name),headerText:void 0,issues:void 0,lastScannedText:void 0,learnMoreActionLabel:void 0,learnMoreLabel:void 0,learnMoreUrl:void 0,overrideActionLabel:void 0,overrideLabel:void 0,policyTipDescription:void 0,reportActionLabel:void 0,reportInProgressLabel:void 0,reportLabel:void 0,submitButtonLabel:void 0};var t=1===e.overrideOption||2===e.overrideOption;return{headerText:a.v,issues:e.issueDescriptions,lastScannedText:e.lastScanned?a.m+": "+Object(s.r)(e.lastScanned):void 0,learnMoreActionLabel:a.e,learnMoreLabel:a.t,learnMoreUrl:e.policyInfoUrl,noPolicyTipInfoError:void 0,overrideActionLabel:t?a.r:void 0,overrideLabel:a.s,policyTipDescription:e.explanationText,reportActionLabel:a.l,reportInProgressLabel:a.h,reportLabel:a.p,submitButtonLabel:a.d,titleText:f.t(this._item.name)}};t.prototype._onReportClicked=function(){var e=this;this._logEngagementEvent("ReportClicked");var t={item:this._item,action:1};this._policyTipDataSource.updatePolicy(t).done(function(t){if(1===t){e._logEngagementEvent("FalsePositiveReported");e._confirmationText(a.c)}else if(3===t||2===t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(a.i)}})};t.prototype._onOverrideClicked=function(){var e=this;this._logEngagementEvent("OverrideClicked");var t=this._policyTipInfo.overrideOption;if(1===t){var n={item:this._item,action:0};this._policyTipDataSource.updatePolicy(n).done(function(t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(a.i)})}else if(2===t){this._logEngagementEvent("JustificationInputShown");this._showJustificationInput(!0)}};t.prototype._onOverrideSubmitClicked=function(e){var t=this;this._logEngagementEvent("OverrideSubmitClicked");var n={item:this._item,action:0,justification:e};this._policyTipDataSource.updatePolicy(n).done(function(e){t._logEngagementEvent("OverrideWithJustification");t._confirmationText(a.i)})};t.prototype._onDismissed=function(){this._itemProvider.invalidateItem(this._item.parentKey,{triggerFetch:!0})};t.prototype._logEngagementEvent=function(e){i.e.logData({name:"PolicyTipPanel."+e})};return t})(n(1834).t),p=n(1835).e({tagName:"od-policy-tip-panel",template:'<div data-bind="react:{componentType:policyTipComponent,props:policyTipComponentProps}"></div>',viewModel:h});t.e=p}],Array(52),[function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){}e.update=function(e,t){var n=r.unwrap(t());e.style.visibility=n?"inherit":"hidden"};return e})();t.e=i}],Array(26),[function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(2059),i=n(0),s=n("react-lib"),o=n(42),u=n(1848),a=n(1161);function f(e,t){void 0===t&&(t={});var n,f=Object(r.createItemsScopeActionFromKnockout)(e,t);return(n=function(e){return{item:e}},function(e){var t=e;return Object(o.e)(function(e,t){return{storeItem:e.demandItemFacet(a.t,t.itemKey)}})(function(e){var r=e.storeItem,o=Object(u.n)(r),a=Object(u.t)(o);return s.createElement(t,Object(i.__assign)({},e,n(a,e)))})})(f)}}],Array(59),[function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(0),i=n(155);Object(i.n)([{rawString:".od-PolicyTip-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:100;margin:0px 0px 8px 0px}.od-PolicyTip-description{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0px}.od-PolicyTip-blockedIcon{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300;font-weight:600}[dir='ltr'] .od-PolicyTip-headerText{margin-left:12px}[dir='rtl'] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";font-weight:400;margin-bottom:12px}[dir='ltr'] .od-PolicyTip-issue{margin-left:33px}[dir='rtl'] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir='rtl'] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir='ltr'] .od-PolicyTip-label{margin-left:4px}[dir='rtl'] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";font-weight:400}[dir='ltr'] .od-PolicyTip-statusText{margin-left:4px}[dir='rtl'] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-justificationInputContainer{overflow-y:auto;max-height:110px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:"},{theme:"largeFontSize",defaultValue:"18px"},{rawString:";font-weight:300}\n"}]);var s=n(1630),o=n(1922),u=n(1821),a=n(2063),f=n("react-lib"),l=n(18),c=n(831),h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onReportClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoading:!0,reportButtonClicked:!0}),function(){n.props.onReportClicked()})};n._onOverrideClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{overrideButtonClicked:!0}),function(){n.props.onOverrideClicked()})};n._onOverrideSubmitClicked=function(){n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{isLoading:!0,overrideSubmitClicked:!0}),function(){n.props.onOverrideSubmitClicked(n.state.justificationText)})};n._onJustificationChanged=function(e,t){n.props.overrideRequiresJustification&&n.setState(Object(r.__assign)(Object(r.__assign)({},n.state),{justificationText:t||"",overrideSubmitDisabled:!t}))};n.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(Object(r.__assign)(Object(r.__assign)({},this.state),{isLoading:!1}))};t.prototype.componentWillUnmount=function(){this.props.onDismissed()};t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?f.createElement("div",{className:"od-PolicyTip-container"},f.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):f.createElement("div",{className:"od-PolicyTip-container"},f.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),f.createElement("div",{className:"od-PolicyTip-header"},f.createElement(c.e,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),f.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),f.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),f.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return f.createElement("div",null,f.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,r=this.props.strings.issues;n<r.length;n++){var i=r[n];e.push(f.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e};t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=f.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),n=l.formatToArray(e.learnMoreLabel,t);return f.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}};t.prototype._getAction=function(e,t,n,r){if(n)return f.createElement("div",{className:"od-PolicyTip-action"},f.createElement("span",null,""+l.format(e,t)));var i=f.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:r,role:"button",href:"javascript:;"},t),s=l.formatToArray(e,i);return f.createElement("div",{className:"od-PolicyTip-action"},s)};t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,r=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);r.push(i);if(n.overrideActionLabel){var s=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);r.push(s)}return r};t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?f.createElement("div",{className:"od-PolicyTip-status"},f.createElement(u.e,null),f.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?f.createElement("div",{className:"od-PolicyTip-status"},f.createElement(c.e,{iconName:"CheckMark"}),f.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return f.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},f.createElement(a.e,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&f.createElement(o.e,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};return t})(s.e)}],Array(719),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2065),s=n(155);Object(s.n)([{rawString:".od-PolicyTip{height:255px;overflow-x:hidden;position:relative;margin-top:8px}.od-PolicyTip .od-TextField.od-TextField--multiline{margin:0}.od-PolicyTip .od-TextField.od-TextField--multiline .ms-Label{padding-top:0}.od-PolicyTip-loading{text-align:center;position:relative;top:102.5px}.od-PolicyTip-issuesExplanation{margin-bottom:24px}.od-PolicyTip-issuesHeader{padding:0;margin:0 32px}.od-PolicyTip-issuesIcon{padding:2px 8px 0;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";font-size:17px;height:16px;width:16px;cursor:default}html[dir=ltr] .od-PolicyTip-issuesIcon{float:left}html[dir=rtl] .od-PolicyTip-issuesIcon{float:right}.od-PolicyTip-issueList{margin:8px 0 24px}[dir=ltr] .od-PolicyTip-issueList{padding-left:29px}[dir=rtl] .od-PolicyTip-issueList{padding-right:29px}[dir=ltr] .od-PolicyTip-issueList li{padding-left:3px}[dir=rtl] .od-PolicyTip-issueList li{padding-right:3px}.od-PolicyTip-lastScannedRow{cursor:default;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-PolicyTip-resolveSection{margin-bottom:24px}.od-PolicyTip-resolveHeading{color:"},{theme:"themeSecondary",defaultValue:"#2f69c0"},{rawString:";margin:0;padding:0 0 8px}.lg .od-PolicyTip-resolveButton,.xlg .od-PolicyTip-resolveButton,.xxlg .od-PolicyTip-resolveButton,.xxxlg .od-PolicyTip-resolveButton,.xxxxlg .od-PolicyTip-resolveButton{margin-bottom:2em}html[dir=ltr] .lg .od-PolicyTip-resolveButton,html[dir=ltr] .xlg .od-PolicyTip-resolveButton,html[dir=ltr] .xxlg .od-PolicyTip-resolveButton,html[dir=ltr] .xxxlg .od-PolicyTip-resolveButton,html[dir=ltr] .xxxxlg .od-PolicyTip-resolveButton{float:right}html[dir=rtl] .lg .od-PolicyTip-resolveButton,html[dir=rtl] .xlg .od-PolicyTip-resolveButton,html[dir=rtl] .xxlg .od-PolicyTip-resolveButton,html[dir=rtl] .xxxlg .od-PolicyTip-resolveButton,html[dir=rtl] .xxxxlg .od-PolicyTip-resolveButton{float:left}[dir=ltr] .lg .od-PolicyTip-resolveButton,[dir=ltr] .xlg .od-PolicyTip-resolveButton,[dir=ltr] .xxlg .od-PolicyTip-resolveButton,[dir=ltr] .xxxlg .od-PolicyTip-resolveButton,[dir=ltr] .xxxxlg .od-PolicyTip-resolveButton{margin-left:24px}[dir=rtl] .lg .od-PolicyTip-resolveButton,[dir=rtl] .xlg .od-PolicyTip-resolveButton,[dir=rtl] .xxlg .od-PolicyTip-resolveButton,[dir=rtl] .xxxlg .od-PolicyTip-resolveButton,[dir=rtl] .xxxxlg .od-PolicyTip-resolveButton{margin-right:24px}.md .od-PolicyTip-resolveButton,.sm .od-PolicyTip-resolveButton{display:inline-block;width:100%;margin-top:8px}html[dir=ltr] .md .od-PolicyTip-resolveButton,html[dir=ltr] .sm .od-PolicyTip-resolveButton{text-align:right}html[dir=rtl] .md .od-PolicyTip-resolveButton,html[dir=rtl] .sm .od-PolicyTip-resolveButton{text-align:left}.od-PolicyTip-resolveButton button{min-width:100px}.od-PolicyTip-justifyLabel.ms-Label{padding-bottom:16px}.od-PolicyTip-justifyText{overflow:auto}.od-TextField.od-TextField--multiline .od-PolicyTip-justifyText.od-TextField-field{min-height:150px;font-size:12px}.od-PolicyTip-justifyText--error.od-TextField-field{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-PolicyTip-justifyError{padding-top:2px;height:2em;color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var o,u=n(1927);(function(e){e[e.loading=0]="loading";e[e.tip=1]="tip";e[e.resolve=2]="resolve";e[e.justify=3]="justify";e[e.status=4]="status";e[e.error=5]="error"})(o||(o={}));var a=o,f=(function(){function e(){}e.getTemplateName=function(t){switch(t){case a.loading:return e.LOADING;case a.tip:return e.TIP;case a.resolve:return e.RESOLVE;case a.justify:return e.JUSTIFY;case a.status:case a.error:return e.MESSAGE;default:return e.LOADING}};e.LOADING="od-policy-tip-loading";e.TIP="od-policy-tip-tip";e.RESOLVE="od-policy-tip-resolve";e.JUSTIFY="od-policy-tip-justify";e.MESSAGE="od-policy-tip-message";return e})(),l=n(3741),c=n(1834),h=n(2619),p=n(2039),d=n(1847),v=n(374),m=n(1910),g=n(1143),y=n(149),b=n(18),w=n(1843),E=0,S=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=u.e.tagName;n.addBindingHandlers({bindableHtml:p.e,keyboard:d.e,visibility:h.e});E++;n.strings=l;n.info=t.policyInfo;n._state=t.state;n.buttonsAvailable=t.buttonsAvailable;n._action=t.action;n._item=t.item;n.justificationText=t.justificationText;n.justificationError=t.justificationError;n.messageText=t.messageText;n.justificationTextId="ms-policy-tip-justify-"+E;n._parentEvt=t.logEvt;n.resolveSections=[{heading:n.strings.ResolveOverrideHeading,descriptionHtml:b.format(n.strings.ResolveOverrideInfo,'<span class="ms-fontWeight-semibold">',"</span>"),buttonText:n.strings.ResolveOverride,buttonClick:function(){return n._overrideClick()},automationId:"PolicyTipDialogOverride",isVisible:function(){return!!n.info().overrideOption},isSpinnerVisible:n.createPureComputed(function(){return!n.buttonsAvailable()&&0===n._action()})},{heading:n.strings.ResolveReportHeading,descriptionHtml:b.format(n.strings.ResolveReportInfo,'<span class="ms-fontWeight-semibold">',"</span>"),buttonText:n.strings.ResolveReport,buttonClick:function(){return n._reportClick()},automationId:"PolicyTipDialogReport",isVisible:function(){return!0},isSpinnerVisible:n.createPureComputed(function(){return!n.buttonsAvailable()&&1===n._action()})}];var r=n.resources.consume(w.t);n.resolveDescriptionFirst=n.createPureComputed(function(){var e=r.formFactorSize();return"Small"===e||"Medium"===e});n.templateName=n.createPureComputed(function(){return f.getTemplateName(n._state())});n.resolutionTemplate=n.createPureComputed(function(){var e=n.info();if(e){var t="";if(e.policyInfoUrl){t=b.format(n.strings.TipLearnMore,'<a href="javascript:" data-bind="click: $component.learnMoreClick.bind($component), keyboard: learnMoreKeyboardInfo">',"</a>");n.learnMoreKeyboardInfo={mappings:{Enter:n.learnMoreClick.bind(n),Space:n.learnMoreClick.bind(n)},preventDefault:!0}}n.openKeyboardInfo={mappings:{Enter:n.openClick.bind(n),Space:n.openClick.bind(n)},preventDefault:!0};return b.format(n.strings.TipText,'<a href="javascript:" data-bind="click: openClick, keyboard: openKeyboardInfo">',"</a>",'<span class="ms-fontWeight-semibold">',"</span>",t)}return""});n.lastScannedText=n.createPureComputed(function(){var e=n.info();if(e)try{return n.strings.TipLastScanned+": "+Object(g.r)(e.lastScanned)}catch(e){}return""});n.subscribe(n._state,function(){var e=document.getElementsByClassName("od-Dialog")[0];e&&Object(m.focusFirstTabStop)(e)});y.e.logData({name:"PolicyTip.DialogRendered",extraData:{screenSize:r.formFactorSize()}},n._parentEvt);return n}t.prototype.openClick=function(e){this._logClick("OpenItem");var t=this.resources.consume(v.e),n=new(this.child(t.DefaultClickAction))({item:this._item,userInvokedItem:!0,sourceEngagement:"PolicyTip.Open.Click"});n.isAvailable()&&n.execute(e);n.dispose()};t.prototype.learnMoreClick=function(){this._logClick("LearnMore");window.open(this.info().policyInfoUrl,"_blank");return!1};t.prototype._overrideClick=function(){this._logClick("Override");this._action(0);return!1};t.prototype._reportClick=function(){this._logClick("Report");this._action(1);return!1};t.prototype._logClick=function(e){var t=a[this._state()],n="PolicyTip."+(t=t.charAt(0).toUpperCase()+t.slice(1))+"State."+e+".Click";y.e.logData({name:n},this._parentEvt)};return t})(c.t),x=n(1835),T=x.e({tagName:"od-policy-tip-dialog",template:'<div class="od-PolicyTip" data-bind="template:{name:templateName}"></div>',viewModel:S});x.t(f.LOADING,'<div class="od-PolicyTip-loading" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:strings.TipLoadingText}}"></div>');x.t(f.TIP,'<div class="od-PolicyTip-issuesExplanation">\x3c!--ko if:info().explanationText--\x3e<span data-bind="text:info().explanationText"></span><br><br>\x3c!--/ko--\x3e<span data-bind="bindableHtml:resolutionTemplate"></span></div><i class="od-PolicyTip-issuesIcon ms-Icon ms-Icon--DRM" data-bind="icon:true"></i><h3 class="od-PolicyTip-issuesHeader ms-font-m ms-fontWeight-semibold" data-bind="text:strings.TipIssues"></h3><ul class="od-PolicyTip-issueList" data-bind="foreach:info().issueDescriptions"><li data-bind="text:$data"></li></ul><div class="od-PolicyTip-lastScannedRow" data-bind="attr:{title:strings.TipLastScannedHelp,alt:strings.TipLastScannedHelp},text:lastScannedText"></div>');x.t(f.RESOLVE,'\x3c!--ko foreach:resolveSections--\x3e<div class="od-PolicyTip-resolveSection" data-bind="visible:isVisible()"><h3 class="od-PolicyTip-resolveHeading ms-font-m" data-bind="text:heading"></h3>\x3c!--ko if:$parent.resolveDescriptionFirst--\x3e<div data-bind="html:descriptionHtml"></div>\x3c!--/ko--\x3e<div class="od-PolicyTip-resolveButton"><span class="od-Dialog-actionsLoading" data-bind="component:{name:$component.loadingSpinnerTagName,params:{loadingText:\'\'}},visibility:isSpinnerVisible"></span><button class="od-Dialog-action od-Button od-Button--primary" data-bind="click:buttonClick,keyboard:{mappings:{Enter:buttonClick,Space:buttonClick},preventDefault:true},enable:$parent.buttonsAvailable(),automation:automationId"><span class="od-Button-label" data-bind="text:buttonText"></span></button></div>\x3c!--ko ifnot:$parent.resolveDescriptionFirst--\x3e<div data-bind="html:descriptionHtml"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e');x.t(f.JUSTIFY,'<div class="od-TextField od-TextField--multiline"><label class="od-Label od-PolicyTip-justifyLabel" data-bind="attr:{for:justificationTextId},text:strings.OverrideDescription"></label><textarea class="od-PolicyTip-justifyText od-TextField-field" required aria-required="true" maxlength="255" data-bind="value:justificationText,hasFocus:true,attr:{id:justificationTextId,placeholder:strings.OverridePlaceholder},css:{\'od-PolicyTip-justifyText--error\':justificationError}"></textarea></div><div class="od-PolicyTip-justifyError" aria-live="assertive" data-bind="text:justificationError"></div>');x.t(f.MESSAGE,'<div class="od-PolicyTip-section" data-bind="text:messageText"></div>');var N,C=T,k=n(303),L=n(1866),A=n(82),O=n(74),M=n(41),_=n(1844),D=n(2566),P=n(1959),H=n(32),B=n(1649);(function(e){e[e.None=0]="None";e[e.ItemIdParamMissing=1]="ItemIdParamMissing";e[e.ItemNotFound=2]="ItemNotFound";e[e.NoPolicyTipInitial=3]="NoPolicyTipInitial";e[e.GetItemServerError=4]="GetItemServerError";e[e.GetInfoServerError=5]="GetInfoServerError";e[e.UpdateServerNoResult=6]="UpdateServerNoResult";e[e.UpdateServerError=7]="UpdateServerError";e[e.NoPolicyTipFinal=8]="NoPolicyTipFinal";e[e.NoNotifyAction=9]="NoNotifyAction"})(N||(N={}));var j=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name="PolicyTip";n._dialogProvider=n.resources.consume(L.e);n._policyTipDataSource=n.resources.consume(A.V);n._panelProvider=n.resources.consume(P.e);n._item=n.observables.create(null);if(t.item&&t.item())n._itemPromise=O.n.wrap([t.item()]);else if(t.itemKey){var r=n.resources.consume(B.resourceKey);n._itemPromise=r.getSpecifiedItems({itemKeys:[t.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}else{n._errorType=N.ItemIdParamMissing;n._itemPromise=O.n.wrapError()}return n}t.prototype.onExecute=function(e,t){var n,r=this;if(Object(H.isFeatureEnabled)(H.PolicyTipPanel))return this._itemPromise.then(function(e){if(e[0]){n=e[0];return r._policyTipDataSource.getPolicyTip(n)}}).then(function(e){if(e){var t={item:n,policyTipInfo:e};r._panel=r._panelProvider.requestPanel({component:{name:D.e.tagName,params:t}});return r._panel.wait()}}).then(function(){return r._evtEndObj});this._state=this.observables.create(a.loading);this._buttonsAvailable=this.observables.create(!0);this._justificationText=this.observables.create("");this._justificationError=this.observables.create("");this._messageText=this.observables.create("");this._titleOverride="";this._action=this.observables.create(null);this._info=this.observables.create(null);this._logEvt=t;this._title=this.createPureComputed(function(){var e=r._state();e!==a.status&&e!==a.error&&(r._titleOverride="");switch(e){case a.loading:return l.TipHeadingNoFile;case a.tip:return r._getDocNameTitle();case a.resolve:return l.ResolveTitle;case a.justify:return l.OverrideTitle;case a.status:return r._titleOverride||r._getDocNameTitle();case a.error:return r._titleOverride||l.ErrorTitle}return""});this.subscribe(this._action,function(e){0===e?r._handleOverrideClick():1===e&&r._updateServer()});this._itemPromise.done(function(e){var t=e[0];if(t)if(2!==t.policyTip){r._item(t);r._policyTipDataSource.getPolicyTip(t).done(function(e){if(e){e.issueDescriptions&&e.issueDescriptions.length&&y.e.logData({name:"PolicyTip.ItemWithIssues",extraData:{count:e.issueDescriptions.length}});r._info(e);r._state(a.tip)}else{r._errorType=N.NoPolicyTipInitial;r._showError()}},function(e){r._errorType=N.GetInfoServerError;r._showError(e)})}else{r._errorType=N.NoNotifyAction;r._showError()}else{r._errorType=N.ItemNotFound;r._showError()}},function(e){r._errorType||(r._errorType=N.GetItemServerError);r._showError(e)});var i={item:this._item,policyInfo:this._info,state:this._state,buttonsAvailable:this._buttonsAvailable,justificationText:this._justificationText,justificationError:this._justificationError,messageText:this._messageText,action:this._action,logEvt:this._logEvt},s=function(e){return r.createPureComputed(function(){return r._state()===e})},o=this.observables.create(!1);this.subscribe(o,function(e){r._buttonsAvailable(!e)});return this._dialogProvider.requestDialog({title:this._title,size:"Medium",component:{name:C.tagName,params:i},actions:[{name:l.TipResolve,execute:function(){return r._showState(a.resolve,"Resolve")},isVisible:s(a.tip),isAvailable:this._buttonsAvailable,isDefault:!0,icon:new _.e("Save"),automationId:"PolicyTipDialogResolve"},{name:l.TipClose,execute:function(){return r._dismissWithButton("Close")},isVisible:this.createPureComputed(function(){var e=r._state();return e===a.tip||e===a.error}),isAvailable:this._buttonsAvailable,icon:new _.e("Cancel"),automationId:"PolicyTipDialogClose"},{name:l.ResolveBack,execute:function(){return r._showState(a.tip,"Back")},isVisible:s(a.resolve),isAvailable:this._buttonsAvailable,icon:new _.e("Cancel"),automationId:"PolicyTipDialogBack"},{name:l.OverrideSubmit,execute:function(){r._logClick("Submit");return r._submitOverride()},isVisible:s(a.justify),isAvailable:this._buttonsAvailable,isDefault:!0,icon:new _.e("Save"),automationId:"PolicyTipDialogSubmit",isExecuting:o},{name:l.OverrideCancel,execute:function(){return r._dismissWithButton("Cancel")},isVisible:s(a.justify),isAvailable:this._buttonsAvailable,icon:new _.e("Cancel"),automationId:"PolicyTipDialogCancel"},{name:l.StatusOK,execute:function(){r._logClick("OK");return O.n.wrap(2)},isVisible:s(a.status),isAvailable:this._buttonsAvailable,isDefault:!0,icon:new _.e("Save"),automationId:"PolicyTipDialogOK"}]}).wait().then(function(){return O.n.wrap(r._evtEndObj)},function(){r._dismissedByButton||r._logClick("Dismiss");r._evtEndObj||(r._evtEndObj={resultType:M.e.ExpectedFailure,resultCode:"CanceledOrClosed"});return O.n.wrap(r._evtEndObj)})};t.prototype._showState=function(e,t){this._logClick(t);this._state(e);return O.n.wrap(1)};t.prototype._dismissWithButton=function(e){this._logClick("Close");this._dismissedByButton=!0;return O.n.wrap(3)};t.prototype._logClick=function(e){var t=a[this._state()],n="PolicyTip."+(t=t.charAt(0).toUpperCase()+t.slice(1))+"State."+e+".Click";y.e.logData({name:n},this._logEvt)};t.prototype._getDocNameTitle=function(){var e=this._item();return b.format(l.TipHeading,e?e.displayName||e.name:"")};t.prototype._handleOverrideClick=function(){if(2!==this._info().overrideOption)return this._submitOverride();this._justificationError("");this._state(a.justify)};t.prototype._submitOverride=function(){if(2!==this._info().overrideOption||this._justificationText()){this._justificationError("");this._updateServer()}else this._justificationError(l.OverrideError);return O.n.wrap(1)};t.prototype._updateServer=function(){var e=this;this._buttonsAvailable(!1);var t={item:this._item(),action:this._action(),justification:this._justificationText()};this._policyTipDataSource.updatePolicy(t).done(function(t){if(null===t){e._errorType=N.UpdateServerNoResult;e._showError()}else if(0===t){e._errorType=N.NoPolicyTipFinal;e._showError()}else{e._titleOverride=l.StatusTitle;1===t?e._messageText(l.StatusReportSuccess):e._messageText(l.StatusOverrideSuccess);e._evtEndObj={resultType:M.e.Success};e._state(a.status);e._buttonsAvailable(!0)}},function(t){e._errorType=N.UpdateServerError;e._showError(t)})};t.prototype._showError=function(e){try{"string"==typeof e&&(e=JSON.parse(e))}catch(e){}var t;switch(this._errorType){case N.ItemNotFound:this._titleOverride=l.FileNotFoundTitle;this._messageText(l.FileNotFoundMessage);t=M.e.Failure;break;case N.NoPolicyTipInitial:case N.NoPolicyTipFinal:this._titleOverride=this._getDocNameTitle();this._messageText(l.StatusNoPolicyTip);t=M.e.ExpectedFailure;break;case N.NoNotifyAction:this._titleOverride=this._getDocNameTitle();this._messageText(k.policyTipBlockText);t=M.e.ExpectedFailure;break;default:this._messageText(e&&e.error&&e.error.message&&e.error.message.value||e&&e.detailedText||"string"==typeof e&&e||l.ErrorText);t=M.e.Failure}this._evtEndObj={resultCode:N[this._errorType],resultType:t,error:this._messageText(),extraData:{error:e}};this._buttonsAvailable(!0);this._state(a.error)};return t})(i.e);t.default=j}],Array(753),[function(e,t,n){"use strict";n.r(t);n.d(t,"PolicyTipAction",function(){return s});var r=n(2646),i=n(374),s=Object(r.e)(function(e,t){var n=e.consume(i.e);return new(e.injected(n.PolicyTipAction))({item:t.item})})}])]);