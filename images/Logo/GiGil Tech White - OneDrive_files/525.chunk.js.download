(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[525,82],{1143:function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"i",function(){return N});n.d(t,"s",function(){return k});n.d(t,"e",function(){return L});n.d(t,"n",function(){return A});n.d(t,"o",function(){return O});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(624),v=n(2052),m=n(403),g=n(18),y=n(260),b=n(350),w=n(305),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function T(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=H(u,-1),f=H(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=M(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,j({month:"short",day:"numeric"},r));if(o<w.o)return n?v.n:v.t;if(h&&o<w.t)return B(o,v.i,w.n);if(w.l(u,e))return g?B(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,j({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,j({weekday:"long"},r))}return w.c(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.e.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function O(e,t){return w.p(e,M(m.e.language),t)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},1669:function(e,t,n){"use strict";n.r(t);n.d(t,"ConfirmationDialog",function(){return c});var r=n("react-lib"),i=n(1991),s=n(1864),o=n(1889),u=n(1922),a=n(1653),f=n(2100),l=n(2502),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.defaultFocusToYes,d=void 0!==p&&p,v=e.yesText,m=void 0===v?l.t:v,g=e.noText,y=void 0===g?l.e:g,b=function(e){e&&e.focus()},w=h?u.e:a.e,E=h?a.e:u.e,S=d?void 0:b,x=d?b:void 0;return r.createElement(f.e,null,r.createElement(i.e,{dialogContentProps:{type:s.e.close,subText:e.prompt?e.prompt:""},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(o.e,null,r.createElement(w,{"data-automationid":"confirmbutton",onClick:t,componentRef:x},m),r.createElement(E,{"data-automationid":"cancelbutton",onClick:n,componentRef:S},y))))}},1864:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.normal=0]="normal";e[e.largeHeader=1]="largeHeader";e[e.close=2]="close"})(r||(r={}))},1889:function(e,t,n){"use strict";n.d(t,"e",function(){return h});var r=n(1557),i=n(5),s=n("react-lib"),o=n(549),u=n(1039),a=Object(o.e)(),f=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(u.e)(n);return n}t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;this._classNames=a(n,{theme:r,className:t});return s.createElement("div",{className:this._classNames.actions},s.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))};t.prototype._renderChildrenAsActions=function(){var e=this;return s.Children.map(this.props.children,function(t){return t?s.createElement("span",{className:e._classNames.action},t):null})};return t})(s.Component),l=n(29),c={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},h=Object(r.e)(f,function(e){var t=e.className,n=e.theme,r=Object(l.x)(c,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action,{margin:"0 4px"}],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}},void 0,{scope:"DialogFooter"})},1922:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(5),i=n("react-lib"),s=n(1630),o=n(1628),u=n(1653),a=(function(e){Object(r.r)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return i.createElement(u.e,Object(r.e)({},this.props,{primary:!0,onRenderDescription:s.t}))};return t=Object(r.n)([Object(o.e)("PrimaryButton",["theme","styles"],!0)],t)})(i.Component)},1956:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(1557),i=n(5),s=n("react-lib"),o=n(549),u=n(1039),a=n(1032),f=n(103),l=Object(o.e)(),c=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(u.e)(n);var r=n.props.allowTouchBodyScroll,i=void 0!==r&&r;n._allowTouchBodyScroll=i;return n}t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(a.n)()};t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(a.r)()};t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,r=e.theme,o=e.styles,u=Object(f.u)(this.props,f.s),a=l(o,{theme:r,className:n,isDark:t});return s.createElement("div",Object(i.e)({},u,{className:a.root}))};return t})(s.Component),h=n(29),p={root:"ms-Overlay",rootDark:"ms-Overlay--dark"},d=Object(r.e)(c,function(e){var t,n=e.className,r=e.theme,i=e.isNone,s=e.isDark,o=r.palette,u=Object(h.x)(p,r);return{root:[u.root,r.fonts.medium,{backgroundColor:o.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[h.s]={border:"1px solid WindowText",opacity:0},t)},i&&{visibility:"hidden"},s&&[u.rootDark,{backgroundColor:o.blackTranslucent40}],n]}},void 0,{scope:"Overlay"})},1973:function(e,t,n){"use strict";n.d(t,"e",function(){return P});var r=n(1557),i=n(5),s=n("react-lib"),o=n(549),u=n(1032),a=n(158),f=n(1140),l=n(242),c=n(113),h=n(1503),p=n(754),d=n(1829),v=n(29),m=v.n.durationValue2,g={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},y=n(1956),b=n(1642),w=n(1800),E=n(222),S=n(111),x=n(831),T=n(94),N=Object(T.t)(function(e,t){return{root:Object(v.H)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),C=n(1141),k={start:"touchstart",move:"touchmove",stop:"touchend"},L={start:"mousedown",move:"mousemove",stop:"mouseup"},A=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._currentEventType=L;n._events=[];n._onMouseDown=function(e){var t=s.Children.only(n.props.children).props.onMouseDown;t&&t(e);n._currentEventType=L;return n._onDragStart(e)};n._onMouseUp=function(e){var t=s.Children.only(n.props.children).props.onMouseUp;t&&t(e);n._currentEventType=L;return n._onDragStop(e)};n._onTouchStart=function(e){var t=s.Children.only(n.props.children).props.onTouchStart;t&&t(e);n._currentEventType=k;return n._onDragStart(e)};n._onTouchEnd=function(e){var t=s.Children.only(n.props.children).props.onTouchEnd;t&&t(e);n._currentEventType=k;n._onDragStop(e)};n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var r=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,r);n.setState({isDragging:!0,lastPosition:t});n._events=[Object(C.e)(document.body,n._currentEventType.move,n._onDrag,!0),Object(C.e)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}};n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var r=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=r.position;n.props.onDragChange&&n.props.onDragChange(e,r);n.setState({position:i,lastPosition:t})}};n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var r=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0});n.props.onStop&&n.props.onStop(e,r);n.props.position&&n.setState({position:n.props.position});n._events.forEach(function(e){return e()})}}};n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0};return n}t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})};t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})};t.prototype.render=function(){var e=s.Children.only(this.props.children),t=e.props,n=this.props.position,r=this.state,o=r.position,u=r.isDragging,a=o.x,f=o.y;if(n&&!u){a=n.x;f=n.y}return s.cloneElement(e,{style:Object(i.e)(Object(i.e)({},t.style),{transform:"translate("+a+"px, "+f+"px)"}),className:N(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})};t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}};t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)};t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier};t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))};t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]};t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}};t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}};return t})(s.Component),O=n(1039),M={eventBubblingEnabled:!1},_=Object(o.e)(),D=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._focusTrapZone=s.createRef();n._registerInitialModalPosition=function(){var e,t=document.querySelector("[data-id="+n.state.id+"]");if(t){var r=t.getBoundingClientRect();if((null===(e=n.props.dragOptions)||void 0===e?void 0:e.keepInBounds)&&!n._minClampedPosition&&!n._maxClampedPosition){n._minClampedPosition={x:-r.x,y:-r.y};n._maxClampedPosition={x:r.x,y:r.y}}n.setState({modalRectangleTop:r.top})}};n._allowScrollOnModal=function(e){e?n._allowTouchBodyScroll?Object(u.e)(e,n._events):Object(u.t)(e,n._events):n._events.off(n._scrollableContent);n._scrollableContent=e};n._onModalContextMenuClose=function(){n.setState({isModalMenuOpen:!1})};n._onModalClose=function(){n._lastSetX=0;n._lastSetY=0;n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1,isOpen:!1,x:0,y:0});n.props.dragOptions&&n._hasRegisteredKeyUp&&n._events.off(window,"keyup",n._onKeyUp,!0);n.props.onDismissed&&n.props.onDismissed()};n._onDragStart=function(){n.setState({isModalMenuOpen:!1,isInKeyboardMoveMode:!1})};n._onDrag=function(e,t){var r=n.state,i=r.x,s=r.y;n.setState(n._getClampedPosition({x:i+t.delta.x,y:s+t.delta.y}))};n._onDragStop=function(){n.focus()};n._onKeyUp=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===a.e.space&&Object(f.e)(n._scrollableContent,e.target)){n.setState({isModalMenuOpen:!n.state.isModalMenuOpen});e.preventDefault();e.stopPropagation()}};n._onKeyDown=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===a.e.space){e.preventDefault();e.stopPropagation()}else{n.state.isModalMenuOpen&&(e.altKey||e.keyCode===a.e.escape)&&n.setState({isModalMenuOpen:!1});if(n.state.isInKeyboardMoveMode&&(e.keyCode===a.e.escape||e.keyCode===a.e.enter)){n.setState({isInKeyboardMoveMode:!1});e.preventDefault();e.stopPropagation()}if(n.state.isInKeyboardMoveMode){var t=!0,r=n._getMoveDelta(e);switch(e.keyCode){case a.e.escape:n.setState({x:n._lastSetX,y:n._lastSetY});case a.e.enter:n._lastSetX=0;n._lastSetY=0;n.setState({isInKeyboardMoveMode:!1});break;case a.e.up:n.setState({y:n._getClampedPositionY(n.state.y-r)});break;case a.e.down:n.setState({y:n._getClampedPositionY(n.state.y+r)});break;case a.e.left:n.setState({x:n._getClampedPositionX(n.state.x-r)});break;case a.e.right:n.setState({x:n._getClampedPositionX(n.state.x+r)});break;default:t=!1}if(t){e.preventDefault();e.stopPropagation()}}}};n._onEnterKeyboardMoveMode=function(){n._lastSetX=n.state.x;n._lastSetY=n.state.y;n.setState({isInKeyboardMoveMode:!0,isModalMenuOpen:!1});n._events.on(window,"keydown",n._onKeyDown,!0)};n._onExitKeyboardMoveMode=function(){n._lastSetX=0;n._lastSetY=0;n.setState({isInKeyboardMoveMode:!1});n._events.off(window,"keydown",n._onKeyDown,!0)};n._registerForKeyUp=function(){if(!n._hasRegisteredKeyUp){n._events.on(window,"keyup",n._onKeyUp,!0);n._hasRegisteredKeyUp=!0}};n._async=new l.e(n);n._events=new c.e(n);Object(O.e)(n);Object(h.e)("Modal",t,{onLayerDidMount:"layerProps.onLayerDidMount"});n.state={id:Object(p.e)("Modal"),isOpen:t.isOpen,isVisible:t.isOpen,hasBeenOpened:t.isOpen,x:0,y:0};n._lastSetX=0;n._lastSetY=0;var r=n.props.allowTouchBodyScroll,i=void 0!==r&&r;n._allowTouchBodyScroll=i;return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){clearTimeout(this._onModalCloseTimer);if(e.isOpen)if(this.state.isOpen)this.setState({hasBeenOpened:!0,isVisible:!0});else{this.setState({isOpen:!0});e.dragOptions&&this._registerForKeyUp()}if(!e.isOpen&&this.state.isOpen){this._onModalCloseTimer=this._async.setTimeout(this._onModalClose,1e3*parseFloat(m));this.setState({isVisible:!1})}};t.prototype.componentDidMount=function(){var e=this;if(this.state.isOpen&&this.state.isVisible){this._registerForKeyUp();requestAnimationFrame(function(){return setTimeout(e._registerInitialModalPosition,0)})}};t.prototype.componentDidUpdate=function(e,t){var n=this;e.isOpen||t.isVisible||this.setState({isVisible:!0});!e.isOpen&&this.props.isOpen&&requestAnimationFrame(function(){return setTimeout(n._registerInitialModalPosition,0)})};t.prototype.componentWillUnmount=function(){this._async.dispose();this._events.dispose()};t.prototype.render=function(){var e=this.props,t=e.className,n=e.containerClassName,r=e.scrollableContentClassName,o=e.elementToFocusOnDismiss,u=e.firstFocusableSelector,a=e.forceFocusInsideTrap,f=e.ignoreExternalFocusing,l=e.isBlocking,c=e.isClickableOutsideFocusTrap,h=e.isDarkOverlay,p=e.onDismiss,v=e.layerProps,m=e.overlay,g=e.responsiveMode,T=e.titleAriaId,N=e.styles,C=e.subtitleAriaId,k=e.theme,L=e.topOffsetFixed,O=e.onLayerDidMount,D=e.isModeless,P=e.isAlert,H=e.dragOptions,B=e.enableAriaHiddenSiblings,j=this.state,F=j.isOpen,I=j.isVisible,q=j.hasBeenOpened,R=j.modalRectangleTop,U=j.x,z=j.y,W=j.isInKeyboardMoveMode;if(!F)return null;var X=void 0===v?"":v.className,V=null!=P?P:l&&!D,$=_(N,{theme:k,className:t,containerClassName:n,scrollableContentClassName:r,isOpen:F,isVisible:I,hasBeenOpened:q,modalRectangleTop:R,topOffsetFixed:L,isModeless:D,layerClassName:X,isDefaultDragHandle:H&&!H.dragHandleSelector}),J=Object(i.e)(Object(i.e)(Object(i.e)({},M),this.props.layerProps),{onLayerDidMount:v&&v.onLayerDidMount?v.onLayerDidMount:O,insertFirst:D,className:$.layer}),K=s.createElement(d.e,{"data-id":this.state.id,componentRef:this._focusTrapZone,className:$.main,elementToFocusOnDismiss:o,isClickableOutsideFocusTrap:D||c||!l,ignoreExternalFocusing:f,forceFocusInsideTrap:D?!D:a,firstFocusableSelector:u,focusPreviouslyFocusedInnerElement:!0,onBlur:W?this._onExitKeyboardMoveMode:void 0,enableAriaHiddenSiblings:B},H&&W&&s.createElement("div",{className:$.keyboardMoveIconContainer},H.keyboardMoveIconProps?s.createElement(x.e,Object(i.e)({},H.keyboardMoveIconProps)):s.createElement(x.e,{iconName:"move",className:$.keyboardMoveIcon})),s.createElement("div",{ref:this._allowScrollOnModal,className:$.scrollableContent,"data-is-scrollable":!0},H&&this.state.isModalMenuOpen&&s.createElement(H.menu,{items:[{key:"move",text:H.moveMenuItemText,onClick:this._onEnterKeyboardMoveMode},{key:"close",text:H.closeMenuItemText,onClick:this._onModalClose}],onDismiss:this._onModalContextMenuClose,alignTargetEdge:!0,coverTarget:!0,directionalHint:S.e.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:this._scrollableContent}),this.props.children));return g>=E.e.small?s.createElement(b.e,Object(i.e)({},J),s.createElement(w.e,{role:V?"alertdialog":"dialog","aria-modal":!D,ariaLabelledBy:T,ariaDescribedBy:C,onDismiss:p,shouldRestoreFocus:!f},s.createElement("div",{className:$.root,role:D?void 0:"document"},!D&&s.createElement(y.e,Object(i.e)({isDarkThemed:h,onClick:l?void 0:p,allowTouchBodyScroll:this._allowTouchBodyScroll},m)),H?s.createElement(A,{handleSelector:H.dragHandleSelector||"."+$.main.split(" ")[0],preventDragSelector:"button",onStart:this._onDragStart,onDragChange:this._onDrag,onStop:this._onDragStop,position:{x:U,y:z}},K):K))):null};t.prototype.focus=function(){this._focusTrapZone.current&&this._focusTrapZone.current.focus()};t.prototype._getClampedPosition=function(e){return this.props.dragOptions&&this.props.dragOptions.keepInBounds?{x:this._getClampedPositionX(e.x),y:this._getClampedPositionY(e.y)}:e};t.prototype._getClampedPositionY=function(e){var t=this._minClampedPosition,n=this._maxClampedPosition;t&&(e=Math.max(t.y,e));n&&(e=Math.min(n.y,e));return e};t.prototype._getClampedPositionX=function(e){var t=this._minClampedPosition,n=this._maxClampedPosition;t&&(e=Math.max(t.x,e));n&&(e=Math.min(n.x,e));return e};t.prototype._getMoveDelta=function(e){var t=10;e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1);return t};t.defaultProps={isOpen:!1,isDarkOverlay:!0,isBlocking:!1,className:"",containerClassName:""};return t=Object(i.n)([E.n],t)})(s.Component),P=Object(r.e)(D,function(e){var t,n=e.className,r=e.containerClassName,i=e.scrollableContentClassName,s=e.isOpen,o=e.isVisible,u=e.hasBeenOpened,a=e.modalRectangleTop,f=e.theme,l=e.topOffsetFixed,c=e.isModeless,h=e.layerClassName,p=e.isDefaultDragHandle,d=f.palette,y=f.effects,b=f.fonts,w=Object(v.x)(g,f);return{root:[w.root,b.medium,{backgroundColor:"transparent",position:c?"absolute":"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+m},l&&"number"==typeof a&&u&&{alignItems:"flex-start"},s&&w.isOpen,o&&{opacity:1,pointerEvents:"auto"},n],main:[w.main,{boxShadow:y.elevation64,borderRadius:y.roundedCorner2,backgroundColor:d.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:c?v.g.Layer:void 0},l&&"number"==typeof a&&u&&{top:a},p&&{cursor:"move"},r],scrollableContent:[w.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:window.innerHeight},t)},i],layer:c&&[h,w.layer,{position:"static",width:"unset",height:"unset"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:b.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]})},1991:function(e,t,n){"use strict";n.d(t,"e",function(){return k});var r=n(1557),i=n(5),s=n("react-lib"),o=n(549),u=n(754),a=n(1864),f=n(1973),l=n(222),c=n(1039),h=n(1503),p=n(44),d=n(1662),v=n(1889),m=Object(o.e)(),g=s.createElement(v.e,null).type,y=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;Object(c.e)(n);Object(h.e)("DialogContent",t,{titleId:"titleProps.id"});return n}t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,r=t.className,o=t.closeButtonAriaLabel,u=t.onDismiss,f=t.subTextId,l=t.subText,c=t.titleProps,h=void 0===c?{}:c,v=t.titleId,g=t.title,y=t.type,b=t.styles,w=t.theme,E=t.draggableHeaderClassName,S=m(b,{theme:w,className:r,isLargeHeader:y===a.e.largeHeader,isClose:y===a.e.close,draggableHeaderClassName:E}),x=this._groupChildren();l&&(e=s.createElement("p",{className:S.subText,id:f},l));return s.createElement("div",{className:S.content},s.createElement("div",{className:S.header},s.createElement("div",Object(i.e)({id:v,role:"heading","aria-level":1},h,{className:Object(p.e)(S.title,h.className)}),g),s.createElement("div",{className:S.topButton},this.props.topButtonsProps.map(function(e,t){return s.createElement(d.e,Object(i.e)({key:e.uniqueId||t},e))}),(y===a.e.close||n&&y!==a.e.largeHeader)&&s.createElement(d.e,{className:S.button,iconProps:{iconName:"Cancel"},ariaLabel:o,onClick:u}))),s.createElement("div",{className:S.inner},s.createElement("div",{className:S.innerContent},e,x.contents),x.footers))};t.prototype._groupChildren=function(){var e={footers:[],contents:[]};s.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===g?e.footers.push(t):e.contents.push(t)});return e};t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"};return t=Object(i.n)([l.n],t)})(s.Component),b=n(29),w={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},E=Object(r.e)(y,function(e){var t,n,r,i=e.className,s=e.theme,o=e.isLargeHeader,u=e.isClose,a=e.hidden,f=e.isMultiline,l=e.draggableHeaderClassName,c=s.palette,h=s.fonts,p=s.effects,d=s.semanticColors,v=Object(b.x)(w,s);return{content:[o&&[v.contentLgHeader,{borderTop:"4px solid "+c.themePrimary}],u&&v.close,{flexGrow:1,overflowY:"hidden"},i],subText:[v.subText,h.medium,{margin:"0 0 24px 0",color:d.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:b.i.regular}],header:[v.header,{position:"relative",width:"100%",boxSizing:"border-box"},u&&v.close,l&&[l,{cursor:"move"}]],button:[v.button,a&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:d.buttonText,fontSize:b.u.medium}}}],inner:[v.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+b.p+"px) and (max-width: "+b.l+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[v.content,{position:"relative",width:"100%"}],title:[v.title,h.xLarge,{color:d.bodyText,margin:"0",minHeight:h.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+b.p+"px) and (max-width: "+b.l+"px)"]={padding:"16px 46px 16px 16px"},n)},o&&{color:d.menuHeader},f&&{fontSize:h.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(r={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:d.buttonText},".ms-Dialog-button:hover":{color:d.buttonTextHovered,borderRadius:p.roundedCorner2}},r["@media (min-width: "+b.p+"px) and (max-width: "+b.l+"px)"]={padding:"15px 8px 0 0"},r)}]}},void 0,{scope:"DialogContent"}),S=Object(o.e)(),x={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},T={type:a.e.normal,className:"",topButtonsProps:[]},N=(function(e){Object(i.r)(t,e);function t(t){var n=e.call(this,t)||this;n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,i=e.dialogContentProps,s=e.subText,o=r&&r.subtitleAriaId||t;o||(o=(i&&i.subText||s)&&n._defaultSubTextId);return o};n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,i=e.dialogContentProps,s=e.title,o=r&&r.titleAriaId||t;o||(o=(i&&i.title||s)&&n._defaultTitleTextId);return o};n._id=Object(u.e)("Dialog");n._defaultTitleTextId=n._id+"-title";n._defaultSubTextId=n._id+"-subText";0;return n}t.prototype.render=function(){var e,t,n,r,o=this.props,u=o.className,a=o.containerClassName,l=o.contentClassName,c=o.elementToFocusOnDismiss,h=o.firstFocusableSelector,p=o.forceFocusInsideTrap,d=o.styles,v=o.hidden,m=o.ignoreExternalFocusing,g=o.isBlocking,y=o.isClickableOutsideFocusTrap,b=o.isDarkOverlay,w=o.isOpen,N=o.onDismiss,C=o.onDismissed,k=o.onLayerDidMount,L=o.responsiveMode,A=o.subText,O=o.theme,M=o.title,_=o.topButtonsProps,D=o.type,P=o.minWidth,H=o.maxWidth,B=o.modalProps,j=Object(i.e)({},B?B.layerProps:{onLayerDidMount:k});k&&!j.onLayerDidMount&&(j.onLayerDidMount=k);if(B&&B.dragOptions&&!B.dragOptions.dragHandleSelector){n="ms-Dialog-draggable-header";r=Object(i.e)(Object(i.e)({},B.dragOptions),{dragHandleSelector:"."+n})}else r=B&&B.dragOptions;var F=Object(i.e)(Object(i.e)(Object(i.e)(Object(i.e)({},x),{className:u,containerClassName:a,isBlocking:g,isDarkOverlay:b,onDismissed:C}),B),{layerProps:j,dragOptions:r}),I=Object(i.e)(Object(i.e)(Object(i.e)({className:l,subText:A,title:M,topButtonsProps:_,type:D},T),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(i.e)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),q=S(d,{theme:O,className:F.className,containerClassName:F.containerClassName,hidden:v,dialogDefaultMinWidth:P,dialogDefaultMaxWidth:H});return s.createElement(f.e,Object(i.e)({elementToFocusOnDismiss:c,firstFocusableSelector:h,forceFocusInsideTrap:p,ignoreExternalFocusing:m,isClickableOutsideFocusTrap:y,responsiveMode:L},F,{isOpen:void 0!==w?w:!v,className:q.root,containerClassName:q.main,onDismiss:N||F.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),s.createElement(E,Object(i.e)({subTextId:this._defaultSubTextId,showCloseButton:F.isBlocking,onDismiss:N},I),this.props.children))};t.defaultProps={hidden:!0};return t=Object(i.n)([l.n],t)})(s.Component),C={root:"ms-Dialog"},k=Object(r.e)(N,function(e){var t,n=e.className,r=e.containerClassName,i=e.dialogDefaultMinWidth,s=void 0===i?"288px":i,o=e.dialogDefaultMaxWidth,u=void 0===o?"340px":o,a=e.hidden,f=e.theme;return{root:[Object(b.x)(C,f).root,f.fonts.medium,n],main:[{width:s,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+b.h+"px)"]={width:"auto",maxWidth:u,minWidth:s},t)},!a&&{display:"flex"},r]}},void 0,{scope:"Dialog"});k.displayName="Dialog"},2076:function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return i});var r,i,s={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged"};(function(e){e[e.user=0]="user";e[e.date=1]="date";e[e.fileType=2]="fileType";e[e.choice=3]="choice";e[e.hierarchy=4]="hierarchy"})(r||(r={}));(function(e){e[e.none=0]="none";e[e.last3Months=1]="last3Months";e[e.last30Days=2]="last30Days";e[e.last7Days=3]="last7Days";e[e.yesterday=4]="yesterday";e[e.today=5]="today";e[e.tomorrow=6]="tomorrow";e[e.next7Days=7]="next7Days";e[e.next30Days=8]="next30Days";e[e.next3Months=9]="next3Months";e[e.nextYear=10]="nextYear"})(i||(i={}))},2100:function(e,t,n){"use strict";n.d(t,"e",function(){return a});n.d(t,"t",function(){return f});var r=n("react-lib"),i=n(1179),s=n(145),o=n(113),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),f=r.useRef(),c=f.current||n&&a.keyboardManager||(f.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=l(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(){return l(r.useContext(i.e).keyboardManager)}function l(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}},2414:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(18);function i(e){return new Date(e)}function s(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,s=n.getFullYear()+"",o=Object(r.leftPad)(n.getMonth()+1+"",2),u=Object(r.leftPad)(n.getDate()+"",2),a=Object(r.leftPad)(n.getHours()+"",2),f=Object(r.leftPad)(n.getMinutes()+"",2),l=Object(r.leftPad)(n.getSeconds()+"",2),c=(i?"+":"-")+Object(r.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(r.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}},2436:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("bundle")},2533:function(e,t,n){"use strict";n.d(t,"e",function(){return M});n.d(t,"t",function(){return D});var r=n(0),i=n(107),s=n(4),o=n(7),u=n(62),a=n(1176),f=n(2660),l=n(2792),c=n(641),h=n(1188),p=n(635),d=n(140),v=n(39),m=n(863),g=n(1227),y=n(853),b=n(2717),w=n(3345),E=n(2935),S=n(3018),x=n(2791),T=n(157),N=n(3346),C=n(3017),k=n(648),L=n(3124),A=n(3125),O=n(261);function M(e){var t=e.itemKey,n=e.driveItemKey,P=e.driveItem,H=e.endpoint,B=e.parentFolderItemKey,j=e.shouldReturnShareFacets,F=void 0===j||j,I=P.coverImage,q=P.file,R=P.fileSystemInfo,U=P.name,z=P.parentReference,W=P.remoteItem,X=P.root,V=P.size,$=P.thumbnails,J=P.image,K=P.video,Q=P.eTag,G=P.tags,Y=P.photo,Z=P.specialFolder;return function(e){var j,ee,te,ne=P.lastModifiedDateTime,re=void 0===ne?R&&R.lastModifiedDateTime||W&&W.lastModifiedDateTime:ne,ie=P.createdDateTime||R&&R.createdDateTime||W&&W.createdDateTime,se=z&&z.driveId,oe=z&&z.driveType||W&&W.parentReference&&W.parentReference.driveType,ue="personal"===oe,ae=R&&R.lastAccessedDateTime||W&&W.fileSystemInfo&&W.fileSystemInfo.lastAccessedDateTime,fe=null===(ee=Y)||void 0===ee?void 0:ee.takenDateTime,le=P.package||W&&W.package,ce=$||W&&W.thumbnails,he=J||W&&W.image,pe=K||W&&W.video,de=P.shared||W&&W.shared,ve={itemId:P.id,driveId:se,endpoint:H},me=R&&R.systemPath,ge=n||W&&W.parentReference&&{itemId:W.id,driveId:W.parentReference.driveId,endpoint:H}||ve,ye=u.e.serialize(ge),be=P.webDavUrl||W&&W.webDavUrl;te="business"!==oe&&"documentLibrary"!==oe&&"personal"!==oe||!X?U||W&&W.name||"":p.t;var we=P.folder||W&&W.folder,Ee=V||W&&W.size,Se=we&&we.childCount,xe=D(te,!!we),Te=xe.extension||P.package&&P.package.type,Ne=Te&&Object(w.e)(Te),Ce=P.sharepointIds||W&&W.sharepointIds,ke=P.localItem,Le=P.webUrl||W&&W.webUrl,Ae=new O.e({publisher:M});Ae.resolveItems({items:(j={},j[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(ge)),s.h.pack(te)),void 0!==Ee?s.v.pack(Ee):{}),R||P.folder||q||W&&W.folder?Object(r.__assign)({},s.m.pack(we?{}:void 0)):{}),Le?s.O.pack(Le):{}),y.r.pack(me)),be?s.i.pack(decodeURIComponent(be)):{}),s.f.pack(re?new Date(re).getTime():void 0)),s.u.pack(ie?new Date(ie).getTime():void 0)),d.u.pack(fe?new Date(fe).getTime():void 0)),ae?Object(r.__assign)({},s.o.pack(new Date(ae).getTime())):{}),i.i.pack(le&&"oneNote"===le.type?{}:void 0)),ce?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(ce)),x.e.pack(!0)),C.e.pack(Object(k.i)(xe.extension))):{}),Object(T.e)().forFacet(d.v).thenInvalidate(ye,f.e).pack()),l.e.pack(P)),Q?s.p.pack(Q):{}),he&&he.width&&he.height?d.a.pack({width:he.width,height:he.height}):{}),he&&!pe?d.p.pack({}):{}),pe?d.g.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:ge,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:c.e.serialize({driveItemKey:ge})})),s.M.pack(B?{itemKey:B}:void 0)),!ue&&be?Object(r.__assign)({},s._.pack(_(be))):{}),m.e.pack(oe)),ue?Object(r.__assign)({},g.e.pack(P.vault)):{}),ue&&P.restricted?Object(r.__assign)({},L.e.pack(P.restricted)):{}),s.d.pack(xe)),F?Object(r.__assign)(Object(r.__assign)({},s.x.pack(!!de)),h.e.pack(de)):{}),ke?y.t.pack(ke):{}),"number"==typeof Se?v.e.pack(Se):{}),N.e.pack(I)),A.e.pack(G)),y.n.pack(q&&q.mimeType)),Ne?b.e.pack(Ne):{}),Ce?E.e.pack(Ce):{}),Z?S.e.pack(Z.name):{}),j)});return{itemResolver:Ae}}}function _(e){var t=e.split("/");return t.length>2?decodeURIComponent(t[t.length-2]):void 0}function D(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},2534:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(20).e)("itemsViewSearchControl")},2594:function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},2645:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var r=n(201),i=n("react-lib"),s=n(1247),o=n(4),u=n(19),a=n(626),f=n(153),l=n(168);var c=n(217),h=n(77),p=n(885),d=n(886),v=n(880),m=n(881),g=n(878),y=Object(p.e)({key:c.s,name:r.a,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.M,n),h=c&&e.demandItemFacet(o.O,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.r)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])},2647:function(e,t,n){"use strict";function r(e){return void 0!==e.action}function i(e){return void 0!==e.activityDateTime}function s(e){var t=y(e).comment;return void 0!==t&&!t.isReply}function o(e){var t=y(e).comment;return void 0!==t&&t.isReply}function u(e){return void 0!==y(e).mention}function a(e){return void 0!==y(e).version}function f(e){return void 0!==y(e).pointInTimeRestore}function l(e){return void 0!==y(e).restoreVersion}function c(e){return void 0!==y(e).move}function h(e){return void 0!==y(e).rename}function p(e){return void 0!==y(e).delete}function d(e){return void 0!==y(e).share}function v(e){var t=y(e).addToOneDrive;return void 0!==t&&!t.removedDateTime}function m(e){var t=y(e).addToOneDrive;return void 0!==t&&!!t.removedDateTime}function g(e){return function(t){return u(t)?e.Mention(t):s(t)?e.Comment(t):o(t)?e.CommentResponse(t):(function(e){return void 0!==y(e).create})(t)?e.Create(t):p(t)?e.Delete(t):(function(e){return void 0!==y(e).edit})(t)?e.Edit(t):c(t)?e.Move(t):h(t)?e.Rename(t):(function(e){return void 0!==y(e).restore})(t)?e.Restore(t):l(t)?e.RestoreVersion(t):d(t)?e.Share(t):a(t)?e.Version(t):(function(e){return void 0!==y(e).copy})(t)?e.Copy(t):f(t)?e.PointInTimeRestore(t):v(t)?e.AddShortcutToOneDrive(t):m(t)?e.RemoveShortcutFromOneDrive(t):void 0}}function y(e){return r(e)?e.action:e}function b(e){return e.driveItem||e.listItem}var w=n(75),E=!n(49).t.isActivated("DC1B3A2B-2469-49B2-9230-7F6CD01BD84C","12/30/2020","Enable deeplinking for comment activities"),S=(function(){function e(){}e.prototype.processResponse=function(e){var t=this,n=e.item,r=e.response;return{isPlaceholder:!1,activities:r.value.map(function(e){if(i(e))if(s(e)||o(e)){var r=y(e).comment;(r.contentId||r.navigationId)&&(e.docDetails={contentId:r.contentId,navigationId:r.navigationId})}else if(u(e)){var a=y(e).mention;(a.contentId||a.navigationId)&&(e.docDetails={contentId:a.contentId,navigationId:a.navigationId})}return t._processActivityResponse(n,e)}),nextRequestToken:this._getNextRequestToken(r),success:!0}};e.prototype.processActivitiesByIntervalResponse=function(e){var t=this;return{activitiesByInterval:e.value.map(function(e){return t._processActivitySummaryResponse(e)}),success:!0}};e.prototype._processActivitySummaryResponse=function(e){return{totalCount:(void 0!==e.create?e.create.actionCount:0)+(void 0!==e.delete?e.delete.actionCount:0)+(void 0!==e.edit?e.edit.actionCount:0)+(void 0!==e.move?e.move.actionCount:0)+(void 0!==e.rename?e.rename.actionCount:0)+(void 0!==e.restore?e.restore.actionCount:0)+(void 0!==e.copy?e.copy.actionCount:0),startDateTime:new Date(e.startDateTime),endDateTime:new Date(e.endDateTime)}};e.prototype._getNextRequestToken=function(e){if(e.value&&!(e.value.length<1)){var t=e["@odata.nextLink"],n=t&&t.match(/skiptoken=([^&]+)/i);return n?n[1]:void 0}};e.prototype._processActivityResponse=function(e,t){var n=this._getItem(e,t),r=this._getParentItem(t),s=this._getAction(e,n,r,t);if(i(t)){var o=t.actor&&t.actor.user,u=o&&{displayName:o.displayName,id:o.id,email:o.email,self:o.self};return{id:t.id,type:this._getActivityType(t),actors:u?[u]:[],item:n,parentItem:r,time:new Date(t.activityDateTime),action:s}}var a=t.actor&&t.actor.user,f=a&&{displayName:a.displayName,email:a.email,self:a.self,userPrincipalName:a.userPrincipalName};return{id:t.id,type:this._getActivityType(t),actors:[f],item:n,parentItem:r,time:t.times.recordedTime?new Date(t.times.recordedTime):new Date(t.times.recordedDateTime),friendlyDisplayTime:t["@sharePoint.localizedRelativeTime"],action:s}};e.prototype._getActivityType=function(e){return g({Comment:function(){return 2},CommentResponse:function(){return 3},Create:function(){return 11},Delete:function(){return 10},Edit:function(){return 0},Mention:function(){return 4},Move:function(){return 1},Rename:function(){return 9},Restore:function(){return 6},RestoreVersion:function(){return 7},PointInTimeRestore:function(){return 8},Share:function(){return 12},Version:function(){return 5},Copy:function(){return 13},AddShortcutToOneDrive:function(){return 14},RemoveShortcutFromOneDrive:function(){return 15}})(e)};e.prototype._getItem=function(e,t){var n=b(t);if(c(t)){if(r(t)){var s=y(t).move;if(s&&s.to)return{name:this._getFileNameFromPath(s.to),isRoot:this._isRootItem(s.to),graphItemUrl:void 0,relativePath:void 0,absolutePath:s.to}}}else if(p(t)&&r(t)){var o=y(t).delete;if(o&&o.name){var u=(f=(a=n&&n.parentReference)&&this._getRelativePathFromVroomPath(a.path))&&n&&f+"/"+n.name+"/"+o.name;return{name:o.name,isRoot:this._isRootItem(o.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0,isFolder:"Folder"===o.objectType}}}if(n){t.docDetails&&(n.webUrl=this._getNavLink(n,t.docDetails));var a,f;u=(f=(a=n&&(n.parentReference||n.remoteItem&&n.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(a.path))&&f+"/"+n.name;return p(t)?{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:void 0,relativePath:u,absolutePath:void 0}:{name:n.name,isRoot:this._isRootItem(n.name),graphItemUrl:a&&"/drives/"+a.driveId+"/items/"+n.id,relativePath:u,absolutePath:void 0,driveItem:n,navigationId:this._getNavigationId(t)}}if(!i(t))return e};e.prototype._getParentItem=function(e){var t=b(e);if(c(e)){var n=y(e).move;if(n&&n.to){var i=this._getDirNameFromPath(n.to),s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference);return{name:this._getFileNameFromPath(i),isRoot:this._isRootItem(i),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+s.id,relativePath:void 0,absolutePath:this._getDirNameFromPath(i),isFolder:!0,driveItem:s&&{id:s.id}}}}else if(p(e)&&t){if(r(e)){var o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(s=t&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var u=s.name?s.name:o&&this._getFileNameFromPath(o);if(void 0===o||void 0===u||void 0===s.id)return;return{name:u,isRoot:this._isRootItem(u),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}else{if(l(e)&&t){o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!1,driveItem:t}}if(f(e)&&t){var a;o=(a=(s=t&&(t.parentReference||t.remoteItem&&t.remoteItem.parentReference))&&this._getRelativePathFromVroomPath(s.path))&&a+"/"+name;return{name:t.name,isRoot:this._isRootItem(t.name),graphItemUrl:s&&"/drives/"+s.driveId+"/items/"+t.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:t}}if(t){if(s=t.parentReference&&t.parentReference){o=this._getRelativePathFromVroomPath(s.path);var h=s.name?s.name:o&&this._getFileNameFromPath(o);return{name:h,isRoot:this._isRootItem(h),graphItemUrl:"/drives/"+s.driveId+"/items/"+s.id,relativePath:o,absolutePath:void 0,isFolder:!0,driveItem:{id:s.id}}}}}};e.prototype._getNavLink=function(e,t){var n=e.webUrl,r=n&&new w.t(n),i=t.navigationId;r&&i&&r.setQueryParameter("nav",i);return r.toString()||n};e.prototype._getNavId=function(e){return e&&e.navigationId};e.prototype._getNavigationId=function(e){var t,n,r,i,o,u,a;if(null===(t=e)||void 0===t?void 0:t.docDetails)return this._getNavId(e.docDetails);if(E&&s(e)){var f=y(e);return(null===(r=null===(n=f)||void 0===n?void 0:n.comment)||void 0===r?void 0:r.navigationId)?null===(o=null===(i=f)||void 0===i?void 0:i.comment)||void 0===o?void 0:o.navigationId:null===(a=null===(u=f)||void 0===u?void 0:u.comment)||void 0===a?void 0:a.commentId}};e.prototype._getAction=function(e,t,n,r){var f={};a(r)&&(f.version={newVersion:y(r).version.newVersion});if(c(r)){var l=y(r).move;if(i(r)){var p=void 0,g=void 0;l.from&&(p=this._getDirNameFromPath(l.from));l.to&&(g=this._getDirNameFromPath(l.to));f.move={from:{name:this._getFileNameFromPath(p),isRoot:this._isRootItem(p),graphItemUrl:void 0,absolutePath:p},to:{name:this._getFileNameFromPath(g),isRoot:this._isRootItem(g),graphItemUrl:void 0,absolutePath:g}}}else if(l.From){var b=this._getDirNameFromPath(l.From);f.move={from:{name:this._getFileNameFromPath(b),isRoot:this._isRootItem(b),graphItemUrl:void 0,absolutePath:b},to:void 0}}else if(l.to){var w=this._getDirNameFromPath(l.to);f.move={from:void 0,to:{name:this._getFileNameFromPath(w),isRoot:this._isRootItem(w),graphItemUrl:void 0,absolutePath:w}}}}if(h(r)){var E=y(r).rename;f.rename={newItem:{name:E.newName,isRoot:this._isRootItem(E.newName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0},oldItem:{name:E.oldName,isRoot:this._isRootItem(E.oldName),graphItemUrl:t?t.graphItemUrl:void 0,relativePath:t?t.relativePath:void 0,absolutePath:t?t.absolutePath:void 0,driveItem:t?t.driveItem:void 0}}}if(o(r)){(S=y(r).comment).isReply&&(f.commentResponse={commentAuthor:S.parentAuthor&&S.parentAuthor.user})}if(s(r)){var S;(S=y(r).comment).isReply||(f.comment={commentId:S.commentId})}if(u(r)){var x=y(r).mention;f.mention={mentionees:x.mentionees&&x.mentionees.map(function(e){return e.user})||[],commentId:i(r)?x.navigationId:void 0}}if(d(r)){var T=y(r).share;f.share={recipients:T.recipients&&T.recipients.map(function(e){return e.user})||[]}}v(r)&&(f.addShortcutToOneDrive={});if(m(r)){var N=y(r).addToOneDrive;f.removeShortcutFromOneDrive={mountPointName:N.mountPointName}}return f};e.prototype._getRelativePathFromVroomPath=function(e){if(e){return e.split(":",2)[1]}};e.prototype._getDirNameFromPath=function(e){return e&&e.substring(0,e.lastIndexOf("/"))};e.prototype._getFileNameFromPath=function(e){return e&&e.substring(e.lastIndexOf("/")+1)};e.prototype._isRootItem=function(e){return e&&"/LiveFolders"===e};return e})();t.e=S},2660:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},2717:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("officeApp"),s=new r.e("officeLens")},2791:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},2792:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveItemResponse")},2935:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},2936:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("thumbnailToken",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},3017:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasPdfFacet")},3018:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},3019:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})},3020:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("thumbnailAccessToken")},3021:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(6),i=new r.e("sharesItem",{endpoint:Object(r.s)(),shareId:Object(r.s)()})},3124:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("restricted")},3125:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("tags")},3345:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(619),i=function(e){var t=e.replace(".",""),n=Object.keys(r.e);for(var i in n)if(r.e.hasOwnProperty(n[i])){var s=n[i];if(r.e[s].indexOf(t)>-1)return s}}},3346:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("coverImage")},3483:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=n(260).e.isFeatureEnabled({ODC:"EnableDefaultSortOrderFromBackend"})},3484:function(e,t,n){"use strict";n.d(t,"e",function(){return d});n.d(t,"t",function(){return m});var r=n(8),i=n(62),s=n(2660),o=n(2936),u=n(3020),a=n(2791),f=n(153),l=n(4),c=n(333),h=n(580),p=n(49),d=Object(r.t)()(function(){return function(e){return v}});function v(e,t){var n=t.itemKey,r=t.desiredSize,p=t.fitMode,d=e.demandItemFacet(i.e,n);if(!d)return{};var v=e.demandItemFacet(a.e,n)?(function(e,t){var n=t.itemKey,r=t.desiredSize,i=t.fitMode,o=m(e.demandItemFacet(s.e,n));if(o&&o.large)return{url:w(o.large.url,r,i),width:0,height:0}})(e,{itemKey:n,driveItem:d,desiredSize:r,fitMode:p}):(function(e,t){var n=t.itemKey,r=t.driveItem,i=t.desiredSize;if(r.endpoint.indexOf("/_api/v2.")>-1){var s=e.demandItemFacet(l.i,n),a=e.demandItemFacet(l.p,n,{suppressGetItems:!0})||"";if(s){var p=new f.e(r.endpoint).authority+"/_api/v2.1",d=o.e.serialize({endpoint:p,driveId:r.driveId}),v=e.demandItemFacet(u.e,d);if(v){var m=Object(c.t)({endpoint:p,driveId:r.driveId,itemId:r.itemId}),g=Math.ceil(i.width),y=Math.ceil(i.height);return{url:m+"/thumbnails/0/c"+g+"x"+y+"/content?"+Object(h.e)({prefer:"noredirect,closestavailablesize",cb:a,access_token:{uriValue:v}}),width:0,height:0}}}}})(e,{itemKey:n,driveItem:d,desiredSize:r});return v?{thumbnail:v}:{}}function m(e){return e&&((t=e)&&"number"==typeof t.length)?e[0]:e;var t}var g=/width=[0-9]*/,y=/height=[0-9]*/,b=/cropmode=[a-z]*/;function w(e,t,n){if(!p.e.isActivated("AB808229-F141-4F5A-B7E9-C1DEF8EC6F64","10/21/2021","Enable crop mode for folder cover thumbnail")){var r="cover"===n?"center":"none";b.test(e)?e=e.replace(b,"cropmode="+r):e+=(e.indexOf("?")>-1?"&":"?")+"cropmode="+r}var i="number"==typeof t.width?Math.ceil(t.width):t.width,s="number"==typeof t.height?Math.ceil(t.height):t.height,o=""+(i||"");g.test(e)?e=e.replace(g,"width="+o):e+=(e.indexOf("?")>-1?"&":"?")+"width="+o;var u=""+(s||"");y.test(e)?e=e.replace(y,"height="+u):e+=(e.indexOf("?")>-1?"&":"?")+"height="+u;return e}},3485:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},3633:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(9),i=n(282),s=n(435),o=n(3021),u=n(0),a=n(487),f=n(333),l=n(62),c=n(2533),h=n(7),p=n(1176),d=n(261),v=n(221),m=n(134),g=n(45),y=Object(r.i)({maxParallelOperationCount:8})(function e(t){var n=this,r=t.itemKey,i=o.e.deserialize(r),s=i.endpoint;return function(t){return Object(u.__awaiter)(n,void 0,void 0,function(){var n,o,y,b,w,E,S,x,T,N,C,k,L,A,O,M;return Object(u.__generator)(this,function(_){switch(_.label){case 0:n=t(Object(m.e)({graphEndpoint:g.m,graphRecentEndpoint:g.b})),o=n.graphEndpoint,y=n.graphRecentEndpoint;return[4,t(Object(a.n)({url:Object(f.r)(i)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:s,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:b=_.sent();w=new d.e({publisher:e});E=b&&b.parentReference;S=E&&E.driveId;x={endpoint:s,driveId:S,itemId:b.id};T=l.e.serialize(x);N=E&&E.id?l.e.serialize({endpoint:s,driveId:S,itemId:E.id}):void 0;w.merge(t(Object(c.e)({itemKey:T,driveItem:b,endpoint:s,parentFolderItemKey:N})).itemResolver);C=t(Object(m.e)({processDriveItemFromSharePoint:g.N})).processDriveItemFromSharePoint;k=s.indexOf("/_api/v2.0")>-1||s.indexOf("/_api/v2.1")>-1;L=o||y;if(C&&(k||L)){A=t(C.process({itemKey:T,driveItem:b})).itemResolver;w.merge(A)}w.resolveItems({items:(O={},O[T]=Object(u.__assign)(Object(u.__assign)({},v.n.pack(l.e)),h.t.pack({itemKey:p.e.serialize({driveItemKey:x,sortBy:"",isAscending:!0})})),O)});w.mapKeys({mappings:(M={},M[T]=r,M)});t(w.execute());return[2]}})})}});var b=Object(r.t)(function(){return function(e){e(Object(i.r)(o.e,s.e)(y))}})},3829:function(e,t,n){"use strict";n.d(t,"e",function(){return h});n.d(t,"t",function(){return p});var r,i=n(0),s=n(74);(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));var o=n(1148),u=n(41),a=n(447),f=n(1143),l=n(2414);var c="/_layouts/15/userphoto.aspx?size=S&accountname=",h=(function(){function e(e,t){this._eTagMap={};this._dataRequestor=t.vroomDataRequestor;var n=t.getProfileImageUrl,r=void 0===n?function(e){return Object(o.getUserPhotoUrl)(e)}:n,i=t.caller,s=void 0===i?"hovercard":i,u=t.useSharePointApi,a=void 0!==u&&u;this._getProfileImageUrl=r;this._caller=s;this._useSharePointApi=a}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,r=void 0===n?"v2.1":n,i=t.skipToken,o=void 0===i?"":i,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=o?";$skiptoken="+o:"",l="GetItemAnalytics"+r+(e.queryType?"_"+e.queryType:"")+"_WithGuestUser",c=this._getBaseUrl(e);if(!c)return s.n.resolve();var h=c+"/analytics/allTime?$expand=activities"+"($filter=access%20ne%20null)"+f;return this._getAnalytics(l,h,!1,e,a)};e.prototype.getAnalyticsSections=function(e,t){void 0===t&&(t={});if(this._useSharePointApi)return s.n.reject(void 0);var n=t.headers,r=void 0===n?{Caller:this._caller}:n,i=this._getBaseUrl(e);if(!i)return s.n.resolve();",id,reactions";"$expand=insights($expand=keyPoints)";",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";var o="$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention",u=o+"&$expand=insights($expand=keyPoints)",a=this._useSharePointApi?i+"/driveItem?"+u:i+"?"+u;return this._getAnalytics("GetAnalyticsSections_WithReaction_WithKeyPoints_WithLifeCycle",a,!0,e,r)};e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",r=this._getBaseUrl(e);if(!r)return s.n.resolve();var i=t.apiVersion,o=void 0===i?"v2.1":i,u=t.headers,a=void 0===u?{Caller:this._caller}:u,f=e.queryType?"_"+e.queryType:"";if(this._useSharePointApi){var l="GetItemAnalyticsSharePoint"+o+f,c=r+"/driveItem?"+n;return this._getAnalytics(l,c,!0,e,a)}var h="GetItemAnalyticsSections"+o+f+"_WithGuestUser_WithReaction_WithKeyPoints_WithLifeCycle",p=r+"?$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention&$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null))),insights($expand=keyPoints)";return this._getAnalytics(h,p,!0,e,a)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return s.n.resolve();var r=t+"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)";return this._getAnalytics("GetLastSevenDaysItemAnalytics",r,!1,e,n)};e.prototype.getItemAnalyticsByInterval=function(e,t,n,r){var i=t.toISOString(),s=n.toISOString(),o=this._getBaseUrl(e)||"",u=this._getAnalyticsByIntervalPath(o,"v2.1",i,s,r);return this._getAnalyticsByInterval("GetDailyItemAnalytics",u,e.getAccessToken&&e.getAccessToken(),"v2.1")};e.prototype._getAnalytics=function(e,t,n,r,s,o){var u=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:r.getAccessToken&&r.getAccessToken(),headers:s,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;e.eTag&&(u._eTagMap[r.itemId]=e.eTag);return n?p(e,u._getProfileImageUrl):(function(e,t){var n=e.activities,r=e.access,s=e.endDateTime,o=Object(i.__rest)(e,["activities","access","endDateTime"]);return{activities:v(n,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:r&&r.actionCount,viewerCount:r&&r.actorCount,lastActivityDateTime:s}})(e,u._getProfileImageUrl)})};e.prototype.updateItemKeyPoints=function(e,t){var n=this,r=this._getBaseUrl(e)+"/insights/keyPoints";return this._dataRequestor.send({path:r,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,qosExtraData:{Caller:this._caller},parseResponse:function(t){n._eTagMap[e.itemId]=t.getResponseHeader("eTag")||"";return JSON.parse(t.responseText)}}).then(function(e){return e.value})};e.prototype._getAnalyticsByInterval=function(e,t,n,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(m)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?""+e.graphItemUrl:null};e.prototype._getAnalyticsByIntervalPath=function(e,t,n,r,i){var s;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";s=this._useSharePointApi?"interval='"+i+"',startDateTime='"+n+"',endDateTime='"+r+"'":"v2.1"===t?"startDateTime="+n+"&endDateTime="+r+"&interval="+i:"startDateTime='"+n+"'&endDateTime='"+r+"'&interval='"+i+"'";return this._useSharePointApi?e+"/oneDrive.getActivitiesByInterval("+s+")":e+"/"+o+"?"+s};e.prototype.getFilesAnalytics=function(e,t,n){var r=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:t+"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '"+e.join("' or sharepointIds/listItemUniqueId eq '")+"'",postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return r._parseFilesAnalyticsResponse(e)}):s.n.resolve()};e.prototype.getRecommendedActions=function(e){var t=this._getBaseUrl(e)+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))";return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getShareWith=function(e){var t=this._getBaseUrl(e)+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'";return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var n=t?Object(a.t)(t,function(e){switch(e){case"notSupported":return{resultType:u.e.ExpectedFailure}}}):{};return Object(i.__assign)(Object(i.__assign)({},e),n)};e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,n=(e.value,Object(i.__rest)(e,["value"])),r=e.value.map(function(e){var n=e.analytics,r=Object(i.__rest)(e,["analytics"]);return Object(i.__assign)(Object(i.__assign)({},r),{analytics:{lastSevenDays:d(n.lastSevenDays,t._getProfileImageUrl)}})});return Object(i.__assign)(Object(i.__assign)({},n),{value:r})};return e})();function p(e,t){var n=e&&e.analytics&&e.analytics.allTime,i=n&&n.access,s=n&&n.endDateTime,o=v(n&&n.activities,t),u=(function(e){var t=[];e.malware&&t.push({status:r.MalwareDetected});e.publication&&e.publication.level.indexOf("checkout")>-1&&t.push({status:r.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user});e.dataLossPrevention&&(e.dataLossPrevention.block?t.push({status:r.DLPBlocked}):e.dataLossPrevention.notify&&t.push({status:r.DLPWarning}));e.metadataMissing&&t.push({status:r.MissingMetaData});e.awaitingApproval&&t.push({status:r.AwaitingApproval});e.trending&&t.push({status:r.Trending});if(e.createdDateTime){var n=new Date(e.createdDateTime);(i=n,s=(new Date).getTime(),o=i&&i.valueOf(),!isNaN(o)&&s-o<1728e5)&&t.push({status:r.New,createdRelativeTime:Object(f.t)(Object(l.t)(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})}var i,s,o;return t})(e),a=(function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}})(e),c=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,commentCount:c&&c.commentCount,likeCount:c&&c.likeCount,lifeCycleStatus:u,keyPointsData:a,lastActivityDateTime:s,createdBy:e.createdBy&&e.createdBy.user,createdDateTime:e.createdDateTime}}function d(e,t){e.activities;var n=Object(i.__rest)(e,["activities"]),r=e.activities&&e.activities.map(function(e){var n=Object(i.__rest)(e,[]),r=n.actor&&n.actor.user&&n.actor.user.email;n.activityDateTime=Object(f.t)(Object(l.t)(n.activityDateTime));n.actor.user.image=t&&t(n.actor.user.email)||""+c+r;return n});return Object(i.__assign)(Object(i.__assign)({},n),{activities:r})}function v(e,t){return e&&e.map(function(e){var n=Object(i.__rest)(e,[]),r=n.actor&&n.actor.user&&n.actor.user.email,s=Object(i.__assign)(Object(i.__assign)({},n.actor.user),{image:t?t(r):""+c+r,userType:n.actor.user.userType});return Object(i.__assign)(Object(i.__assign)({},n),{activityDateTime:Object(f.t)(Object(l.t)(n.activityDateTime)),actor:Object(i.__assign)(Object(i.__assign)({},n.actor),{location:n.location,user:s}),activityType:n.access?"Access":"Edit"})})}function m(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}},4353:function(e,t,n){"use strict";n.r(t);n.d(t,"graphAddon",function(){return _a});var r=n(0),i=n(9),s=n(1402),o=n(1470),u=n(282),a=n(202),f=n(7),l=n(267),c=n(4),h=n(261),p=n(635),d=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=a.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new h.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:l.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),c.h.pack(p.s)),c.m.pack({})),c.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var v=n(333),m=n(487),g=n(134),y=n(157),b=n(6),w=new b.e("driveItemPage",{endpoint:Object(b.s)(),setItemKey:Object(b.s)(),token:Object(b.s)()}),E=n(244),S=n(254),x=n(45),T=n(188),N=n(41),C=n(153),k=n(2533),L=n(62),A=n(501),O=n(1186),M=new b.e("userById",{id:Object(b.s)(),endpoint:Object(b.s)()}),_=n(176),D=n(2),P=new D.e("sharedBy"),H=n(3019);function B(e){var t=e.itemKey,n=e.driveItemKey,i=e.parentFolderItemKey,s=e.setItemKey,o=e.driveItemResponse,u=e.endpoint,a=e.getDriveItemFacets,l=void 0===a?k.e:a,p=e.shouldInvalidateItemSetOnChildItemRename,d=void 0===p?void 0:p;return function(e){var a,p=new h.e({publisher:B}),v=A.e.serialize({driveItemKey:n}),m=void 0;if(s){var g=Object(y.e)().forFacet(c.l).thenInvalidate(s,f.e).forFacet(c.M).thenInvalidate(s,f.e);d&&!d(u)||(g=g.forFacet(c.h).thenInvalidate(s,f.e));m=g.pack()}p.merge(e(l({itemKey:t,driveItemKey:n,driveItem:o,endpoint:u,parentFolderItemKey:i})).itemResolver);p.resolveItems({items:(a={},a[t]=Object(r.__assign)(Object(r.__assign)({},c.e.pack({itemKey:v})),m),a)});if(o.lastModifiedBy){if(S=o.lastModifiedBy.user){var b=S.id&&M.serialize({id:S.id,endpoint:u});if(b=S.email&&H.e.serialize({email:S.email,endpoint:u})){var w=j({itemKey:t,personFacet:c.A,userKey:b,user:S}).itemResolver;p.merge(w)}}}if(o.createdBy){var E=void 0;if((S=o.createdBy.user)&&S.email&&(E=H.e.serialize({email:S.email,endpoint:u}))){w=j({itemKey:t,personFacet:O.r,userKey:E,user:S}).itemResolver;p.merge(w)}}if(o.remoteItem&&o.remoteItem.shared&&o.remoteItem.shared.sharedBy&&o.remoteItem.shared.sharedBy.user){var S,x=void 0;if((S=o.remoteItem.shared.sharedBy.user).email&&(x=H.e.serialize({email:S.email,endpoint:u}))){w=j({itemKey:t,personFacet:P,userKey:x,user:S}).itemResolver;p.merge(w)}}return{itemResolver:p}}}function j(e){var t,n,i=e.itemKey,s=e.personFacet,o=e.userKey,u=e.user,a=new h.e({publisher:j});a.resolveItems({items:Object(r.__assign)((t={},t[o]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(u.displayName)),_.e.pack(u.email)),_.i.pack(u.id)),t),s&&(n={},n[i]=Object(r.__assign)({},s.pack({itemKey:o,displayValue:u.displayName})),n))});return{itemResolver:a}}var F=n(2594),I=new b.e("driveItem",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(b.s)()});function q(e){var t=e.driveItemResponse,n=e.endpoint,i=e.getDriveItemFacets,s=void 0===i?k.e:i;return function(i){var o,u,a,f=t.remoteItem,l=f&&f.parentReference,h=t.parentReference,p=h||l,d=p&&p.driveId,v=p&&p.id,m="personal"===(p&&p.driveType),g=!!t.root;if(f){a=f.id;l&&(d=l.driveId)}else a=m&&t.root?F.n:t.id;var y={endpoint:n,driveId:d,itemId:a},b=L.e.serialize(y),w=t&&(t.webDavUrl||t.webUrl),E=m&&p&&p.path===F.e?F.n:v||void 0,S=p&&E?L.e.serialize({endpoint:n,driveId:p.driveId||d,itemId:E}):void 0,x=[],T="";if(w){var N=new C.e(w);x.push.apply(x,N.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));x.unshift(N.authority);T=x.join("/")}p&&!g&&!E&&T&&(S=I.serialize({endpoint:n,driveId:p.driveId,canonicalUrl:T}));var k=i(B(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:b,driveItemKey:y,parentFolderItemKey:S}))).itemResolver;k.resolveItems({items:Object(r.__assign)({},S&&(o={},o[S]=Object(r.__assign)({},T?c.O.pack(T):{}),o))});if(f&&l){var A=L.e.serialize({endpoint:n,driveId:h&&h.driveId,itemId:t.id}),O=L.e.serialize({endpoint:n,driveId:l.driveId,itemId:f.id});k.mapKeys({mappings:(u={},u[A]=O,u)});k.merge(i(s({itemKey:O,driveItem:t,endpoint:n})).itemResolver)}return{itemResolver:k,actualDriveItemKey:y,actualItemKey:b}}}var R=n(154),U=n(39),z=new D.e("itemSetEngagementExtraData"),W=n(107),X=n(1176),V=n(2660),$=n(2792),J=new D.e("mountPoint"),K=n(335),Q=n(641),G=n(1188),Y=n(140),Z=n(863),ee=n(1227),te=n(853),ne=n(2717),re=n(3345),ie=n(2935),se=n(3018),oe=n(2791),ue=n(2436),ae=n(3346),fe=n(3017),le=n(648),ce=n(3125),he=n(334),pe=n(3124);function de(e){var t=e.itemKey,n=e.driveItemKey,i=e.driveItem,s=e.endpoint,o=e.parentFolderItemKey,u=e.shouldReturnShareFacets,a=void 0===u||u,l=i.bundle,d=i.coverImage,v=i.file,m=i.fileSystemInfo,g=i.name,b=i.parentReference,w=i.lenses,E=i.remoteItem,S=i.root,x=i.size,T=i.thumbnails,N=i.image,C=i.video,k=i.eTag,A=i.photo,O=i.restricted,M=i.tags,_=i.specialFolder;return function(e){var u,D,P,H,B,j,F,I,q,R,z,ve,me,ge=i.lastModifiedDateTime,ye=void 0===ge?m&&m.lastModifiedDateTime:ge,be=i.createdDateTime||m&&m.createdDateTime,we=(new Date).getTime(),Ee=be?new Date(be).getTime():void 0,Se=Ee?we-Ee<1728e5:void 0,xe=b&&b.driveId,Te=b&&b.driveType,Ne="personal"===Te,Ce=m&&m.lastAccessedDateTime,ke=null===(H=A)||void 0===H?void 0:H.takenDateTime,Le=i.package,Ae=T,Oe=N,Me=C,_e=i.shared||(null===(B=i.remoteItem)||void 0===B?void 0:B.shared),De={itemId:i.id,driveId:xe,endpoint:s},Pe=m&&m.systemPath,He=void 0;if(E){He={itemId:E.id,driveId:E.parentReference&&E.parentReference.driveId||"",endpoint:s};me=L.e.serialize({itemId:E.id,driveId:(F=null===(j=E.parentReference)||void 0===j?void 0:j.driveId,null!=F?F:xe),endpoint:s})}var Be,je=n||De,Fe=L.e.serialize(je),Ie=i.webDavUrl;Be="business"!==Te&&"documentLibrary"!==Te&&"personal"!==Te||!S?g||"":p.t;var qe,Re=i.folder||(null===(I=E)||void 0===I?void 0:I.folder);Re&&(qe=_e?E?12:5:2);var Ue=(null===(R=null===(q=Re)||void 0===q?void 0:q.folderView)||void 0===R?void 0:R.sortBy)||"",ze="descending"===(null===(ve=null===(z=Re)||void 0===z?void 0:z.folderView)||void 0===ve?void 0:ve.sortOrder),We=Ue&&{columnKey:Object(he.i)(Ue),isAscending:!ze},Xe=x,Ve=Re&&Re.childCount,$e=(function(e,t){var n=e.lastIndexOf(".");if(t||n<0)return{name:e,extension:""};return{name:e.substring(0,n),extension:e.substring(n)}})(Be,!!Re),Je=$e.extension||i.package&&i.package.type,Ke=Je&&Object(re.e)(Je),Qe=i.sharepointIds,Ge=i.localItem,Ye=i.webUrl,Ze=new h.e({publisher:de});Ze.resolveItems({items:(u={},u[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},L.e.pack(je)),c.h.pack(Be)),te.r.pack(Pe)),c.f.pack(ye?new Date(ye).getTime():void 0)),c.u.pack(Ee)),Y.u.pack(ke?new Date(ke).getTime():void 0)),c.S.pack(Se)),W.i.pack(Le&&"oneNote"===Le.type?{}:void 0)),Object(y.e)().forFacet(Y.v).thenInvalidate(Fe,V.e).pack()),$.e.pack(i)),f.t.pack({itemKey:X.e.serialize({driveItemKey:je,sortBy:Ue,isAscending:!ze})})),c.n.pack({itemKey:Q.e.serialize({driveItemKey:je})})),c.M.pack(o?{itemKey:o}:void 0)),Z.e.pack(Te)),c.d.pack($e)),ue.e.pack(l)),ae.e.pack(d)),te.n.pack(v&&v.mimeType)),J.pack(He)),ne.t.pack(w&&w.length>0?w:void 0)),ce.e.pack(M)),m||Re||v?Object(r.__assign)({},c.m.pack(Re?{}:void 0)):{}),Ce?Object(r.__assign)({},c.o.pack(new Date(Ce).getTime())):{}),Ae?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},V.e.pack(Ae)),oe.e.pack(!0)),fe.e.pack(Object(le.i)($e.extension))):{}),k?c.p.pack(k):{}),Oe&&Oe.width&&Oe.height?Y.a.pack({width:Oe.width,height:Oe.height}):{}),Oe&&!Me?Y.p.pack({}):{}),Me?Y.g.pack({}):{}),Ne?Object(r.__assign)({},ee.e.pack(i.vault)):{}),a?Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.x.pack(!!_e)),G.e.pack(_e)),qe?W.e.pack(qe):{}):{}),u)});Ze.resolveItems({items:(D={},D[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},void 0!==Xe?c.v.pack(Xe):{}),Ye?c.O.pack(Ye):{}),We?f.u.pack(We):{}),Ie?c.i.pack(decodeURIComponent(Ie)):{}),Ge?te.t.pack(Ge):{}),"number"==typeof Ve?U.e.pack(Ve):{}),Ke?ne.e.pack(Ke):{}),O?pe.e.pack(O):{}),Qe?ie.e.pack(Qe):{}),_?se.e.pack(_.name):{}),D)});Ze.resolveItems({items:(P={},P[t]=Object(r.__assign)({},me?K.e.pack({itemKey:me}):{}),P)});return{itemResolver:Ze}}}function ve(e){var t=e.driveItemResponse,n=e.endpoint;return function(i){var s=t.parentReference,o=s&&s.driveId,u=s&&s.id,a=t.id;t.root&&(a=F.n);var f={endpoint:n,driveId:o,itemId:a},l=L.e.serialize(f),c=s&&s.path===F.e?F.n:u||void 0,h=s&&c?L.e.serialize({endpoint:n,driveId:s.driveId,itemId:c}):void 0;return{itemResolver:i(B(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:l,driveItemKey:f,getDriveItemFacets:de,parentFolderItemKey:h}))).itemResolver,actualDriveItemKey:f,actualItemKey:l}}}function me(e){return function(t){var n,i,s,o,u,a=e.itemKey,l=e.parentItemKey,c=e.itemSetKeyFacet,p=e.filterChildItems,d=e.onProcessResponse,v=e.groupChildItems,m=e.response,b=e.skip,k=void 0===b?0:b,L=e.enableRandomAccess,A=void 0!==L&&L,O=e.disableRemoteItem,M=e.totalChildCount,_=e.getDriveItemFacets,D=c.deserialize(a),P=D.driveItemKey.endpoint,H=new h.e({publisher:me}),B=t(Object(T.e)({name:"remoteItemsMissingParentRef"})),j="number"==typeof m["@odata.count"]?m["@odata.count"]:M||m.value.length,F=m["@odata.nextLink"],I=!!F,W=t(Object(R.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(f.e,a),prevChildKeys:e.demandItemFacet(f.e,a)}})),X=W.childItemsFacetResolved,V=W.prevChildKeys,$=V&&V.itemKeys,J=0,K=0;A&&(X&&$?u=$.slice(0):"number"==typeof j&&(u=new Array(j+(I&&j<=m.value.length?1:0))));u||(u=new Array(m.value.length+(I?1:0)));for(var Q=k,G=0,Y=0,Z=m.value;Y<Z.length;Y++){var ee=Z[Y],te=p&&p(ee),ne=ee.remoteItem,re=!(ee.remoteItem&&ee.remoteItem.parentReference&&ee.remoteItem.parentReference.driveId),ie=ne&&re;ie&&G++;if(te||ie){u.splice(Q,1);j--}else{var se=t(Object(g.e)({graphEndpoint:x.m,graphRecentEndpoint:x.b,processDriveItemSet:x.C,allowDisableRemoteItemInPlace:x.i})),oe=se.graphEndpoint,ue=se.graphRecentEndpoint,ae=se.processDriveItemSet,fe=se.allowDisableRemoteItemInPlace&&O,le=fe?ve:q,ce=ee.webDavUrl||!fe&&ee.remoteItem&&ee.remoteItem.webDavUrl||ee.webUrl,he=P.indexOf("/_api/v2.0")>-1||P.indexOf("/_api/v2.1")>-1,pe=oe||ue;if(ce&&he){var de=ce&&decodeURIComponent(ce);P=pe?new C.e(de).authority+"/_api/v2.0":""+new C.e(de).authority+new C.e(P).path}var ge=t(le({shouldInvalidateItemSetOnChildItemRename:ae&&ae.shouldInvalidateItemSetOnChildItemRename,setItemKey:a,driveItemResponse:ee,endpoint:P,getDriveItemFacets:_})),ye=ge.itemResolver,be=ge.actualItemKey,we=ge.actualDriveItemKey,Ee=ee.thumbnails,Se=ee.remoteItem;J++;(Ee||!fe&&Se&&Se.thumbnails)&&K++;u[Q]=be;H.merge(ye);if(d){var xe=d({itemKey:a,driveItemKey:we,item:ee});xe&&H.merge(xe.itemResolver)}var Te=t(Object(g.e)({processDriveItemFromSharePoint:x.N})).processDriveItemFromSharePoint;if(Te&&(he||pe)){var Ne=t(Te.process({itemKey:be,driveItem:ee})).itemResolver;H.merge(Ne)}Q++}}t(B(Object(r.__assign)({resultType:G<1?N.e.Success:N.e.Failure},G>0?{extraData:{count:G}}:{})));if(I){var Ce=w.serialize({setItemKey:a,endpoint:P,token:F});H.merge(Object(E.t)({itemKey:Ce}).itemResolver);u[Q]=Ce}if(v){var ke=v(D);ke&&H.merge(ke.itemResolver)}else H.resolveItems({items:(n={},n[a]=Object(r.__assign)({},f.e.pack({itemKeys:u})),n)});H.resolveItems({items:(i={},i[a]=Object(r.__assign)({},z.pack({childCount:J,childCount_withThumbnail:K})),i)});j!==M&&H.resolveItems({items:(s={},s[l]=Object(r.__assign)({},U.e.pack(j)),s)});H.resolveItems({items:(o={},o[a]=Object(r.__assign)(Object(r.__assign)({},f.s.pack({itemKey:l})),Object(y.e)().forFacet(f.e).thenInvalidate(S.e).pack()),o)});return{itemResolver:H}}}var ge=n(1072),ye=n(133);function be(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.disableRemoteItem,u=e.parentItemResponse,a=e.mapItemSetKey,l=n.deserialize(t),c=i.serialize(l.driveItemKey),h=l.driveItemKey.endpoint;return function(n){var i,l;ye.t(ge.e.processData.start);var p=n(me(Object(r.__assign)(Object(r.__assign)({},e),{response:s,disableRemoteItem:o,parentItemKey:c}))).itemResolver;if(a){var d=a().itemResolver;p.merge(d)}var v=n(Object(g.e)({allowDisableRemoteItemInPlace:x.i})).allowDisableRemoteItemInPlace;if(u){var m=n((v&&o?ve:q)({setItemKey:t,driveItemResponse:u,endpoint:h})),b=m.itemResolver,w=m.actualItemKey;p.mapKeys({mappings:(i={},i[w]=c,i)});p.merge(b)}p.resolveItems({items:(l={},l[c]=Object(r.__assign)({},Object(y.e)().forFacet(f.t).thenInvalidate(e.itemKey,f.e).pack()),l)});ye.t(ge.e.processData.end);return{itemResolver:p}}}var we=n(455),Ee=n(49),Se=Ee.t.isActivated("cade488d-480a-444f-a1ea-d3d121529bb7","11/01/2021","Set one minute timeout for API requests");function xe(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=e.disableRemoteItem,c=void 0!==l&&l,h=i.deserialize(n),p=h.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,d,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=Object(v.n)(h.driveItemKey);b.label=1;case 1:b.trys.push([1,4,,5]);return[4,n(Object(m.r)({url:s(h),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:f,timeout:Se?void 0:6e4}))];case 2:i=b.sent();l=Object(r.__spreadArrays)(i.value);d=a&&a(l)||i.value;g=o&&o(d)||d;return[4,n(be(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItem:c,childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:g})})))];case 3:return[2,{itemResolver:b.sent().itemResolver}];case 4:y=b.sent();throw new we.e(Object(r.__assign)({code:"UnknownError"},y instanceof Error?{innerError:y}:{message:JSON.stringify(y)}));case 5:return[2]}})})}}var Te=n(108),Ne=n(559),Ce=n(836),ke=n(246);function Le(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var Ae=n(2076),Oe="fileName",Me="sharedByName",_e="dateModified";var De=new Map([["code",Te.e.text],["csv",Te.e.excel],["docx",Te.e.word],["dotx",Te.e.word],["one",Te.e.onenote],["onepkg",Te.e.onenote],["onetoc",Te.e.onenote],["pdf",Te.e.pdf],["photo",Te.e.media],["potx",Te.e.powerpoint],["ppsx",Te.e.powerpoint],["pptx",Te.e.powerpoint],["rtf",Te.e.text],["txt",Te.e.text],["video",Te.e.media],["xlsx",Te.e.excel],["xltx",Te.e.excel],["zip",Te.e.zip]]);function Pe(e,t){var n,r,i=(n=e,r=Object(Ne.t)(n,!0),Object(Ce.t)(r)),s=De.get(i);return!!s&&Object(Te.t)(t.filters,s)}function He(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===Me)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===Oe)||(function(e,t){return!!e.name&&Pe(e.name,t)})(e,Object(ke.t)(t.values)),s=!(t.type===_e)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case Ae.e.today:return n;case Ae.e.yesterday:return Le(n,1);case Ae.e.last7Days:return Le(n,7);case Ae.e.last30Days:return Le(n,30);case Ae.e.last3Months:return Le(n,90);default:return new Date(0)}})((n=t.values).length<1||-1===Object.keys(Ae.e).indexOf(n[0])?Ae.e.none:Ae.e[n[0]]));return r&&i&&s})}var Be=n(217);function je(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Fe(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Ie(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function qe(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Re(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var Ue=new b.e("SharedByPersonKeyFacet",{displayName:Object(b.s)(),email:Object(b.s)()}),ze=new b.e("dateSharedGroupKeyFacet",{relativeTime:Object(b.s)(),sharedDateTime:Object(b.s)()}),We=new b.e("relativeTimeGroupKeyFacet",{relativeTime:Object(b.s)()}),Xe=n(3883),Ve=n(624),$e=n(18),Je=n(51),Ke=n(3881),Qe=(Ke.P,Ke.l,Ke.B,Ke.j,Ke.H,Ke.i,Ke.p,Ke.O,Ke.N,Ke._,Ke.D,Ke.M,Ke.b,Ke.L,Ke.w,Ke.y,Ke.x,Ke.v,Ke.T,Ke.S,Ke.E,Ke.m,Ke.A,Ke.k,Ke.C,Ke.g,[Ke.s,Ke.r,Ke.a,Ke.e,Ke.f,Ke.u,Ke.o,Ke.t,Ke.d,Ke.h,Ke.c,Ke.n]);function Ge(e){if(l.e.matches(e)){var t=l.e.deserialize(e).groupBy;if(t===he.t[he.r])return(function(e){var t={},n=function(i){for(var s,o,u=new h.e({publisher:n}),a=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!Ue.matches(i))return e;var s=Ue.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return Ue.serialize(e)})})(Object.keys(t)),l=[],p=0,d=a;p<d.length;p++){var v=d[p];if(Ue.matches(v)){var m=Ue.deserialize(v);u.resolveItems({items:(s={},s[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(m.displayName)),U.s.pack(!0)),f.e.pack({itemKeys:t[v]})),s)});l.push(v)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},f.e.pack({itemKeys:l})),Je.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=L.e.serialize(r);if(u&&u.email){var f=Ue.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:n}})(e);if(t===he.t[he.e])return(function(e){var t={},n=function(i){for(var s,o,u=new h.e({publisher:n}),a=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!ze.matches(i))return e;var s=ze.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return ze.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(ze.matches(o)){var u=ze.deserialize(o).relativeTime,a=We.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),l=[],p=0,d=Object.keys(a);p<d.length;p++){var v=d[p];if(We.matches(v)){var m=We.deserialize(v).relativeTime;u.resolveItems({items:(s={},s[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(m)),U.s.pack(!0)),f.e.pack({itemKeys:a[v]})),s)});l.push(v)}}u.resolveItems({items:(o={},o[e]=Object(r.__assign)(Object(r.__assign)({},f.e.pack({itemKeys:l})),Je.e.pack(!0)),o)});return{itemResolver:u}};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=L.e.serialize(r);if(o){var a=(function(e,t){if(!e)return Xe.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Ve.today;n.setDate(n.getDate()-1);if(e>=n)return Ve.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return Xe.i;n.setDate(n.getDate()-7);if(e>n)return Xe.t;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return Xe.e;n.setDate(n.getDate()-7);if(e>n)return Xe.o;n.setDate(n.getDate()-7);if(e>n)return Xe.s;if(e>=r)return Xe.r;var s=t.getFullYear()===e.getFullYear(),o=Qe[e.getMonth()];if(s)return o;return $e.format(Ve.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=ze.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:n}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var Ye=Object(i.i)()(function(e){var t=this,n=l.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,o=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,f,c,h,p,d,v;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=Ge(e.itemKey),u=t.onProcessResponse,f=t.groupChildItems;c=l.e.deserialize(e.itemKey);h=c.driveItemKey.endpoint;p=n(Object(g.e)({graphSharedWithMeEndpoint:x.w})).graphSharedWithMeEndpoint;h=p||h;d=n(Object(m.i)(h));return[4,n(xe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:l.e,parentItemKeyFacet:a.e,getUrl:function(e){return d?h+"/drive/oneDrive.sharedWithMe":h+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!He(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=he.t[he.e],s=he.t[he.r],o=he.t[Be.t],u=he.t[he.n],a=he.t[Be.s];switch(t){case i:return Re(e,n,r,Fe);case s:return Re(e,n,r,qe);case o:case a:return Re(e,n,r,Ie);case u:return Re(e,n,r,je);default:return e}})(e,s,o,!0)},onProcessResponse:u,groupChildItems:f})))];case 1:v=y.sent().itemResolver;n(v.execute());return[2]}})})}});var Ze=n(146),et=n(435),tt=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:a.e,facets:[a.e,c.h,c.v,c.m,c.O,c.i,c.f,f.t,c.M,te.r]}));e(Object(Ze.t)({keyFacet:l.e,facets:[l.e,f.e]}));e(Object(u.r)(a.e,et.e)(d));e(Object(u.r)(l.e,et.e)(Ye))}}),nt=new b.e("sharedByMeRootItem",{endpoint:Object(b.s)()}),rt=new b.e("sharedByMeItemSet",{driveItemKey:Object(b.o)(L.e)}),it=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=nt.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new h.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:rt.serialize({driveItemKey:s})})),c.h.pack(p.i)),c.m.pack({})),c.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var st=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(xe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:rt,parentItemKeyFacet:nt,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var ot=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:nt,facets:[nt,c.h,c.v,c.m,c.O,c.i,c.f,f.t,c.M,te.r]}));e(Object(Ze.t)({keyFacet:rt,facets:[rt,f.e]}));e(Object(u.r)(nt,et.e)(it));e(Object(u.r)(rt,et.e)(st))}}),ut=n(876),at=n(306),ft=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=at.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(u){(n=new h.e({publisher:e})).resolveItems({items:(o={},o[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:ut.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0})})),c.h.pack(p.r)),c.m.pack({})),c.M.pack(void 0)),o)});t(n.execute());return[2]})})}});var lt=n(643);function ct(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.endpoint;i=n(Object(g.e)({getUserOneDriveEndpoint:x.v,graphEndpoint:x.m})),s=i.getUserOneDriveEndpoint;return(o=i.graphEndpoint)&&t!==o&&s?[4,n(s({endpoint:t}))]:[3,2];case 1:u=r.sent();t=u;r.label=2;case 2:return[2,t]}})})}}function ht(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var pt=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,l;return Object(r.__generator)(this,function(p){switch(p.label){case 0:n=i(Object(g.e)({saveForLaterGraphEndpoint:x.A})).saveForLaterGraphEndpoint;s=ut.e.deserialize(t.itemKey);if(!n||n===s.driveItemKey.endpoint)return[3,1];s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:n})});return[3,3];case 1:return[4,i(ct({endpoint:s.driveItemKey.endpoint}))];case 2:(o=p.sent())!==s.driveItemKey.endpoint&&(s=Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},s.driveItemKey),{endpoint:o})}));p.label=3;case 3:u=ut.e.serialize(s);a=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,i(xe(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:u,qosName:"savedForLater",itemSetKeyFacet:ut.e,parentItemKeyFacet:at.e,getUrl:function(e){if(e.driveItemKey.endpoint===n){return e.driveItemKey.endpoint+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return e.driveItemKey.endpoint+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(t){var n,i,s=t.itemKey,o=t.driveItemKey,u=t.item,a=new h.e({publisher:e});if(o&&u){var l=L.e.serialize(o),p=lt.e.serialize({driveItemKey:o}),d=u&&(u.webDavUrl||u.webUrl);a.resolveItems({items:(n={},n[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.g.pack({itemKey:p})),c.i.pack(d)),c.v.pack(u.size)),n[p]=Object(r.__assign)(Object(r.__assign)({},c.E.pack(!0)),Object(y.e)().forFacet(c.E).thenInvalidate(s,f.e).pack()),n)});a.invalidateItems({items:(i={},i[s]=[f.e],i)})}return{itemResolver:a}},filterChildItems:ht,getDriveItemFacets:dt,mapItemSetKey:function(){var n,r=new h.e({publisher:e});r.mapKeys({mappings:(n={},n[u]=t.itemKey,n)});return{itemResolver:r}},expectedErrors:a})))];case 4:l=p.sent().itemResolver;i(l.execute());return[2]}})})}});function dt(e){var t=e.driveItem;return function(n){var i,s=t.root,o=t.remoteItem,u=t.name,a=s?p.t:u||o&&o.name||"",f=!t.webDavUrl,l=t.followed&&t.followed.followedDateTime,d=new h.e({publisher:dt});d.merge(n(Object(k.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))).itemResolver);d.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.d.pack(Object(k.t)(a,f))),l?c.a.pack(new Date(l).getTime()):{}),c.m.pack(f?{}:void 0)),i)});return{itemResolver:d}}}var vt=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:at.e,facets:[at.e,c.h,c.v,c.m,c.O,c.f,f.t,c.M]}));e(Object(u.r)(at.e,et.e)(ft));e(Object(u.r)(ut.e,et.e)(pt))}}),mt=n(596),gt=n(457),yt=n(849),bt=n(416),wt=n(8),Et=n(869),St=n(459),xt=Object(wt.t)()(function(){return function(e){return Tt}});function Tt(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(bt.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===St.u.key)o.push("photo");else if(f.key===St.a.key)o.push("video");else if(f.key===St.t.key)o.push("folder");else if(f.key===St.o.key)o.push("onenote");else if(f.key===St.i.key)o.push("!photo");else if(f.key===St.s.key)o.push("!video");else if(f.key===St.n.key)o.push("!folder");else if(f.key===St.r.key)o.push("!onenote");else{var l=Object(Et.e)(f);l&&o.push(l)}}return{itemKey:bt.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var Nt=n(860),Ct=n(197),kt=n(142),Lt=Object(wt.t)()(Ot),At=Object(wt.t)()(Ot);function Ot(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(bt.e,n);if(r&&r.filters&&Object(ke.e)({extFilters:Object(ke.t)(r.filters),allowedMediaTypes:[Te.e.photo,Te.e.video],fileTypeIconMap:kt.e}))return{defaultLayout:Ct.e,isLayoutResolved:!0}}return{}}}}var Mt=n(216),_t=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Mt.e.deserialize(i);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u;return Object(r.__generator)(this,function(a){n=t(Object(g.e)({groupBy:x.L})).groupBy;(o=new h.e({publisher:e})).resolveItems({items:(u={},u[i]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.t.pack({itemKey:bt.e.serialize({driveItemKey:s,sortBy:"",isAscending:!0,groupBy:n||""})})),c.h.pack(p.n)),c.m.pack({})),c.M.pack(void 0)),u)});t(o.execute());return[2]})})}});var Dt,Pt=new b.e("recentGroup",{recentItemSet:Object(b.o)(bt.e),relativeTime:Object(b.r)({today:"today",yesterday:"yesterday",thisWeek:"thisWeek",lastWeek:"lastWeek",twoWeeksAgo:"twoWeeksAgo",threeWeeksAgo:"threeWeeksAgo",thisMonth:"thisMonth",lastMonth:"thisMonth",twoMonthsAgo:"twoMonthsAgo",older:"older"})});(function(e){e.today="today";e.yesterday="testerday";e.thisWeek="thisWeek";e.lastWeek="lastWeek";e.twoWeeksAgo="twoWeeksAgo";e.threeWeeksAgo="threeWeeksAgo";e.thisMonth="thisMonth";e.lastMonth="lastMonth";e.twoMonthsAgo="twoMonthsAgo";e.older="older"})(Dt||(Dt={}));function Ht(e){var t=new Date;return(function(e,t){return Bt(t,e)})(e,t)?Dt.today:(function(e,t){return Bt(new Date(t.getTime()-864e5),e)})(e,t)?Dt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*t.getDay();return e.getTime()>n})(e,t)?Dt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-864e5*(t.getDay()+7);return e.getTime()>n})(e,t)?Dt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-12096e5;return e.getTime()>n})(e,t)?Dt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-18144e5;return e.getTime()>n})(e,t)?Dt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?Dt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?Dt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?Dt.twoMonthsAgo:Dt.older}function Bt(e,t){return e.toDateString()===t.toDateString()}var jt=new D.e("convergenceConfigurationFacet");function Ft(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function It(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function qt(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:(void 0===n||n)&&!r}}var Rt=n(3882),Ut=!Ee.t.isActivated("2477F975-39B5-47B9-AA5F-C02028225BCB","10/27/2021","Updates ODC itemsscope Recent to use prefer APIVersion 2.0 header (instead of 2.1) in the case the user has been migrated.");var zt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Wt=Object(i.i)()(function(e){var t=this,n=bt.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n,l=Object(ke.e)({extFilters:Object(ke.t)(s),allowedMediaTypes:[Te.e.photo,Te.e.video],fileTypeIconMap:kt.e}),p=Object(ke.e)({extFilters:Object(ke.t)(s),allowedMediaTypes:[Te.e.photo],fileTypeIconMap:kt.e}),d=Object(ke.e)({extFilters:Object(ke.t)(s),allowedMediaTypes:[Te.e.video],fileTypeIconMap:kt.e});return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o,y,b,w,E,S,T,N,C,k,A,O,M,_,D,P,H,B,j,F,I,q,R,z,W,X,V,$,J,K,Q,G,Y;return Object(r.__generator)(this,function(Z){switch(Z.label){case 0:t=n(Object(g.e)({graphRecentEndpoint:x.b,enableOverflowRecentGroup:x.c,convergenceConfiguration:jt})),i=t.graphRecentEndpoint,o=t.enableOverflowRecentGroup,y=t.convergenceConfiguration;if(!i)return[3,1];a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:i})});return[3,3];case 1:return[4,n(ct({endpoint:a.driveItemKey.endpoint}))];case 2:(b=Z.sent())!==a.driveItemKey.endpoint&&(a=Object(r.__assign)(Object(r.__assign)({},a),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},a.driveItemKey),{endpoint:b})}));Z.label=3;case 3:w=bt.e.serialize(a);E=Pt.serialize({recentItemSet:a,relativeTime:"today"});S=Pt.serialize({recentItemSet:a,relativeTime:"yesterday"});T=Pt.serialize({recentItemSet:a,relativeTime:"thisWeek"});N=Pt.serialize({recentItemSet:a,relativeTime:"lastWeek"});C=Pt.serialize({recentItemSet:a,relativeTime:"twoWeeksAgo"});k=Pt.serialize({recentItemSet:a,relativeTime:"threeWeeksAgo"});A=Pt.serialize({recentItemSet:a,relativeTime:"lastMonth"});O=Pt.serialize({recentItemSet:a,relativeTime:"twoMonthsAgo"});M=Pt.serialize({recentItemSet:a,relativeTime:"older"});_=[];D=[];P=[];H=[];B=[];j=[];F=[];I=[];q=[];R="";z="date"===u;W=function(e){var t,n=e.driveItemKey,i=e.item,s=new h.e({publisher:W});if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=L.e.serialize(n);if(z&&a){var l=new Date(a);switch(Ht(l)){case Dt.today:_.push(f);break;case Dt.yesterday:D.push(f);break;case Dt.thisWeek:P.push(f);break;case Dt.lastWeek:H.push(f);break;case Dt.twoWeeksAgo:B.push(f);break;case Dt.threeWeeksAgo:j.push(f);break;case Dt.lastMonth:F.push(f);break;case Dt.twoMonthsAgo:I.push(f);R=Qe[l.getMonth()];break;case Dt.older:default:q.push(f)}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},c.m.pack(void 0)),t)});return{itemResolver:s}}};X=!l&&z?function(t){var n,i,s=new h.e({publisher:X});s.resolveItems({items:(n={},n[E]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.s)),U.s.pack(!0)),f.e.pack({itemKeys:_})),n[S]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.u)),U.s.pack(!0)),f.e.pack({itemKeys:D})),n[T]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.r)),U.s.pack(!0)),f.e.pack({itemKeys:P})),n[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.t)),U.s.pack(!0)),f.e.pack({itemKeys:H})),n[C]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.o)),U.s.pack(!0)),f.e.pack({itemKeys:B})),n[k]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.i)),U.s.pack(!0)),f.e.pack({itemKeys:j})),n[A]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.e)),U.s.pack(!0)),f.e.pack({itemKeys:F})),n[O]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(R)),U.s.pack(!0)),f.e.pack({itemKeys:I})),n[M]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(Rt.n)),U.s.pack(!0)),f.e.pack({itemKeys:q})),n)});var u=[];_.length>0&&u.push(E);D.length>0&&u.push(S);P.length>0&&u.push(T);H.length>0&&u.push(N);B.length>0&&u.push(C);j.length>0&&u.push(k);F.length>0&&u.push(A);I.length>0&&u.push(O);q.length>0&&o&&u.push(M);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},f.e.pack({itemKeys:u})),i)});return{itemResolver:s}}:void 0;V=n(Object(m.i)(a.driveItemKey.endpoint));$=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];J=Ut&&(null===(Y=y)||void 0===Y?void 0:Y.isUserMigrated)?"ApiVersion=2.0":"ApiVersion=2.1";return[4,n(xe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:l?"recentMedia":V?"ODC-recent":"recent",itemKey:w,itemSetKeyFacet:bt.e,parentItemKeyFacet:Mt.e,getUrl:function(e){var t=Object(v.n)({endpoint:e.driveItemKey.endpoint,driveId:"me"})+"/recent?";if(V)t=e.driveItemKey.endpoint+"/drive/view.recent?";else if(l){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ft(t):0===t.length?It(n):It(Object(r.__spreadArrays)([Ft(t)],n))):""})(s)},getDriveItemFacets:Xt,expectedErrors:$,preprocessResponse:function(e){p?e=zt(e,"image"):d&&(e=zt(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:l?{Prefer:J+",RecentOnlyMediaApp,NoPreAuthThumbnailUrls"}:{Prefer:J+";ODC,returnparentresource,returnowner"},onProcessResponse:W,groupChildItems:X})))];case 4:K=Z.sent().itemResolver;l&&K.resolveItems({items:(Q={},Q[e.itemKey]=Object(r.__assign)({},U.u.pack({})),Q)});K.mapKeys({mappings:(G={},G[w]=e.itemKey,G)});n(K.execute());return[2]}})})}});function Xt(e){return function(t){var n,i=new h.e({publisher:Xt});i.merge(t(Object(k.e)(e)).itemResolver);var s=e.driveItem,o=s.thumbnails,u=s.remoteItem,a=o||u&&u.thumbnails;i.resolveItems({items:(n={},n[e.itemKey]=Object(r.__assign)({},a?Object(r.__assign)({},oe.e.pack(!1)):{}),n)});return{itemResolver:i}}}var Vt=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:Mt.e,facets:[Mt.e,c.h,c.v,c.m,c.O,c.f,f.t,c.M,te.r]}));e(Object(Ze.t)({keyFacet:bt.e,facets:[bt.e,f.e]}));e(Object(u.r)(Mt.e,et.e)(_t));e(Object(u.r)(bt.e,et.e)(Wt));e(Object(mt.e)(bt.e,yt.e)(xt));e(Object(mt.e)(bt.e,Nt.e)(Lt));e(Object(mt.e)(bt.e,gt.e)(At))}}),$t=n(152),Jt=!Ee.t.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","True to use multiPart getItem api(ODC vroom) to avoid CORS."),Kt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=L.e.deserialize(n);return function(s){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d,y,b,w,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=i;return i.driveId&&"me"!==i.driveId?[3,2]:[4,s(ct({endpoint:i.endpoint}))];case 1:(o=S.sent())!==i.endpoint&&(t=Object(r.__assign)(Object(r.__assign)({},i),{endpoint:o}));S.label=2;case 2:u=Object(v.n)(t);a=s(Object(g.e)({disableRemoteItemInPlace:x.i})).disableRemoteItemInPlace;f=a?ve:q;return[4,s(Object(m.i)(t.endpoint))];case 3:l=S.sent();c=Jt&&l;return[4,s(Object(m.r)({url:Object(v.t)(t)+"?$expand=thumbnails",driveUrl:u,qosName:"getItem",useMultiPartIfSupported:c,endpoint:t.endpoint}))];case 4:h=S.sent();p=s(f({driveItemResponse:h,endpoint:t.endpoint})),d=p.itemResolver,y=p.actualItemKey;d.resolveItems({items:(b={},b[e.itemKey]=Object(r.__assign)({},$t.r.pack(L.e)),b)});d.mapKeys({mappings:(w={},w[y]=n,w)});i.driveId&&"me"!==i.driveId||d.mapKeys({mappings:(E={},E[L.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:"me"}))]=L.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{driveId:""})),E[n]=L.e.serialize(t),E)});s(d.execute());return[2]}})})}});var Qt=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=w.deserialize(i),o=s.setItemKey,u=s.endpoint,a=s.token,l=b.e.get(o).deserialize(o),p=l.extFilters,d=l.driveItemKey,S=Object(v.n)(d),T=X.e.matches(o);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,l,d,v,b,N,C,A,O,M,_,D,P,H,B,j,I,q,R,U,z,W,X,V;return Object(r.__generator)(this,function($){switch($.label){case 0:return[4,t(Object(m.i)(u))];case 1:n=$.sent();s=Jt&&n;return[4,t(Object(m.n)({endpoint:u,url:a,driveUrl:S,useMultiPartIfSupported:s,qosName:"getChildrenPage"}))];case 2:l=$.sent();d=p&&p.length>0?qt(p):void 0;v=new h.e({publisher:e});b=[];for(N=0,C=l.value;N<C.length;N++){A=C[N];if(!(!!d&&d(A))){O=A&&(A.parentReference||A.remoteItem&&A.remoteItem.parentReference);M=O&&O.driveId;_=L.e.serialize({itemId:A.id,driveId:M,endpoint:u});D=null===(X=O)||void 0===X?void 0:X.id;P=(null===(V=O)||void 0===V?void 0:V.path)===F.e?F.n:D||void 0;H=O?L.e.serialize({itemId:P,driveId:M,endpoint:u}):void 0;B=t(Object(g.e)({allowDisableRemoteItemInPlace:x.i,processDriveItemFromSharePoint:x.N})),j=B.allowDisableRemoteItemInPlace,I=B.processDriveItemFromSharePoint;q=T&&j?de:k.e;b.push(_);v.merge(t(q({itemKey:_,driveItem:A,endpoint:u,parentFolderItemKey:H})).itemResolver);v.resolveItems({items:(W={},W[_]=Object(r.__assign)({},Object(y.e)().forFacet(c.h).thenInvalidate(i,f.e).forFacet(c.l).thenInvalidate(i,f.e).pack()),W)});if(I){R=t(I.process({itemKey:_,driveItem:A})).itemResolver;v.merge(R)}}}if(U=l["@odata.nextLink"]){z=w.serialize({setItemKey:o,endpoint:u,token:U});v.merge(Object(E.t)({itemKey:z}).itemResolver);b.push(z)}v.merge(Object(E.e)({itemKey:i,itemSetKey:o,childItemKeys:b}).itemResolver);t(v.execute());return[2]}})})}});var Gt=n(130),Yt=n(447);var Zt=n(3483);function en(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,l,c,p,d,y,b,w,E,S,x,T,N,k,A,O,M,_,P,H,B,j,F,I,q,z,W,V,$,J,K,Q,G,Y,ee,te,ne,re,ie,se;return Object(r.__generator)(this,function(oe){switch(oe.label){case 0:t=e.itemKey,i=e.top,s=e.skip,o=e.disableRemoteItemInPlace;u=X.e.deserialize(t);a=u.driveItemKey,l=u.extFilters;c=u.sortBy,p=u.isAscending;d=u;y=a;return a.driveId&&"me"!==a.driveId?[3,2]:[4,n(ct({endpoint:a.endpoint}))];case 1:if((b=oe.sent())!==a.endpoint){y=Object(r.__assign)(Object(r.__assign)({},a),{endpoint:b});d=Object(r.__assign)(Object(r.__assign)({},u),{driveItemKey:y})}oe.label=2;case 2:w=L.e.serialize(y);E=Object(v.n)(y);return[4,n(Object(R.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(L.e,w),totalChildCount:e.isItemFacetResolved(U.e,w)?e.demandItemFacet(U.e,w):void 0,driveType:e.isItemFacetResolved(Z.e,w)?e.demandItemFacet(Z.e,w):void 0}}))];case 3:S=oe.sent(),x=S.isParentItemResolved,T=S.totalChildCount,N=S.driveType;k=n(Object(m.i)(y.endpoint));A=Jt&&k;O=n(Object(g.e)({convergenceConfiguration:jt})).convergenceConfiguration;M=O&&O.canHandleUserMigration;_=Promise.resolve(void 0);x||(_=n(Object(m.r)({url:Object(v.t)(y),driveUrl:E,useMultiPartIfSupported:A,qosName:"getItem",endpoint:y.endpoint,headers:k&&M?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0})));P=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"},{code:"userContentMigrated"}];H=Object(v.t)(a);B=s?"&skiptoken="+(s+1)+"/"+T+"&skip="+s:"";j=k&&Zt.e?"&orderby=folder,savedSortFieldValue":"";F=c&&void 0!==p?Object(m.t)(c,p):j;I=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u&&1===e.length)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ft(t):0===t.length?It(n):It(Object(r.__spreadArrays)([Ft(t)],n))):""})(l);q="thumbnails"+(k?",lenses,tags":"");z=n(Object(m.r)({url:H+"/children?$top="+i+B+F+"&$expand="+q+"&select=*,ocr,webDavUrl"+I,driveUrl:E,qosName:"getChildren.folder",useMultiPartIfSupported:A,endpoint:y.endpoint,headers:k&&M?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:P})).catch(function(t){throw n((function(e,t){var n=e.error;return function(i){var s,o=(function(e,t){var n=Object(D.n)({},{});e instanceof Yt.e&&(n=Object(Yt.t)(e,function(e){switch(e){case 404:return Gt.p.pack({});case 401:return Gt.e.pack({});case 0:return Gt.g.pack({domain:new C.e(t).domain})}})||Object(D.n)({},{}));return n})(n,t),u=Object(D.r)({itemNotFoundError:Gt.p,accessDeniedError:Gt.e,networkBlockedError:Gt.g},o),a=u.itemNotFoundError,l=u.accessDeniedError,c=u.networkBlockedError,p=new we.e({facets:o,innerError:new we.e(n)});if(a||l||c){var d=new h.e;d.updateItems({items:(s={},s[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.e.pack(void 0)),f.o.pack(void 0)),$t.e.pack(p)),s)});i(d.execute())}return p}})(Object(r.__assign)(Object(r.__assign)({},e),{error:t}),y.endpoint))});W=[z,_];V=!1;if(!ye.e(ge.e.dataFetch.start)){ye.t(ge.e.dataFetch.start);V=!0}return[4,Promise.all(W)];case 4:$=oe.sent(),J=$[0],K=$[1];V&&ye.t(ge.e.dataFetch.end);if(K){K.folder&&(T=K.folder.childCount);K.parentReference&&K.parentReference.driveType&&(N=K.parentReference.driveType)}Q=n(Object(m.s)(y.endpoint,N));(G=new h.e({publisher:en})).mapKeys({mappings:(te={},te[X.e.serialize(d)]=e.itemKey,te[w]=L.e.serialize(u.driveItemKey),te)});if(!u.driveItemKey.driveId||"me"===u.driveItemKey.driveId){(null===(se=null===(ie=K)||void 0===ie?void 0:ie.parentReference)||void 0===se?void 0:se.driveId)&&G.mapKeys({mappings:(ne={},ne[X.e.serialize(Object(r.__assign)(Object(r.__assign)({},d),{driveItemKey:Object(r.__assign)(Object(r.__assign)({},d.driveItemKey),{driveId:K.parentReference.driveId})}))]=e.itemKey,ne)});G.mapKeys({mappings:(re={},re[L.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:"me"}))]=L.e.serialize(Object(r.__assign)(Object(r.__assign)({},u.driveItemKey),{driveId:""})),re)})}ee=(Y=G).merge;return[4,n(be({itemKey:t,itemSetKeyFacet:X.e,parentItemKeyFacet:L.e,parentItemResponse:K,childItemsResponse:J,disableRemoteItem:o,filterChildItems:l&&l.length>0?qt(l):void 0,skip:s,enableRandomAccess:Q,totalChildCount:T,onProcessResponse:function(e){var t,n=e.driveItemKey,i=new h.e({publisher:en});n&&i.resolveItems({items:(t={},t[L.e.serialize(n)]=Object(r.__assign)({},$t.r.pack(L.e)),t)});return{itemResolver:i}}}))];case 5:ee.apply(Y,[oe.sent().itemResolver]);return[2,G]}})})}}var tn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object(g.e)({pageSize:x.s})).pageSize;return[4,n(en(Object(r.__assign)(Object(r.__assign)({},e),{disableRemoteItemInPlace:!0,skip:0,top:t||F.t})))];case 1:i=s.sent();ye.t(ge.e.resolveData.start);n(i.execute());ye.t(ge.e.resolveData.end);return[2]}})})}});var nn=n(1038),rn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(nn.e)(function(){e(Object(Ze.t)({keyFacet:X.e,facets:[X.e,f.e]}));e(Object(u.r)(X.e,et.e)(tn))}));return[2]})})}}),sn=n(40),on=n(104),un=n(278),an=n(588),fn=Object(wt.t)()(function(){return function(e){return function(e,t){var n,i,s=Object(sn.e)(e),o={},u=e.demandItemFacet(X.e,t.itemKey),a=e.demandItemFacet(L.e,t.itemKey),f=e.demandItemFacet(K.e,t.itemKey,{suppressGetItems:!0}),l=e.demandItemFacet(J,t.itemKey,{suppressGetItems:!0});if(Ee.e.isActivated("09AA0112-641E-4D73-805E-DBCD89D22C3D","9/30/2021","Use new shortcutItemFacet for shortcut checks")){if(l&&t.itemKey){i={driveItemKey:l,sortBy:"",isAscending:!0};p=X.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},ln(e,{itemSetKey:p,parentItemKey:L.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:un.e.serialize({localItemKey:t.itemKey,remoteItemKey:p})})}}else if(f&&t.itemKey){var h=e.demandItemFacet(L.e,f.itemKey);if(h){i={driveItemKey:h,sortBy:"",isAscending:!0};var p=X.e.serialize(i);return Object(r.__assign)(Object(r.__assign)({},ln(e,{itemSetKey:p,parentItemKey:L.e.serialize(i.driveItemKey),stageItem:t.stageItem})),{itemKey:un.e.serialize({localItemKey:t.itemKey,remoteItemKey:p})})}}if(u){n=ln(e,{itemSetKey:X.e.serialize(u),parentItemKey:L.e.serialize(u.driveItemKey),stageItem:t.stageItem});o={itemKey:t.itemKey}}else{o=(p=(i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(X.e,i),o=e.demandItemFacet(L.e,n);if(s&&o){if(!Ee.e.isActivated("D8B0FDDF-555D-49A4-B069-D03ED692694A","11/4/2021","Do not emit item set key for non-folder items")&&o.itemId&&"root"!==o.itemId&&!e.demandItemFacet(c.m,n))return;var u=o.endpoint,a=o.driveId,f=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:u,driveId:a,itemId:f}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:s}))?X.e.serialize(i):void 0)?{itemKey:p}:{};n=i&&p&&ln(e,{itemSetKey:p,parentItemKey:L.e.serialize(i.driveItemKey),stageItem:t.stageItem})}var d=Object(an.e)(e),v=d?e.demandItemFacet(L.e,d.localItemKey):void 0;if(d&&(i||o||a)){var m=v&&v.driveId,g=u&&u.driveItemKey&&u.driveItemKey.driveId||a&&a.driveId,y=i?X.e.serialize(i):u?X.e.serialize(u):a?L.e.serialize(a):void 0;if(m!==g&&y)return Object(r.__assign)({itemKey:un.e.serialize({localItemKey:d.localItemKey,remoteItemKey:y})},n?{stageItem:n}:{})}return Object(r.__assign)(Object(r.__assign)({},o),n?{stageItem:n}:{})}}});function ln(e,t){var n=this,i=t.parentItemKey,s=t.itemSetKey,o=t.stageItem;if(i)return o?Object(on.t)(function(e){var t=e.itemsScopeItemKey,u=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(a){switch(a.label){case 0:e(Object(Ze.e)({items:(n={},n[s]=Object(r.__assign)({},f.s.pack({itemKey:i})),n)}));return[4,e(o({currentItemKey:u,itemsScopeItemKey:t}))];case 1:a.sent();return[2]}})})}}):void 0}var cn=n(215),hn=new b.e("driveItemVirtualizedPage",{endpoint:Object(b.s)(),setItemKey:Object(b.s)(),skip:Object(b.i)(),top:Object(b.i)()}),pn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=hn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return[4,n(en(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,disableRemoteItemInPlace:!1,skip:u,top:o})))];case 1:(t=a.sent()).resolveItems({items:(i={},i[s]=Object(r.__assign)({},Object(y.e)().forFacet(f.e).thenInvalidate(e.itemKey,f.e).pack()),i)});n(t.execute());return[2]}})})}});var dn=n(890),vn=new b.e("searchRootItem",{endpoint:Object(b.s)()}),mn=new b.e("searchItemSet",{driveItemKey:Object(b.o)(L.e),searchRootItemKey:Object(b.o)(vn),searchTerm:Object(b.s)()}),gn=Object(wt.t)()(function(){return function(e){return yn}});function yn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(X.e,i),o=e.demandItemFacet(mn,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===St.u.key)u.push("photo");else if(l.key===St.a.key)u.push("video");else if(l.key===St.t.key)u.push("folder");else if(l.key===St.o.key)u.push("onenote");else if(l.key===St.i.key)u.push("!photo");else if(l.key===St.s.key)u.push("!video");else if(l.key===St.n.key)u.push("!folder");else if(l.key===St.r.key)u.push("!onenote");else{var c=Object(Et.e)(l);c&&u.push(c)}}if(s)return{itemKey:X.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var bn=n(1258),wn=n(1275),En=n(1079),Sn=Object(wt.t)()(function(){return function(){return function(e,t){return{validator:En.e}}}});function xn(e,t){return mn.serialize(Object(r.__assign)({driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}var Tn=Object(wt.t)()(Cn),Nn=Object(wt.t)()(Cn);function Cn(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(X.e,r);if(i)n=function(e){return i?xn(i,e):void 0};else{var s=e.demandItemFacet(mn,r);n=function(e){return s?xn(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var kn=n(1257),Ln=n(870),An=n(896),On=n(858),Mn=n(748),_n=n(685),Dn=n(578),Pn=n(382),Hn=n(499),Bn=n(1074),jn=new D.e("addToOneDrive"),Fn=new D.e("createFolder"),In=new D.e("createLink"),qn=new D.e("delete"),Rn=new D.e("download"),Un=new D.e("invite"),zn=new D.e("move"),Wn=new D.e("officeLens"),Xn=new D.e("rename"),Vn=new D.e("upload"),$n=new b.e("commands",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0})}),Jn=n(126),Kn=(new Jn.e("addToOneDrive",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:jn}))}),new Jn.e("canCreateFolder",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Fn}))})),Qn=(new Jn.e("canCreateLink",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:In}))}),new Jn.e("canDelete",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:qn}))})),Gn=new Jn.e("canDownload",function(e,t){return!e.demandItemFacet(W.i,t.itemKey)&&er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Rn}))}),Yn=(new Jn.e("canInvite",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Un}))}),new Jn.e("canMove",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:zn}))}),new Jn.e("canUseOfficeLens",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Wn}))}),new Jn.e("canRename",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Xn}))})),Zn=new Jn.e("canUpload",function(e,t){return er(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:Vn}))});function er(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(L.e,n);if(!i)return!1;var s=i.endpoint,o=i.driveId,u=e.demandItemFacet(r,$n.serialize({endpoint:s,driveId:o}));return!!u&&!!u.roles&&tr(e,{itemKey:n,oneOfRequiredRoles:u.roles})}function tr(e,t){var n=t.itemKey;return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:(function(e,t){if((function(e,t,n){var r,i,s,o=e.demandItemFacet(G.e,t),u=null===(s=null===(i=null===(r=o)||void 0===r?void 0:r.owner)||void 0===i?void 0:i.user)||void 0===s?void 0:s.id;if(n&&u)return n.toUpperCase()===u.toUpperCase();return!o||!o.effectiveRoles||!o.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(G.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n)})}var nr=Object(wt.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(Kn,n)}}}});var rr=Object(wt.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(Yn,n),validator:En.e}}}});var ir=n("react-lib"),sr=n(42),or=n(3880),ur=Object(wt.t)()(function(){return function(){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(Qn,n),i=e.demandItemFacet(J,n);return{isAvailable:r&&!i,deleteWizard:ar}}}});var ar=Object(sr.t)(function(e,t){var n=t.itemKeys,i=t.defaultRender,s=Object(r.__rest)(t,["itemKeys","defaultRender"]),o=void 0;1===n.length?o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:or.e})}):n.length>0&&(o=Object(r.__assign)(Object(r.__assign)({},s),{deleteWizardStrings:Object(r.__assign)(Object(r.__assign)({},s.deleteWizardStrings),{confirmText:or.t})}));var u=o||s;return i?ir.createElement(i,Object(r.__assign)({itemKeys:n},u)):null}),fr=Object(wt.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(Zn,n)}}}});var lr=Object(wt.t)()(function(){return function(e){return cr}});function cr(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(c.m,n))return{};var i=e.demandItemFacet(L.e,n),s=i?Object(v.t)(i):void 0,o=i?Object(v.n)(i):void 0,u=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(Gn,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(m.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof Yt.e){f=Object(Yt.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return Gt.r.pack({});case"itemNotFound":case 404:return Gt.a.pack({});case"accessDenied":case 403:return Gt.e.pack({});default:return Gt.y.pack({})}});throw new we.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:u})}:void 0}}var hr=Object(wt.t)()(function(){return function(e){return pr}});function pr(e,t){var n=t.itemKey,i=e.demandItemFacet(L.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(v.t)(t)+"/invite";s=Object(v.n)(t);return[4,n(Object(m.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var dr=Object(wt.t)()(function(){return function(){return function(){return{}}}});var vr=Object(wt.t)()(function(){return function(e){return mr}});function mr(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(L.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(m.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var gr=n(1102),yr=n(1409),br=n(3484),wr=n(730),Er=n(2534),Sr=Object(i.t)(function(){return function(e){var t=e(Object(g.e)({useBatchedDeleteConfiguration:x._})).useBatchedDeleteConfiguration;e(Object(Ze.t)({keyFacet:L.e,facets:[L.e,c.h,c.v,c.m,K.e,J,c.O,c.f,f.t,c.M,c.i,c.p,te.r]}));e(Object(Ze.t)({keyFacet:w,facets:[w,f.e,f.r]}));e(rn);e(Object(u.r)(L.e,et.e)(Kt));e(Object(u.r)(hn,et.e)(pn));e(Object(u.r)(w,et.e)(Qt));e(Object(mt.e)(L.e,cn.e)(fn));e(Object(mt.e)(X.e,cn.e)(fn));e(Object(mt.e)(X.e,Er.e)(Tn));e(Object(mt.e)(X.e,yt.e)(gn));e(Object(u.r)(L.e,kn.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([11],4288)];case 1:return[2,e.sent().driveItemCreateFolderOperationHandler]}})})})));e(t?Object(u.r)(L.e,Ln.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(4,4289)];case 1:return[2,e.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(u.r)(L.e,Ln.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([12],3698)];case 1:return[2,e.sent().driveItemDeleteItemsOperationHandler]}})})})));e(Object(u.r)(L.e,An.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([14],4290)];case 1:return[2,e.sent().driveItemRenameItemOperationHandler]}})})})));e(Object(u.r)(L.e,On.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([15],4438)];case 1:return[2,e.sent().driveItemUploadItemsOperationHandler]}})})})));e(Object(u.r)(L.e,bn.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([13],4291)];case 1:return[2,e.sent().driveItemMoveCopyItemsOperationHandler]}})})})));e(Object(u.r)(L.e,dn.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([10],4292)];case 1:return[2,e.sent().addToOneDriveOperationHandler]}})})})));e(Object(mt.e)(L.e,Mn.e)(nr));e(Object(mt.e)(L.e,wn.e)(Sn));e(Object(mt.e)(L.e,_n.e)(rr));e(Object(mt.e)(L.e,Dn.t)(ur));e(Object(mt.e)(L.e,Pn.e)(fr));e(Object(mt.e)(L.e,gr.e)(hr));e(Object(mt.e)(L.e,yr.e)(vr));e(Object(mt.e)(L.e,Hn.t)(lr));e(Object(mt.e)(L.e,Bn.e)(dr));e(Object(mt.e)(L.e,wr.e)(br.e))}}),xr=Object(i.i)()(function e(t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=t.itemKey;s=$n.deserialize(n);o=s.endpoint;u=Object(v.n)(s);return[4,i(Tr({url:Object(v.e)(s),driveUrl:u,qosName:"commands",endpoint:o}))];case 1:a=c.sent();(f=new h.e({publisher:e})).resolveItems({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},jn.pack(a.addToOneDrive)),Fn.pack(a.createFolder)),In.pack(a.createLink)),qn.pack(a.delete)),Rn.pack(a.download)),Un.pack(a.invite)),zn.pack(a.move)),Wn.pack(a.officeLens)),Xn.pack(a.rename)),Vn.pack(a.upload)),l)});i(f.execute());return[2]}})})}});function Tr(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var Nr=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:$n,facets:[jn,Fn,In,qn,Rn,Un,zn,Wn,Xn,Vn]}));e(Object(u.r)($n,et.e)(xr))}}),Cr=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(xe(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:mn,parentItemKeyFacet:vn,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(v.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var kr=Object(i.t)(function(){return function(e){e(Object(u.r)(mn,et.e)(Cr));e(Object(mt.e)(mn,Er.e)(Nn))}}),Lr=n(3829),Ar=n(3485),Or=n(673),Mr=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Q.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,h,p=this;return Object(r.__generator)(this,function(d){t={Caller:"HoverCard"};o=e(Object(g.e)({enableCookiesForAnalyticsRequests:x.a})).enableCookiesForAnalyticsRequests,u=void 0!==o&&o;"GetItemAnalytics_addon-graph";a=Object(r.__awaiter)(p,void 0,void 0,function(){var o,a,f,l,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(m.r)({url:(g=Object(v.t)(i),y=_r(g),b="$expand=analytics($expand=allTime($expand=activities))",w="$select=*,id,reactions,trending",E=w+"&"+b+",insights($expand=keyPoints)",S=y+"?"+E,S),qosName:"GetItemAnalytics_addon-graph_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:_r(Object(v.n)(i)),allowCookies:u}))];case 1:o=d.sent();a=Object(Lr.t)(o);if(f=a.createdBy){l=H.e.serialize({email:f.email,endpoint:s});e(Object(Ze.e)({items:(h={},h[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.h.pack(f.displayName)),_.e.pack(f.email)),_.r.pack(f.image)),_.i.pack(f.id)),h[n]=Object(r.__assign)({},O.r.pack({itemKey:l,displayValue:f.displayName})),h)}))}e(Object(Ze.e)({items:(p={},p[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},O.h.pack(a.viewCount)),O.p.pack(a.viewerCount)),O.o.pack(a.isTrending)),O.e.pack(a.activities)),O.f.pack(a.likeCount)),O.t.pack(a.commentCount)),O.a.pack(a.lifeCycleStatus)),O.u.pack(a.keyPointsData)),O.s.pack(a.incompleteData)),O.i.pack(a.createdDateTime)),p)}));return[2]}var g,y,b,w,E,S})});f=[a];l=Object(r.__awaiter)(p,void 0,void 0,function(){var o,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,e(Object(m.r)({url:(h=Object(v.t)(i),p=_r(h),p+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:"GetItemAnalytics_addon-graph_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:_r(Object(v.n)(i)),allowCookies:u}))];case 1:o=c.sent();a=(function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n})(o);f=(function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:Ar.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})})(o);e(Object(Ze.e)({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)({},O.l.pack(a)),O.n.pack(f)),l)}));return[2]}var h,p})});f.push(l);e(Object(Ze.e)({items:(h={},h[n]=Object(r.__assign)({},O.c.pack([])),h)}));return[2,Object(Or.e)(f)]})})}});function _r(e){return e.replace("2.0","2.1")}var Dr=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:Q.e,facets:[O.h]}));e(Object(u.r)(Q.e,et.e)(Mr))}}),Pr=n(2647),Hr=n(669),Br=n(288),jr=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=A.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=A.e.deserialize(t.itemKey).driveItemKey,o=s.endpoint,u=s.driveId;return!!i&&!!u&&i===u&&r===o}})(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,f,l,p,d,g,b,w,E,S,x,T,N,C,k,O,M,_,D,P,H,B,j,F,I,q,R;return Object(r.__generator)(this,function(U){switch(U.label){case 0:n=Object.keys(i);s=n[0];o=A.e.deserialize(s);u=o.driveItemKey,a=u.endpoint,f=u.driveId;if(!a)throw new Error("No endpoint to determine activity items.");l=n.map(function(e){return A.e.deserialize(e).driveItemKey.itemId});p=Object(v.n)({endpoint:(z=a,z.replace("2.1","2.0")),driveId:f});d=p+"/ExtendedActivitiesForItems";g={driveItems:l,badgeOnly:!0};return[4,t(Object(m.n)({url:d,method:"POST",body:g,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:a}))];case 1:if((b=U.sent()).value){w=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(b.value);E=0;S=0;x=0;T=0;N=new h.e({publisher:e});for(C=0,k=n;C<k.length;C++){O=k[C];E++;M=A.e.deserialize(O);_=M.driveItemKey.itemId;D=_&&w[_];P=L.e.serialize(M.driveItemKey);H=void 0;if(D){B=new Pr.e;j=B.processResponse({item:{name:_||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:d},response:{value:D,"@odata.nextLink":""}}).activities;F=Fr(j);if(I=Ir(j)){x++;S++;if(!F){T++;q=qr(I,O).itemResolver;N.merge(q);H=I}}}N.resolveItems({items:(R={},R[O]=Object(r.__assign)({},Hr.e.pack(H)),R[P]=Object(r.__assign)({},Object(y.e)().forFacet(c.e).thenInvalidate(O,Hr.e).pack()),R)})}t(N.execute());t(Object(Br.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:E,activityFieldEligibleItemCount:S,activityFieldActiveItemCount:x,activityFieldBadgedItemCount:T,activityFieldBadgedPercent:E?Math.round(T/E*100):0},isIntentional:!1}))}return[2]}var z})})}});function Fr(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function Ir(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function qr(e,t){var n=new h.e({publisher:qr}),i=A.e.deserialize(t).driveItemKey,s=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(s.length>0){var o=Rr(s,i).itemResolver;n.merge(o)}return{itemResolver:n}}function Rr(e,t){for(var n=new h.e({publisher:Rr}),r=0,i=e;r<i.length;r++){var s=Ur(i[r],t).itemResolver;n.merge(s)}return{itemResolver:n}}function Ur(e,t){var n=new h.e({publisher:Ur}),r=j({itemKey:L.e.serialize(t),userKey:H.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}}).itemResolver;n.merge(r);return{itemResolver:n}}var zr=Object(i.t)(function(){return function(e){e(Object(u.r)(A.e,et.e)(jr));e(Object(u.r)(A.e,et.e)(jr))}}),Wr=n(66),Xr=Object(i.i)({mergeForSameItemKey:!1})(function e(t){var n=this,i=t.itemKey,s=t.options,o=s.isFollowed,u=s.progressItemKey,a=lt.e.deserialize(i),f=a.driveItemKey,l=f.itemId,p=void 0===l?"":l,d=Object(v.n)(f);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,i,s,l,v,y,b,w,E;return Object(r.__generator)(this,function(S){switch(S.label){case 0:n=t(Object(g.e)({saveForLaterGraphEndpoint:x.A})).saveForLaterGraphEndpoint;i=new h.e({publisher:e});s=lt.e.serialize(a);l=n||f.endpoint;u&&t(Object(Ze.e)({items:(b={},b[u]=Object(r.__assign)({},Wr.b.pack({itemKey:L.e.serialize(f)})),b)}));v=o?{url:l+"/drives/"+f.driveId+"/items/"+p+"/follow",method:"POST",qosName:"followItem"}:{url:l+"/drives/"+f.driveId+"/following/"+p,method:"DELETE",qosName:"unfollowItem"};S.label=1;case 1:S.trys.push([1,3,,4]);return[4,t(Object(m.n)({url:v.url,driveUrl:d,method:v.method,qosName:v.qosName,endpoint:l}))];case 2:S.sent();i.invalidateItems({items:(w={},w[s]=[c.E],w)});i.resolveItems({items:(E={},E[s]=Object(r.__assign)({},c.E.pack(o||void 0)),E)});t(i.execute());return[3,4];case 3:y=S.sent();throw new Error(y.message);case 4:return[2]}})})}});var Vr=n(600),$r=n(1587),Jr=n(28),Kr=n(179),Qr=Object(i.n)()(function e(t){var n=this,i=t.items;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,o,u,a,l,p,d,v,m,g,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:return[4,t(Object(R.e)(function(e){return e.demandItemFacet(Jr.p,Kr.e)}))];case 1:if(!N.sent())return[2];n=Object.keys(i);s=n[0];o=lt.e.deserialize(s);if(!(u=o.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");a=ut.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});return[4,t(Object($r.e)(function(e){return e.demandItemFacet(f.e,a)}))];case 2:l=N.sent();p=l&&l.itemKeys||[];d=new h.e({publisher:e});v={};for(m=0,g=p;m<g.length;m++){S=g[m];v[S]=!0}for(b=0,w=n;b<w.length;b++){E=w[b];S=lt.e.deserialize(E).driveItemKey;x=!!v[L.e.serialize(S)];d.resolveItems({items:(T={},T[E]=Object(r.__assign)(Object(r.__assign)({},c.E.pack(x||void 0)),Object(y.e)().forFacet(c.E).thenInvalidate(a,f.e).pack()),T)})}t(d.execute());return[2]}})})}});var Gr=Object(i.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:lt.e,facets:[c.E]}));e(Object(u.r)(lt.e,et.e)(Qr));e(Object(u.r)(lt.e,Vr.e)(Xr))}}),Yr=n(3633),Zr=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Sr);e(Nr);e(Dr);e(o.e);e(s.e);e(Vt);e(tt);e(ot);e(vt);e(kr);e(zr);e(Gr);e(Yr.e);return[2]})})}}),ei=n(522),ti=n(73),ni=Object(i.t)(function(){return function(e){e(Object(mt.e)(L.e,ei.e)(Object(wt.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(ti.o)())];case 1:t.sent();return[4,n.ee(72,4221)];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),ri=n(454),ii=n(636),si=n(77),oi=n(201),ui=n(574),ai=n(350),fi=Object(si.i)({key:new D.e("dateAccessedColumn").id,name:oi.e,fieldName:"",minWidth:si.e.regularMin,maxWidth:si.e.regularMax,isCollapsable:!0},ui.e)(function(e,t){var n=e.demandItemFacet(c.o,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(Jr.N,Kr.e),s=i&&i.language||window.navigator.language;return s?{text:Object(ai.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(c.o,t)}),li=n(2645),ci=Object(wt.t)()(function(){return function(e){return pi}});var hi=[ii.t,li.e,fi];function pi(e,t){return{columns:hi}}var di=n(410),vi=n(266),mi=n(243),gi=n(67),yi=n(831),bi=n(1469),wi=n(320),Ei=n(155);Object(Ei.n)([{rawString:".iconContainer_8a4e5e39{position:relative;font-size:16px;margin:0 4px;height:16px;width:16px}.brandIcon_8a4e5e39{position:relative;margin:0 4px;height:16px;width:16px}.brandIcon_8a4e5e39 img{display:block}.menuItemBrandIcon_8a4e5e39{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0 4px;height:36px;width:16px}.menuItemIconContainer_8a4e5e39{position:relative;margin:0 4px;height:36px;line-height:36px;width:14px}.logoFillIcon_8a4e5e39,.logoIcon_8a4e5e39{height:100%;position:absolute;left:0;right:0}.logoFillIcon_8a4e5e39[data-icon-name='ExcelLogo16'],.logoIcon_8a4e5e39[data-icon-name='ExcelLogo16']{color:#217346}.logoFillIcon_8a4e5e39[data-icon-name='OneNoteLogo16'],.logoIcon_8a4e5e39[data-icon-name='OneNoteLogo16']{color:#5c2d91}.logoFillIcon_8a4e5e39[data-icon-name='PowerPointLogo16'],.logoIcon_8a4e5e39[data-icon-name='PowerPointLogo16']{color:#d24726}.logoFillIcon_8a4e5e39[data-icon-name='WordLogo16'],.logoIcon_8a4e5e39[data-icon-name='WordLogo16']{color:#2b579a}.logoFillIcon_8a4e5e39[data-icon-name='VisioLogo16'],.logoIcon_8a4e5e39[data-icon-name='VisioLogo16']{color:#3854a2}.logoFillIcon_8a4e5e39{color:#ffffff}.contextualMenuItemLinkContent_8a4e5e39{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.contextualMenuItemTextLabel_8a4e5e39{margin:0 4px;vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}\n"}]);var Si=n(13),xi=n(1634),Ti=n(22),Ni=n(31),Ci=n(20),ki=new Ci.e("openInOfficeOnlineActionControl"),Li=n(75),Ai=n(615),Oi=Ai.n.isFeatureEnabled({ODC:"WebConvergenceEnabled"}),Mi=Object(sr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({openUrl:c.O,appFacet:ne.e,isMalwareDetected:c.k},n),s=i.openUrl,o=i.appFacet,u=i.isMalwareDetected,a=e.dispatch,f=!u&&!!o&&!!s,l=e.demandItemFacet(ki,n);return Object(r.__assign)({isAvailable:f,onExecute:s?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i,o,u,f,c;return Object(r.__generator)(this,function(r){e=(new Date).getTime().toString();t=xi.e.AddWopiPerfMarkToTargetUrl(e,"ItemsView",s);i=a(Object(R.e)(function(e){return ki.evaluate(l)(e,{itemKey:n,forceInSameWindow:!1})})).forceInSameWindow;if(Oi){o=new Li.t(t);if(-1!==o.getHost().indexOf("my.microsoftpersonalcontent.com")){(u=new Li.t("https://onedrive.live.com/edit.aspx")).setQuery(o.getQuery());f=o.getPathSegments();c=f[1];u.setQueryParameter("cid",c);t=u.toString()}}i?window.location.href=t:window.open(t);return[2]})})}:void 0},Object(Ni.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeOnline",isIntentional:!0}}))})(Ti.e),_i=Object(Si.s)()(Object(Si.r)()(Mi)),Di={key:new D.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:ir.createElement(_i,null),facets:Object(r.__assign)({},gi.t.pack(!0))},Pi=n(93),Hi=n(1307),Bi=new Ci.e("openInOfficeClientActionControl"),ji=new Pi.e,Fi=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2]})})},Ii=Object(sr.e)(function(e,t){var n=t.itemKey,i=e.demandItem({key:L.e,appMap:ne.e,fileName:c.d,openUrl:c.O,canonicalUrl:c.i,isMalwareDetected:c.k},n),s=i.key,o=i.appMap,u=i.fileName,a=i.openUrl,f=i.canonicalUrl,l=i.isMalwareDetected,h=!1,p=Fi,d=tr(e,{itemKey:n,oneOfRequiredRoles:["write","owner"]});if(n){var v=!l&&!!o&&!!a&&(ji.isMac||ji.isWindows||ji.isIOS||ji.isWinPhone||ji.isAndroid),m=e.demandItemFacet(Bi,n),g=Bi.evaluate(m)(e,{itemKey:n,isAvailable:v,protocolCallback:Ri}),y=g.protocolCallback,b=g.isAvailable;h=v&&b;s&&h&&(p=(function(e){var t=this,n=e.key,i=e.openUrl,s=e.canonicalUrl,o=e.canEdit,u=e.appMap,a=e.fileName,f=e.isNew,l=e.defaultLocation,c=e.protocolCallback;return function(){return Object(r.__awaiter)(t,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){if(!n)return[2];e=!!o;t=function(){i&&window.open(i)};Object(Hi.e)({app:u||"",itemUrl:s||"",extension:a&&a.extension||"",shouldEdit:e,isNew:Boolean(f),defaultLocation:l||"",platformDetection:ji,onNavigate:c,onFailureCallback:t});return[2]})})}})({key:s,openUrl:a,canonicalUrl:f,canEdit:d,appMap:o,fileName:u,protocolCallback:y}))}return Object(r.__assign)({isAvailable:h,onExecute:p},Object(Ni.t)(e,{itemKey:n,engagement:{name:"OpenInOfficeClient",isIntentional:!0}}))})(Ti.e),qi=Object(Si.s)()(Object(Si.r)()(Ii));function Ri(e){window.location.href=e}var Ui={key:new D.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:ir.createElement(qi,null),facets:Object(r.__assign)({},gi.t.pack(!0))},zi=n(1228),Wi=new D.e("fileHandlerOpenCommand").id,Xi={ODB:625,ODC:"CommandBarBrandIcons",Fallback:!1},Vi=(Object(Si.s)()(Object(Si.r)()(Object(sr.e)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:ne.e},n).appMap,s=r.name;r.key===Di.key?s=s||(i?Object(wi.s)(i,!1):wi.e.OpenInBrowser):r.key===Ui.key&&(s=s||(i?Object(wi.o)(i,!0):wi.e.Open));return{name:s}})(function(e){return ir.createElement("div",{className:"contextualMenuItemLinkContent_8a4e5e39"},ir.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_8a4e5e39"},e.name))}))),Object(Si.s)()(Object(Si.r)()(Object(sr.e)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:ne.e,fileName:c.d},n),o=s.appMap,u=s.fileName,a={};if(i&&i.items){var f=i.items[0];f&&-1!==f.key.indexOf(Wi)&&f.iconProps&&(a=f.iconProps)}var l=!!u&&!!u.extension&&".pdf"===u.extension.toLowerCase(),h={iconName:o?Object(wi.t)(o):l?"PDF":"OpenFile"},p=Ai.n.isFeatureEnabled(Xi),d=void 0;i&&i.items&&(d=i.items.map(function(e){return e.key===Di.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(wi.s)(o,!0)||(l?wi.e.OpenInBrowser:wi.e.Open),onRenderIcon:o?$i.bind(void 0,o,!0,p):void 0}):e.key===Ui.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:h,name:e.name||o&&Object(wi.i)(o),onRenderIcon:o?$i.bind(void 0,o,!0,p):void 0}):e}));return{iconProps:a||h,onRenderIcon:o?$i.bind(void 0,o,!1,p):void 0,text:wi.e.Open,menuProps:d?Object(r.__assign)(Object(r.__assign)({},i),{items:d}):i}})(bi.e))));function $i(e,t,n){var r=e&&Object(wi.n)(e),i=e&&Object(wi.r)(e);return i&&n?ir.createElement(zi.e,{size:16,extension:"",brand:i.toLowerCase(),className:t?"menuItemBrandIcon_8a4e5e39":"brandIcon_8a4e5e39"}):r?ir.createElement("span",{className:t?"menuItemIconContainer_8a4e5e39":"iconContainer_8a4e5e39"},ir.createElement(yi.e,{iconName:r.logoFill16,className:"logoFillIcon_8a4e5e39"}),ir.createElement(yi.e,{iconName:r.logo16,className:"logoIcon_8a4e5e39"})):null}var Ji={key:vi.e.key,automationId:vi.e.automationId,subMenuProps:{items:[Di,Ui]},onRender:function(e){return ir.createElement(Vi,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},gi.t.pack(!0))},Ki=(vi.e.key,vi.e.automationId,vi.e.name,Object(r.__assign)({},gi.t.pack(!0)),Object(wt.t)()(function(){return function(e){return function(e,t){var n=t.commands,i=t.overflowCommands,s=t.farCommands,o=i?Object(r.__spreadArrays)(i):[],u=n?Object(r.__spreadArrays)(n):[],a=s;return{commands:u=Qi(e,{defaultCommands:u}).overrideDefaultCommands,overflowCommands:o,farCommands:a}}}}));function Qi(e,t){for(var n=[],r=0,i=t.defaultCommands;r<i.length;r++){var s=i[r];s.key===vi.e.key?n.push(Ji):n.push(s)}return{overrideDefaultCommands:n}}var Gi=n(626),Yi=Object(Si.s)()(Object(Si.r)()(Object(sr.t)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(c.M,n);return r?ir.createElement(Gi.e,{itemKey:r.itemKey}):null}))),Zi=n(250),es={key:"OpenFileLocation",name:Zi.i,title:Zi.i,action:Yi,iconProps:{iconName:"FabricFolder"}},ts=Object(wt.t)()(function(){return function(e){return rs}});var ns=[vi.e,es,mi.n,mi.t];function rs(e,t){return{commands:Qi(0,{defaultCommands:ns}).overrideDefaultCommands}}var is=n(257),ss=Object(wt.t)()(function(){return function(e){return as}});var os={name:"-",key:"divider_1",itemType:is.e.Divider},us=[vi.e,es,os,mi.n,mi.t];function as(e,t){return{commands:us}}var fs=n(632),ls=Object(wt.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var cs=n(308),hs=Object(wt.t)()(function(){return function(e){return function(e,t){var n=t.itemsScopeItemKey,i=t.engagement,s=i&&i.name;return{engagement:{datasource:"Recent",extraData:Object(r.__assign)({},"ItemsView.Load"===s?ps(e,{itemsScopeItemKey:n}):{})}}}}});function ps(e,t){var n=t.itemsScopeItemKey,i=Object(sn.e)(e,n),s=e.demandItemFacet(z,i);return Object(r.__assign)({},s)}var ds=Object(i.t)(function(){return function(e){e(Object(mt.e)(Mt.e,cs.e)(hs))}}),vs=n(889),ms=Object(wt.t)()(function(){return function(){return gs}});function gs(e,t){var n=e.demandItemFacet(U.u,t.itemKey);return Object(r.__assign)({},n?{defaultLayout:vs.t.layoutType,isLayoutResolved:!0}:{})}var ys=Object(i.t)(function(){return function(e){e(Vt);e(Object(mt.e)(bt.e,ri.e)(ci));e(Object(mt.e)(Mt.e,di.e)(ts));e(Object(mt.e)(Mt.e,fs.e)(ss));e(Object(mt.e)(Pt,cn.e)(ls));e(Object(mt.e)(bt.e,gt.e)(ms));e(ds)}}),bs=n(502),ws=Object(si.i)({key:new D.e("dateFollowedColumn").id,name:oi.l,fieldName:"",minWidth:si.e.regularMin,maxWidth:si.e.regularMax,isCollapsable:!0},ui.e)(function(e,t){var n=e.demandItemFacet(c.a,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(Jr.N,Kr.e),s=i&&i.language||window.navigator.language;return s?{text:Object(ai.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(c.a,t)}),Es=n(1344),Ss=n(1272),xs=Object(si.i)({name:Ss.e,fieldName:"itemActivityColumn",key:he.n,isCollapsible:!0,minWidth:445,maxWidth:445,sortProps:si.t},Es.e)(function(e,t){return{itemKey:t,isCompact:!0,hideDate:!1}}),Ts=Object(wt.t)()(function(){return function(e){return Cs}});var Ns=[ii.t,li.e,ws,xs];function Cs(e,t){return{columns:Ns}}var ks=n(360);Object(Ei.n)([{rawString:".root_de13c386{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_de13c386{margin-left:96px}[dir='rtl'] .root_de13c386{margin-right:96px}\n"}]);var Ls=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?ir.createElement("div",{className:"root_de13c386"},this.props.group.name):null};return t})(ir.PureComponent),As=n(1693),Os=n(1714),Ms=n(505),_s=n(359),Ds=n(887);function Ps(e,t){var n=t.signals;if(n){var i=Object(_s.t)(n,function(e){return e.key===Ds.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var Hs=Object(wt.t)()(function(){return function(e){return js}});var Bs=function(e){var t=e.defaultRender,n=Object(r.__assign)({},Ms.e.pack(Ps));return t?ir.createElement(Os.e,{controlHandlers:n},ir.createElement(t,Object(r.__assign)({},e))):null};function js(){return{groupHeaderRenderer:Ls,rowRenderer:Bs,groupProps:{collapseAllVisibility:As.e.hidden}}}var Fs=n(649),Is=Object(wt.t)()(function(){return function(e){return Us}});function qs(e,t){var n=t.itemKey,r=e.demandItemFacet(c.a,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(Jr.N,Kr.e),o=s&&s.language||window.navigator.language,u=Object(ai.n)(new Date(i),o);return{itemActivity:u&&ir.createElement(ui.e,{text:u})||null}}return{}}var Rs=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},Ms.e.pack(Ps)),Fs.e.pack(qs));return t?ir.createElement(Os.e,{controlHandlers:i},ir.createElement(t,Object(r.__assign)({},n))):null};return t})(ir.PureComponent);function Us(){return{tileRenderer:Rs}}var zs=n(510),Ws=n(3884),Xs=Object(wt.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:Ws.e}}}});var Vs,$s=Object(i.t)(function(){return function(e){e(vt);e(Object(mt.e)(ut.e,ks.e)(Hs));e(Object(mt.e)(ut.e,bs.e)(Is));e(Object(mt.e)(ut.e,ri.e)(Ts));e(Object(mt.e)(ut.e,zs.e)(Xs));e(Object(mt.e)(at.e,di.e)(Ki))}}),Js=n(1087),Ks=n(50),Qs=n(670),Gs={action:ir.createElement(Ks.t,null,ir.createElement(Qs.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:Zi.a,iconProps:{iconName:"FabricFolderLink"},key:new D.e("RemoveShortcutFromSWM").id,name:Zi.u},Ys=n(141),Zs=n(212),eo=n(1669),to=n(609),no=n(1080),ro=n(144),io=n(19),so=n(1423),oo=Object(sr.t)(function(e,t){var n=t.itemKeys,i=t.removeFromSharedListWizard,s=t.removeItemsFromSharedList,o=void 0===s?no.t:s,u=Object(sn.e)(e)||"",a=e.demandItemFacet(l.e,u);if(0===n.length)return null;for(var f=a&&n.length<=200,c=i,h=0,p=n;h<p.length;h++){var d=p[h],v=e.demandItemFacet(so.e,d),m=!Ee.t.isActivated("6c28a705-1f14-4f06-97c7-ee39b2d66e9e","11/5/2020","Action should be available unless otherwise stated in control handler");so.e.evaluate(v)(e,{itemKey:d,isAvailable:m}).isAvailable||(f=!1)}var g=e.dispatch,y=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:u};t=Object(ro.e)(n,function(){return e});return[4,g(o({items:t}))];case 1:r.sent();return[2]}})})},b=Object(io.o)(function(e){return ir.createElement(c,Object(r.__assign)({},e,{onItemRemoved:y,itemKeys:n}))});return ir.createElement(Ti.e,Object(r.__assign)({isAvailable:f,onExecute:b},Object(Ni.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),uo=Object(Si.s)()(oo),ao=n(3885),fo=n(3676),lo=n(452),co=n(102),ho=((Vs={})[Wr.r.started]=function(e){return Object($e.formatToArray)(Object($e.getLocalizedCountValue)(fo.s,fo.t,e)||"",e)},Vs[Wr.r.completed]=function(e){return Object($e.formatToArray)(Object($e.getLocalizedCountValue)(fo.e,fo.t,e)||"",e)},Vs[Wr.r.failed]=function(e){return Object($e.formatToArray)(Object($e.getLocalizedCountValue)(fo.n,fo.r,e)||"",e)},Vs[Wr.r.canceled]=function(e){return Object($e.formatToArray)(Object($e.getLocalizedCountValue)(fo.n,fo.r,e)||"",e)},Vs),po=Object(i.t)(function(){return function(e){e(Object(mt.e)(no.e,lo.e)(Object(wt.t)()(vo)))}});function vo(){return function(e){return mo}}function mo(e,t){var n,i=Object(co.r)(e,t),s=i.phase,o=i.count;n=ho[s](o);return Object(r.__assign)({},n&&"item"!==t.format?{title:n}:{})}var go=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,i=t.reject,s=t.onItemRemoved,o=t.itemKeys,u=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:n();return[4,s()];case 1:e.sent();return[2]}})})},a=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){i(new Ys.e);return[2]})})};return ir.createElement(Zs.e,null,function(e){var t=e.itemCache,n=yo(t,o),r=n.title,i=n.prompt;return ir.createElement(eo.ConfirmationDialog,{onCancel:a,onConfirm:u,yesText:fo.i,noText:ao.o,defaultToYes:!0,title:r,prompt:i})})};return t})(ir.PureComponent),yo=function(e,t){if(t.length>1)return{title:ao.s,prompt:ao.i};if(1===t.length){var n=e.demandItemFacet(c.m,t[0]);return{title:n?ao.r:ao.t,prompt:n?ao.n:ao.e}}return{title:"",prompt:""}},bo=Object(to.e)({operationTypeFacet:no.n,progressKeyFacet:no.e,initializeBatch:function(){return po}});var wo=Object(sr.e)(function(){return{removeFromSharedListWizard:go,removeItemsFromSharedList:bo}})(uo),Eo={key:new D.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:Zi.f,title:Zi.l,action:ir.createElement(Ks.t,null,ir.createElement(wo,null)),iconProps:{iconName:"Cancel"}},So=Object(wt.t)()(function(){return function(e){return To}});var xo=[vi.e,mi.n,mi.t,Js.e,Gs,Eo];function To(e,t){return{commands:xo}}var No=Object(wt.t)()(function(){return function(e){return ko}});var Co=[vi.e,mi.n,mi.t,Js.e,Gs,Eo];function ko(e,t){return{commands:Co}}var Lo,Ao=n(340),Oo=((Lo={})[Be.t]=!0,Lo[Be.s]=!0,Lo[he.r]=!0,Lo[he.e]=!0,Lo[he.n]=!0,Lo),Mo=Object(wt.t)()(function(){return function(e){return _o}});function _o(e,t){var n=t.itemSetKey,i=t.handler,s=i.columnKey,o=i.isAscending;if(!Oo[s])return{};var u=e.demandItemFacet(l.e,n);if(!u)return{};var a=he.t[s];return a?{newItemSetKey:l.e.serialize(Object(r.__assign)(Object(r.__assign)({},u),{sortBy:a,isAscending:o}))}:{}}var Do,Po=n(537),Ho=Object(wt.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(l.e,n),s=i&&i.driveItemKey.endpoint,o=s&&i&&ln(0,{itemSetKey:l.e.serialize(i),parentItemKey:a.e.serialize({endpoint:s}),stageItem:t.stageItem});return Object(r.__assign)({},o?{stageItem:o}:{})}}});var Bo=((Do={})[he.r]=!0,Do[he.e]=!0,Do),jo=Object(wt.t)()(function(){return function(e){return Fo}});function Fo(e,t){var n=t.itemSetKey,i=t.handler.columnKey;if(!Bo[i])return{};var s=e.demandItemFacet(l.e,n);if(!s)return{};var o=he.t[i];return o?{newItemSetKey:l.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{groupBy:o}))}:{}}var Io=Object(wt.t)()(function(){return function(e){return qo}});function qo(e,t){var n=t.itemSetKey,i=e.demandItemFacet(l.e,n);return i?{newItemSetKey:l.e.serialize(Object(r.__assign)(Object(r.__assign)({},i),{groupBy:void 0}))}:{}}var Ro=n(1143),Uo=Object(si.i)({name:Ss.t,key:he.e,fieldName:"",minWidth:si.e.regularMin,maxWidth:si.e.regularMax,isCollapsable:!0,sortProps:si.t},ui.e)(function(e,t){var n=e.demandItemFacet(G.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(Jr.N,Kr.e);return i&&i.language||window.navigator.language?{text:Object(Ro.r)(new Date(r),!1)}:{dateValue:r}}),zo=n(752),Wo=new b.e("topCollaboratorSetKeyFacet",{endpoint:Object(b.s)()}),Xo=n(1630),Vo=n(1700),$o=n(3886);Object(Ei.n)([{rawString:".topCollaPlaceHolder_7990aeb5{display:-webkit-box;display:-ms-flexbox;display:flex;min-width:13px;height:21px}[dir='ltr'] .topCollaPlaceHolder_7990aeb5{padding-right:10px}[dir='rtl'] .topCollaPlaceHolder_7990aeb5{padding-left:10px}.topCollaboratorIcon_7990aeb5{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_7990aeb5{font-weight:700}.topCollaboratorTooltip_7990aeb5{padding:0 2px}.userWithTopCollaborator_7990aeb5{display:-webkit-box;display:-ms-flexbox;display:flex}.userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{min-width:13px}[dir='ltr'] .userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{padding-right:7px}[dir='rtl'] .userWithTopCollaborator_7990aeb5 .topCollaPlaceHolder_7990aeb5{padding-left:7px}[dir='ltr'] .columnHeader_7990aeb5{margin-left:20px}[dir='rtl'] .columnHeader_7990aeb5{margin-right:20px}\n"}]);var Jo=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=ir.createElement(yi.e,{className:"topCollaboratorIcon_7990aeb5",iconName:"TeamFavorite"}),i=ir.createElement("span",{className:"topCollaboratorUserName_7990aeb5"},t),s=ir.createElement("div",{className:"topCollaboratorTooltip_7990aeb5"},$e.formatToArray($o.e,i));return ir.createElement("div",{className:"topCollaPlaceHolder_7990aeb5"},n?null:t?ir.createElement(Vo.e,{content:s},r):r)};return t})(Xo.e),Ko=Object(si.i)({name:Ss.n,key:he.r,fieldName:"",minWidth:si.e.regularMin,maxWidth:si.e.regularMax,isCollapsable:!0,sortProps:si.r,headerClassName:"columnHeader_7990aeb5"},zo.e)(function(e,t){var n=e.demandItem({shareByPerson:P},t).shareByPerson,r=e.demandItem({sharedBy:G.e},t).sharedBy,i=n&&n.itemKey,s=n&&n.displayValue||r&&r.sharedBy&&r.sharedBy.user&&r.sharedBy.user.displayName,o=!1;if(i&&H.e.matches(i)){var u=H.e.deserialize(i).email,a=e.demandItemFacet(f.e,Wo.serialize({endpoint:"https://graph.microsoft.com/beta"}));a&&(o=a.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(_.e,t);return!!n&&n===u}))}return i||s?{people:[{itemKey:i||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return ir.createElement("div",{className:"userWithTopCollaborator_7990aeb5"},ir.createElement(Jo,{userName:r.title,isPlaceholder:!o}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(_.e,t)}),Qo=Object(wt.t)()(function(){return function(e){return Yo}});var Go=[ii.t,li.e,Uo,Ko];function Yo(e,t){return{columns:Go}}var Zo=new b.e("topCollaboratorItemKeyFacet",{id:Object(b.s)()}),eu=Object(i.i)()(function e(t){var n=this,i=t.itemKey;return function(s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,u,a,l,p,d,v,y,b,w,E,S,T,N,C;return Object(r.__generator)(this,function(k){switch(k.label){case 0:n=new h.e({publisher:e});o=s(Object(g.e)({graphEndpoint:x.m})).graphEndpoint;u=Wo.deserialize(i);a=o||u.endpoint;l=a+"/me/people/";return[4,s(Object(m.n)({url:l,qosName:"getTopCollaborator",endpoint:a}))];case 1:p=k.sent();d=[];for(v=0,y=p.value;v<y.length;v++){b=y[v];w=b.id,E=b.displayName,S=b.userPrincipalName;T=Zo.serialize({id:w});s(Object(Ze.e)({items:(N={},N[T]=Object(r.__assign)(Object(r.__assign)({},c.h.pack(E)),_.e.pack(S)),N)}));d.push(T)}n.resolveItems({items:(C={},C[t.itemKey]=Object(r.__assign)({},f.e.pack({itemKeys:d})),C)});s(n.execute());return[2]}})})}});var tu=Object(wt.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var nu=Object(wt.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var ru=Object(i.t)(function(){return function(e){e(tt);e(Object(mt.e)(a.e,di.e)(No));e(Object(mt.e)(a.e,fs.e)(So));e(Object(mt.e)(l.e,Ao.e)(Mo));e(Object(mt.e)(l.e,cn.e)(Ho));e(Object(mt.e)(l.e,Po.e)(jo));e(Object(mt.e)(l.e,Po.t)(Io));e(Object(mt.e)(l.e,ri.e)(Qo));e(Object(mt.e)(Ue,cn.e)(tu));e(Object(mt.e)(We,cn.e)(nu));e(Object(u.r)(Wo,et.e)(eu))}}),iu=n(1066),su=n(1279),ou=Object(si.i)({key:new D.e("dateTakenColumn").id,name:oi.t,fieldName:"",minWidth:si.e.regularMin,maxWidth:si.e.regularMax,isCollapsable:!0,sortProps:si.t},su.t)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return""+e.demandItemFacet(Y.u,t,{suppressGetItems:!0})}),uu=n(901),au=n(1091),fu=n(503),lu=n(456),cu=Object(wt.t)()(function(){return function(e){return du}});var hu=[ii.e,fu.e,iu.e,au.e,uu.e],pu=[ii.e,fu.e,iu.e,ou,au.e,uu.e];function du(e,t){var n,r,i=t.itemSetKey;if(i){var s=Object(lu.e)(e,{itemKey:i});if("photo"===(null===(r=null===(n=e.demandItemFacet($.e,s))||void 0===n?void 0:n.folder)||void 0===r?void 0:r.folderType))return{columns:pu}}return{columns:hu}}var vu=Object(wt.t)()(function(){return function(e){return gu}});var mu=[vi.e,es,mi.n,mi.t];function gu(e,t){return{commands:Qi(0,{defaultCommands:mu}).overrideDefaultCommands}}var yu=Object(i.t)(function(){return function(e){e(Object(mt.e)(mn,ri.e)(cu));e(Object(mt.e)(mn,di.e)(vu))}}),bu=n(1416),wu=n(654),Eu=n(1082),Su=Object(wt.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(X.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=L.e.serialize(r.driveItemKey),o=e.demandItemFacet(Z.e,s),u=e.demandItemFacet(x.s,Kr.e)||F.t,a=e.demandItemFacet(x.M,Kr.e);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(U.e,s),getPageKey:function(e,t){return hn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var xu=n(1067),Tu=!Ee.t.isActivated("637A4DC9-1258-4BD2-8166-5F852E5FEBBE","11/09/2021","The switch to add modifiedBy column in default column set."),Nu=Object(wt.t)()(function(){return function(e){return Au}});var Cu=[ii.e,fu.e,iu.e,uu.e,au.e],ku=[ii.e,fu.e,iu.e,xu.e,uu.e,au.e],Lu=[ii.e,fu.e,iu.e,ou,uu.e,au.e];function Au(e,t){var n,r,i=t.itemSetKey;if(i){var s=Object(lu.e)(e,{itemKey:i});if("photo"===(null===(r=null===(n=e.demandItemFacet($.e,s))||void 0===n?void 0:n.folder)||void 0===r?void 0:r.folderType))return{columns:Lu}}if(Tu){if((0,e.dispatch)(Object(g.e)({disableModifiedByColumn:x.r})).disableModifiedByColumn)return{columns:Cu}}return{columns:ku}}var Ou=n(23),Mu=Object(wt.t)()(function(){return function(e){return _u}});function _u(e,t){return(function(e,t,n){var i,s,o=n.itemSetKey,u=n.handler,a=u.columnKey,l=u.isAscending,c=e.demandItemFacet(t,o);if(!c)return{};var h=L.e.serialize(Object(r.__assign)({},c.driveItemKey)),p=e.demandItemFacet(Z.e,h);if(!p||"business"===p||"documentLibrary"===p)return{};if(!c.sortBy)if(Zt.e){var d=e.demandItemFacet(f.u,h);if(a===(null===(i=d)||void 0===i?void 0:i.columnKey)&&(null===(s=d)||void 0===s?void 0:s.isAscending)===l)return{newItemSetKey:o}}else if(a===fu.e.key&&!0===l)return{newItemSetKey:o};var v=Object(Ou.e)(e,{customColumnKeysToFieldNamesConfiguration:x.n}).customColumnKeysToFieldNamesConfiguration,m=Object(r.__assign)(Object(r.__assign)({},he.t),v),g=m?m[a]:void 0;if(!g)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},c),{sortBy:g,isAscending:l}))}})(e,X.e,t)}var Du=n(572),Pu=Object(wt.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var Hu=n(564),Bu=n(1414),ju=n(512),Fu={key:new D.e("openInOfficeOnlineDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:c.O,appMap:ne.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?ir.createElement(ju.e,{itemKey:n,action:Object(io.i)(e,ir.createElement(Mi,{itemKey:n}))}):void 0}}},Iu={key:new D.e("openInOfficeClientDefaultClickHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItem({openUrl:c.O,appMap:ne.e},n),i=r.openUrl,s=r.appMap;return{action:!!i&&!!s?ir.createElement(ju.e,{itemKey:n,action:Object(io.i)(e,ir.createElement(Ii,{itemKey:n}))}):void 0}}},qu=Object(wt.t)()(function(){return function(e){return function(e,t){var n=t.handlers,i=void 0===n?[]:n;return{handlers:Object(r.__spreadArrays)([Bu.e,Fu,Iu],i)}}}});var Ru=n(689),Uu=n(1471),zu=n(677),Wu=n(160),Xu=n(823),Vu=function(e,t){return n=e,Object(r.__assign)(((i={version:2})[0]="",i[1]="",i[3]="",i[6]="",i[16]="",i),n);var n,i},$u=function(e,t){var n=t.queryType,r=t.layoutType,i=r&&(function(e){return e===Wu.e?Xu.e:e===Ct.e?Xu.n:Xu.t})(r),s=Vu(e);"number"==typeof n&&i&&(s[n]=i);return s},Ju=n(1811),Ku=Object(on.t)(function(e){e.itemsScopeItemKey;var t=e.localStorageKey,n=Object(r.__rest)(e,["itemsScopeItemKey","localStorageKey"]);return function(e){var i,s=e(Object(R.e)(function(e){return Object(Ju.e)(e,{name:t})}))||{},o=s&&$u(s,Object(r.__assign)({},n));e(Object(Ju.n)({values:(i={},i[t]=o,i)}))}}),Qu=Object(wt.t)()(function(){return function(){return Yu}}),Gu=new b.e("itemsScopeList",{driveId:Object(b.s)(),itemsScopeItemKey:Object(b.s)()});function Yu(e,t){var n=Object(Ou.e)(e,{isLayoutResolvedEnabled:Jr.T,isLocalStorageForLayoutEnabled:x.T}),i=n.isLayoutResolvedEnabled,s=n.isLocalStorageForLayoutEnabled;if(!i||!s)return{};var o,u,a,f,l=t.itemsScopeItemKey,c=Object(sn.e)(e),h=e.demandItemFacet(X.e,c),p=void 0;if(c&&h&&l){var d=h.driveItemKey;if(d){var v=d.endpoint,m=d.driveId;if(!m||!v)return{};var g,y,b=Gu.serialize({driveId:m,itemsScopeItemKey:l}),w=e.demandItemFacet(x.g,Kr.e),E=w&&w(e,{itemSetKey:c}),S=E&&E.queryType||0;g="ItemsStore"+(o={endpoint:v,driveId:m,queryType:S},u=o.endpoint,a=o.driveId,f="Graph.Files.FilesQueryType."+u,f=a?f+"."+a:f).toLocaleLowerCase();var T=Object(Ju.e)(e,{name:g});p=Object(Ju.t)(e,{name:g});var N=T&&T[S]||"";y=p?(function(e){switch(e){case Xu.t:return Wu.t;case Xu.e:return Wu.e;default:return Ct.e}})(N):void 0;var C=e.demandItemFacet(Je.l,b);return{preferredLayoutType:e.demandItemFacet(Je.f,b)||y,preferredLayoutVersion:C,setPreferredLayout:function(e){var t=e.layoutType;return function(n){g&&m&&v&&n(Ku({endpoint:v,driveId:m,itemsScopeItemKey:l,queryType:S,localStorageKey:g,layoutType:t}));n(Object(nn.e)(function(){var t,i;n(Object(Ze.e)({items:(t={},t[b]=Object(r.__assign)({},Je.f.pack(e.layoutType)),t)}));n(Object(Ze.e)({items:(i={},i[b]=Object(r.__assign)({},Je.l.pack((C||0)+1)),i)}))}))}}}}}return{}}var Zu=n(1099),ea=n(230),ta=new D.e("itemRestrictedSignal").id,na=Object(wt.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(e.demandItemFacet(pe.e,n)&&n){var i=Object(r.__spreadArrays)(t.signals||[]);i.push(ra);return{signals:i}}return{}}}});var ra={signal:ir.createElement(ea.t,null),title:p.e,key:ta},ia=n(386),sa=n(168),oa=n(328);Object(Ei.n)([{rawString:".root_0b1cee7d{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;vertical-align:bottom;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.vaultCoverIsSmall_0b1cee7d{width:72px;height:52px}.vaultCoverIsLarge_0b1cee7d{width:112px;height:80px}.cover_0b1cee7d{display:block;position:absolute;padding-bottom:12px;left:-3px;right:-3px;bottom:-4px}\n"}]);var ua;(function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"})(ua||(ua={}));var aa={small:{vaultclosed:"vaultCoverSmallVaultClosed",vaultopen:"vaultCoverSmallVaultOpen"},large:{vaultclosed:"VaultCoverLargeVaultClosed",vaultopen:"VaultCoverLargeVaultOpen"}},fa=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.vaultCoverSize,i=void 0===n?"large":n,s=t.vaultCoverType,o=void 0===s?"vaultclosed":s,u=(t.ref,t.children,t.isFluent),a=Object(r.__rest)(t,["vaultCoverSize","vaultCoverType","ref","children","isFluent"]),f=aa[i][o];"small"===i?e="vaultCoverIsSmall_0b1cee7d":"large"===i&&(e="vaultCoverIsLarge_0b1cee7d");return ir.createElement("div",Object(r.__assign)({},a,{className:"root_0b1cee7d "+e+" "+(u?"isFluent":"")}),ir.createElement(yi.e,{"aria-hidden":!0,className:"ms-VaultCover cover_0b1cee7d",iconName:f}))};return t})(ir.Component);(function(e,t){void 0===e&&(e="https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons");Object(oa.n)({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{vaultCoverSmallVaultClosed:ir.createElement("img",{src:e+"/vault-sm.svg"}),vaultCoverSmallVaultOpen:ir.createElement("img",{src:e+"/vault-sm-open.svg"})}},t);Object(oa.n)({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{VaultCoverLargeVaultClosed:ir.createElement("img",{src:e+"/vault-lg.svg"}),VaultCoverLargeVaultOpen:ir.createElement("img",{src:e+"/vault-lg-open.svg"})}},t)})("https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons",{disableWarnings:!0});var la=Object(wt.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=e.demandItemFacet(ee.e,n);return Object(r.__assign)(Object(r.__assign)({},i&&i.root?{tileAs:ha}:{}),{folderCoverControlHandler:function(t,n){var r=n.signalData;if(r&&r.signal)return{};var i=e.demandItem({specialFolder:se.e},n.itemKey).specialFolder;if(!i)return{};var s=(function(e){var t=null;"desktop"===e?t=ir.createElement(ea.n,null):"documents"===e?t=ir.createElement(ea.r,null):"pictures"===e&&(t=ir.createElement(ea.c,null));return{signal:t,key:e||""}})(i);return s&&s.signal?{signalData:s}:{}}})}}});var ca=Object(sr.t)(function(e,t){var n=t.itemKey,i=Object(r.__rest)(t,["itemKey"]),s=e.demandItemFacet(ee.e,n),o=s&&s.isLocked?ua.vaultClosed:ua.vaultOpen;return ir.createElement(fa,Object(r.__assign)({},i,{vaultCoverSize:i.folderCoverSize,vaultCoverType:o}))}),ha=Object(sr.t)(function(e,t){var n=t.defaultRender,i=t.foreground,s=Object(r.__rest)(t,["defaultRender","foreground"]),o=t.itemKey,u=i,a=e.demandItemFacet(ee.e,o);a&&a.root&&(u=Object(sa.r)(e,ir.createElement(ca,Object(r.__assign)({},s,{folderCoverSize:s.tileSize,itemKey:o}))));return n?ir.createElement(n,Object(r.__assign)({},s,{foreground:u})):null}),pa=n(441),da=n(105),va=n(298);Object(Ei.n)([{rawString:".fileHandlerFileTypeIcon_7f11123a{width:inherit;height:inherit}\n"}]);var ma=Object(wt.t)()(function(){return function(e){return function(e,t){var n,i,s,o,u=t.itemKey,a=e.demandItemFacet(ee.e,u);if(a&&a.root){var f=e.demandItemFacet(c.h,u),l=a.isLocked?ua.vaultClosed:ua.vaultOpen,h={iconType:pa.e.Image,ariaLabel:f,imageProps:{src:(n=l,"https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201207.001//assets/item-types/"+(i||"20")+(o&&"png"===s?"_2x":"")+"/"+n+"."+(s||"png")),imageFit:da.t.contain,className:"fileHandlerFileTypeIcon_7f11123a"}};return{iconAs:function(e){return ir.createElement(yi.e,Object(r.__assign)({},e,h))}}}return{fileTypeIconAs:ga}}}});var ga=Object(sr.t)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(se.e,o);void 0!==f&&("desktop"===f?a=va.e.desktopFolder:"documents"===f?a=va.e.documentsFolder:"pictures"===f&&(a=va.e.picturesFolder))}return n?ir.createElement(n,Object(r.__assign)({},i,{type:a})):null}),ya=Object(i.t)(function(){return function(e){e(Sr);e(Object(mt.e)(X.e,ri.e)(Nu));e(Object(mt.e)(X.e,Zu.e)(Object(wt.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([8],4293)];case 1:return[2,e.sent().driveItemSortActionControlHandler]}})})})));e(Object(mt.e)(X.e,Ao.e)(Mu));e(Object(mt.e)(L.e,Ms.e)(na));e(Object(mt.e)(L.e,wu.e)(bu.e));e(Object(mt.e)(X.e,Eu.e)(Su));e(Object(mt.e)(L.e,Du.e)(Pu));e(Object(mt.e)(L.e,ia.e)(ma));e(Object(mt.e)(L.e,Fs.e)(la));e(Object(mt.e)(L.e,Hu.e)(qu));e(Object(mt.e)(L.e,Ru.e)(Uu.e));e(Object(mt.e)(X.e,zu.e)(Qu))}}),ba=new b.e("specialDriveItem",{endpoint:Object(b.s)(),driveId:Object(b.s)({shouldNormalizeToEmpty:!0}),name:Object(b.s)()}),wa=n(221),Ea=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=ba.deserialize(i),o=s.driveId,u=s.endpoint,a=Object(v.n)(s);return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,l,c,p,d,g,y,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:return[4,t(Object(m.n)({url:Object(v.i)(s),driveUrl:a,qosName:"getItem",endpoint:u}))];case 1:n=E.sent();l=new h.e({publisher:e});c=n&&n.parentReference;p=c&&c.driveId;d={endpoint:u,driveId:p||o,itemId:n.id};g=L.e.serialize(d);y=c&&c.id?L.e.serialize({endpoint:u,driveId:p,itemId:c.id}):void 0;l.merge(t(Object(k.e)({itemKey:g,driveItem:n,endpoint:u,parentFolderItemKey:y})).itemResolver);l.resolveItems({items:(b={},b[g]=Object(r.__assign)(Object(r.__assign)({},wa.n.pack(L.e)),f.t.pack({itemKey:X.e.serialize({driveItemKey:d,sortBy:"",isAscending:!0})})),b)});l.mapKeys({mappings:(w={},w[g]=i,w)});t(l.execute());return[2]}})})}});var Sa=Object(i.t)(function(){return function(e){e(Object(u.r)(ba,et.e)(Ea))}}),xa=Object(i.t)(function(){return function(e){e(Sa);e(Object(mt.e)(ba,ia.e)(ma));e(Object(mt.e)(ba,Fs.e)(la))}}),Ta=n(2936),Na=n(497),Ca=n(3020),ka=Object(i.i)()(function e(t){var n=this,i=t.itemKey,s=Ta.e.deserialize(i),o=s.endpoint,u=s.driveId;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:n=Object(v.n)({endpoint:o,driveId:u});return[4,t(Object(Na.getSessionToken)(o,n))];case 1:s=c.sent();a=s&&s.accessToken;(f=new h.e({publisher:e})).resolveItems({items:(l={},l[i]=Object(r.__assign)({},Ca.e.pack(a)),l)});t(f.execute());return[2]}})})}});var La=Object(i.t)(function(){return function(e){e(Object(u.r)(Ta.e,et.e)(ka))}}),Aa=n(579),Oa=Object(wt.t)()(function(){return function(e){return function(e,t){for(var n=0,r=t.sourceItemKeys;n<r.length;n++){var i=r[n],s=e.demandItemFacet(L.e,i);if(!s)return{};var o=s.itemId;if((void 0===o?F.n:o)===F.n)return{};if(t.isMove){if(!e.demandItemFacet(Qn,i))return{}}if(e.demandItemFacet(J,i))return{}}return{isAvailable:!0}}}});var Ma=Object(i.t)(function(){return function(e){e(Object(mt.e)(L.e,Aa.e)(Oa))}}),_a=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Zr);e(ya);e(La);e(ni);e(ys);e($s);e(ru);e(xa);e(yu);e(Ma);return[2]})})}})}}]);