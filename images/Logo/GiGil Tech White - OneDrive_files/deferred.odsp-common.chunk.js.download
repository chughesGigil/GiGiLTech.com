(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-common"],{1143:function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"i",function(){return N});n.d(t,"s",function(){return k});n.d(t,"e",function(){return L});n.d(t,"n",function(){return A});n.d(t,"o",function(){return O});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(624),v=n(2052),m=n(403),g=n(18),y=n(260),b=n(350),w=n(305),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function T(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=H(u,-1),f=H(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=M(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,j({month:"short",day:"numeric"},r));if(o<w.o)return n?v.n:v.t;if(h&&o<w.t)return B(o,v.i,w.n);if(w.l(u,e))return g?B(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,j({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,j({weekday:"long"},r))}return w.c(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.e.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function O(e,t){return w.p(e,M(m.e.language),t)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},1594:function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstConsistentlyInteractive",function(){return i});var r=n(1698);n.d(t,"restartLongTaskObserver",function(){return r.t});function i(e){void 0===e&&(e={});if("PerformanceLongTaskTiming"in window){return new r.e(e).getFirstConsistentlyInteractive()}return Promise.resolve(null)}},1685:function(e,t,n){"use strict";n.r(t);n.d(t,"EngagementHelper",function(){return u});n.d(t,"mergeEngagementData",function(){return a});n.d(t,"EngagementPartType",function(){return i.r});n.d(t,"EngagementPart",function(){return i.n});n.d(t,"EngagementBuilder",function(){return i.t});n.d(t,"ENGAGEMENT_ROOT",function(){return i.e});n.d(t,"clickEngagementPart",function(){return f.e});n.d(t,"keyPressEngagementPart",function(){return f.n});n.d(t,"dropEngagementPart",function(){return f.t});n.d(t,"getMostSpecificMatchingContext",function(){return l});var r=n(0),i=n(728),s=n(149),o=n(164),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.handlers,o=void 0===i?[]:i,u=n.logData,a=void 0===u?function(e){return s.e.logData(e)}:u;r._handlers=o;r._logData=a;return r}t.prototype.logData=function(e){void 0===e&&(e={});if(this.contexts.length||e.name){for(var t=this.contexts.map(function(e,t){return{context:e,order:t}}).sort(function(e,t){return e.context.part.type-t.context.part.type||e.order-t.order}).map(function(e){return e.context}),n=e.name,i=void 0===n?t.map(function(e){return e.part.name}).join("."):n,s=e.isIntentional,o=void 0!==s&&s,u=e.extraData,f=Object(r.__rest)(void 0===u?{}:u,[]),l=Object(r.__rest)(e,["name","isIntentional","extraData"]),c=Object(r.__assign)({name:i,isIntentional:o,extraData:f},l),h=0,p=t;h<p.length;h++){var d=p[h],v=d.part,m=d.extraData,g=void 0===m?{}:m,y={};for(var b in g)y[v.name+"_"+b]=g[b];a(c,{extraData:y});a(c,d.part.getEngagementData(d)||{})}for(var w=0,E=this._handlers;w<E.length;w++){var S=E[w],x=S.getEngagementData.apply(S,t);x&&a(c,x)}this._logData(c)}};t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},handlers:this._handlers,logData:this._logData})};return t})(i.t);function a(e,t){var n=t.extraData,i=void 0===n?{}:n,s=t.experiment;(function e(t,n){for(var r in n){var i=n[r];if("object"==typeof i&&i){var s="object"==typeof t[r]&&t[r]||{};t[r]=s;e(s,i)}else void 0!==i&&(t[r]=i)}})(e,Object(r.__rest)(t,["extraData","experiment"]));Object(o.e)(e.extraData,i);void 0!==s&&(e.experiment=s)}var f=n(2657);function l(e,t){for(var n=t.length-1;n>=0;n--){var r=t[n];if(e.matches(r))return r}}},1698:function(e,t,n){"use strict";n.d(t,"t",function(){return l});n.d(t,"e",function(){return c});var r=n(0),i=0;var s=["img","script","iframe","link","audio","video","source"];function o(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];if(t.includes(i.nodeName.toLowerCase())||o(i.children,t))return!0}return!1}function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a()&&console.log.apply(console,e)}function a(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableTTILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}function f(e,t){if(e.length>2)return performance.now();for(var n=[],r=0,i=t;r<i.length;r++){var s=i[r];n.push({timestamp:s.start,type:"requestStart"});n.push({timestamp:s.end,type:"requestEnd"})}for(var o=0,u=e;o<u.length;o++){var a=u[o];n.push({timestamp:a,type:"requestStart"})}n.sort(function(e,t){return e.timestamp-t.timestamp});for(var f=e.length,l=n.length-1;l>=0;l--){var c=n[l];switch(c.type){case"requestStart":f--;break;case"requestEnd":if(++f>2)return c.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0}function l(){window.__tti&&window.__tti.o.observe({entryTypes:["longtask"]})}var c=(function(){function e(e){var t=this;void 0===e&&(e={});this._useMutationObserver=!!e.useMutationObserver;this._trackNetworkRequests=!!e.trackNetworkRequests;this._minValue=e.minValue||null;this._requiredMainThreadQuietnessDurationInMilliseconds=e.requiredMainThreadQuietnessDurationInMilliseconds||5e3;this._requiredNetworkQuietnessDurationInMilliseconds=e.requiredNetworkQuietnessDurationInMilliseconds||5e3;var n=window.__tti&&window.__tti.e,r=window.__tti&&window.__tti.o;this._longTaskId=0;if(n){u("Consuming the long task entries already recorded.");this._longTasks=n.map(function(e){return t._createLongTask(e)});window.__tti.e=[]}else this._longTasks=[];r&&r.disconnect();this._networkRequests=[];this._incompleteJSInitiatedRequestStartTimes=new Map;this._timerId=void 0;this._timerActivationTime=-1/0;this._scheduleTimerTasks=!1;this._firstConsistentlyInteractiveResolver=null;this._performanceObserver=null;this._mutationObserver=null;this._registerListeners(this._trackNetworkRequests)}e.prototype.getFirstConsistentlyInteractive=function(){var e=this;return new Promise(function(t,n){e._firstConsistentlyInteractiveResolver=t;"complete"===document.readyState?e.startSchedulingTimerTasks():window.addEventListener("load",function(){e.startSchedulingTimerTasks()})})};e.prototype.startSchedulingTimerTasks=function(){u("Enabling FirstConsistentlyInteractiveDetector");this._scheduleTimerTasks=!0;var e=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,t=f(this._incompleteRequestStarts(),this._networkRequests);this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,e))};e.prototype._rescheduleTimer=function(e){var t=this;if(this._scheduleTimerTasks){u("Attempting to reschedule FirstConsistentlyInteractive check to "+e);u("Previous timer activation time: "+this._timerActivationTime);if(this._timerActivationTime>e)u("Current activation time is greater than attempted reschedule time. No need to postpone.");else{clearTimeout(this._timerId);this._timerId=setTimeout(function(){t._checkTTI()},Math.max(0,e-performance.now()));this._timerActivationTime=e;u("Rescheduled firstConsistentlyInteractive check at "+e)}}else u("startSchedulingTimerTasks must be called before calling rescheduleTimer")};e.prototype._disable=function(){u("Disabling FirstConsistentlyInteractiveDetector");clearTimeout(this._timerId);this._scheduleTimerTasks=!1;this._unregisterListeners()};e.prototype._registerPerformanceObserver=function(e){var t=this;void 0===e&&(e=!0);this._performanceObserver=new PerformanceObserver(function(n){for(var r=0,i=n.getEntries();r<i.length;r++){var s=i[r];"resource"===s.entryType&&e&&t._networkRequestFinishedCallback(s);"longtask"===s.entryType&&t._longTaskFinishedCallback(s)}});this._performanceObserver.observe({entryTypes:e?["longtask","resource"]:["longtask"]})};e.prototype._registerListeners=function(e){void 0===e&&(e=!0);if(e){u=this._beforeJSInitiatedRequestCallback.bind(this),a=this._afterJSInitiatedRequestCallback.bind(this),f=XMLHttpRequest.prototype.send,l=i++,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u(l.toString());this.addEventListener("readystatechange",function(){4===e.readyState&&a(l.toString())});return f.apply(this,t)};t=this._beforeJSInitiatedRequestCallback.bind(this),n=this._afterJSInitiatedRequestCallback.bind(this),r=window.fetch,window.fetch=function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];return new Promise(function(s,o){var u=i++;t(u.toString());r.apply(void 0,e).then(function(e){n(u.toString());s(e)},function(e){n(e);o(e)})})}}var t,n,r,u,a,f,l;this._registerPerformanceObserver(e);this._useMutationObserver&&(this._mutationObserver=(function(e){var t=new MutationObserver(function(t){for(var n=0,r=t;n<r.length;n++){var i=r[n];("childList"===i.type&&o(i.addedNodes,s)||"attributes"===i.type&&s.includes(i.target.tagName.toLowerCase()))&&e(i)}});t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]});return t})(this._mutationObserverCallback.bind(this)))};e.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect();this._mutationObserver&&this._mutationObserver.disconnect()};e.prototype._beforeJSInitiatedRequestCallback=function(e){u("Starting JS initiated request. Request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.set(e,performance.now());u("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._afterJSInitiatedRequestCallback=function(e){u("Completed JS initiated request with request ID: "+e);this._incompleteJSInitiatedRequestStartTimes.delete(e);u("Active XHRs: "+this._incompleteJSInitiatedRequestStartTimes.size)};e.prototype._networkRequestFinishedCallback=function(e){u("Network request finished",e);this._networkRequests.push({start:e.fetchStart,end:e.responseEnd});this._rescheduleTimer(f(this._incompleteRequestStarts(),this._networkRequests)+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._longTaskFinishedCallback=function(e){u("Long task finished",e);var t,n=this._createLongTask(e),r="longTaskEnd"+n.id;t=r,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=r;this._longTasks.push(n);this._rescheduleTimer(n.end+this._requiredMainThreadQuietnessDurationInMilliseconds)};e.prototype._mutationObserverCallback=function(e){u("Potentially network resource fetching mutation detected",e);u("Pushing back FirstConsistentlyInteractive check by "+this._requiredNetworkQuietnessDurationInMilliseconds+" milliseconds.");this._rescheduleTimer(performance.now()+this._requiredNetworkQuietnessDurationInMilliseconds)};e.prototype._getMinValue=function(){return this._minValue?this._minValue:performance.timing.domContentLoadedEventEnd?performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart:null};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._incompleteRequestStarts=function(){return Object(r.__spreadArrays)(Array.from(this._incompleteJSInitiatedRequestStartTimes.values()))};e.prototype._checkTTI=function(){u("Checking if First Consistently Interactive was reached...");var e=performance.timing.navigationStart,t=f(this._incompleteRequestStarts(),this._networkRequests),n=(window.chrome&&window.chrome.loadTimes?1e3*window.chrome.loadTimes().firstPaintTime-e:0)||performance.timing.domContentLoadedEventEnd-e,r=this._getMinValue(),i=performance.now();if(null!==r){u("Parameter values:");u("NavigationStart",e);u("lastKnownNetwork2Busy",t);u("Search Start",n);u("Min Value",r);u("Last busy",t);u("Current time",i);u("Long tasks",this._longTasks);u("Incomplete JS Request Start Times",this._incompleteRequestStarts());u("Network requests",this._networkRequests);var s=(function(e,t,n,r,i,s,o,u){if(s&&r-n<u)return null;var a=0===i.length?e:i[i.length-1].end;if(r-a<o)return null;if(a&&i.length>0){var f=i[i.length-1].endMarkName;f&&performance.measure("TTI",void 0,f)}return Math.max(a,t)})(n,r,t,i,this._longTasks,this._trackNetworkRequests,this._requiredMainThreadQuietnessDurationInMilliseconds,this._requiredNetworkQuietnessDurationInMilliseconds);if(s&&this._firstConsistentlyInteractiveResolver){u("maybeFCI",s);this._firstConsistentlyInteractiveResolver({tti:s,longTasks:this._longTasks});this._disable()}else{u("Could not detect First Consistently Interactive. Retrying in 1 second.");this._rescheduleTimer(performance.now()+1e3)}}else{u("No usable minimum value yet. Postponing check.");this._rescheduleTimer(Math.max(this._trackNetworkRequests?t+this._requiredNetworkQuietnessDurationInMilliseconds:0,i+1e3))}};return e})()},1736:function(e,t,n){"use strict";n.r(t);n.d(t,"getFirstCPUIdle",function(){return o});function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i()&&console.log.apply(console,e)}function i(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableFCILogging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(e){}return!1}var s=(function(){function e(e){this._longTaskId=0;this._checkFCIRunId=0;this._isDisposed=!1;var t=e.requiredMainThreadCPUIdleDurationInMilliseconds,n=e.measurementStartTime;this._measurementStartTime=n;this._requiredMainThreadCPUIdleDurationInMilliseconds=t;this._resultResolver={resolve:void 0,reject:void 0};this._fciPromise=void 0;this._longTasks=[];this._processLongTaskPreQueue();this._registerLongTaskObserver()}e.prototype.measureFCI=function(){var e=this;if(this._isDisposed)throw"FCIMeasurer is disposed.";this._fciPromise||(this._fciPromise=new Promise(function(t,n){e._resultResolver.resolve=t;e._resultResolver.reject=n}));this._tryScheduleNextCheck();return this._fciPromise};e.prototype._tryScheduleNextCheck=function(){var e=this;this._checkFCIRunId&&clearTimeout(this._checkFCIRunId);var t=this._findEarlestPossibleCheckTime(),n=performance.now(),r=Math.max(0,t-n);this._checkFCIRunId=setTimeout(function(){e._checkFCI()},r)};e.prototype._findEarlestPossibleCheckTime=function(){var e=this._getLatestLongTask(),t=e&&e.end||-1/0;return Math.max(t+this._requiredMainThreadCPUIdleDurationInMilliseconds,this._measurementStartTime+this._requiredMainThreadCPUIdleDurationInMilliseconds,performance.now())};e.prototype._checkFCI=function(){var e,t=performance.now(),n=this._longTasks?this._longTasks.length:0;r("Running checkFCI:");r("Measurement start time",this._measurementStartTime);r("Current time",t);r("Long tasks",this._longTasks);r("latestLongTaskEndTime",null===(e=this._longTasks[n-1])||void 0===e?void 0:e.end);if(!this._measurementStartTime||this._measurementStartTime<0)this._onFoundFCI(NaN);else if(0!==n){for(var i=this._longTasks[0],s=1;s<n;s++){var o=this._longTasks[s],u=Math.max(i.end,this._measurementStartTime);if(o.start>=this._measurementStartTime&&o.start-u>=this._requiredMainThreadCPUIdleDurationInMilliseconds){this._onFoundFCI(u,i.endMarkName);return}i=o}if(t-i.end>=this._requiredMainThreadCPUIdleDurationInMilliseconds){var a=i.end>this._measurementStartTime?i.endMarkName:void 0;this._onFoundFCI(Math.max(i.end,this._measurementStartTime),a)}}else t-this._measurementStartTime>=this._requiredMainThreadCPUIdleDurationInMilliseconds&&this._onFoundFCI(this._measurementStartTime)};e.prototype._onFoundFCI=function(e,t){t&&performance.measure("FCI",void 0,t);r("possibleFCI:",e);this._resultResolver.resolve&&this._resultResolver.resolve({fci:e,longTasks:this._longTasks});this._dispose()};e.prototype._dispose=function(){clearTimeout(this._checkFCIRunId);this._longTaskObserver.disconnect();this._isDisposed=!0};e.prototype._getLatestLongTask=function(){for(var e=void 0,t=0,n=this._longTasks;t<n.length;t++){var r=n[t];(!e||r.end>e.end)&&(e=r)}return e};e.prototype._processLongTaskPreQueue=function(){if(window.__fci){var e=window.__fci.o,t=window.__fci.e;if(e){for(var n=0,r=t;n<r.length;n++){var i=r[n];if("longtask"===i.entryType){var s=this._createLongTask(i);this._longTasks.push(s)}}e.disconnect()}}};e.prototype._registerLongTaskObserver=function(){var e=this;this._longTaskObserver=new PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];"longtask"===i.entryType&&e._longTaskFinishedCallback(i)}});this._longTaskObserver.observe({entryTypes:["longtask"]})};e.prototype._createLongTask=function(e){var t=e.startTime+e.duration;return{attribution:e.attribution,name:e.name,start:Math.round(e.startTime),end:Math.round(t),id:this._longTaskId++}};e.prototype._longTaskFinishedCallback=function(e){r("Long task finished: ",e);var t,n=this._createLongTask(e),i="longTaskEnd"+n.id;t=i,window.performance&&performance.mark&&performance.mark(t);n.endMarkName=i;this._longTasks.push(n);this._tryScheduleNextCheck()};return e})();function o(e){if("PerformanceLongTaskTiming"in window){return new s(e).measureFCI()}return Promise.resolve(null)}},1832:function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"i",function(){return h});n.d(t,"r",function(){return p});n.d(t,"e",function(){return v});var r=n(0),i=n(10),s=n(147),o=n(194),u=n(175),a=n(1840),f=n(263),l="@ms/odsp-shared/lib/base/BaseModel",c=new i.t({name:l+".asyncType",factory:new i.e(u.e)}),h=new i.t({name:l+".observablesFactoryType",factory:new s.r(a.e,{asyncType:c.optional})}),p=new i.t({name:l+".eventGroupType",factory:new i.e(o.t)}),d=new i.t({name:l+".errorHandler"}),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.id,s=void 0===i?"":i;r.id=s;r._BaseModel_dependencies=n;return r}Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!0,configurable:!0});t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})};t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)};t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)};t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)};t.prototype.addDisposable=function(e){return this.scope.attach(e)};t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.wrapObservable=function(e){return this.observables.wrap(e)};t.prototype.peekUnwrapObservable=function(e){return Object(a.r)(e)};t.prototype.createObservable=function(e){return this.observables.create(e)};t.prototype.unwrapObservable=function(e){return Object(a.i)(e)};t.prototype.isObservable=function(e){return Object(a.n)(e)};t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getAsync=function(){return e};return e};t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getEvents=function(){return e};return e};t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});this._BaseModel_getObservables=function(){return e};return e};t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(c.optional)||u.e};t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t};t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(h.optional)||Object(i.i)(a.e,{asyncType:this._BaseModel_getAsyncType()}))||a.e};t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(d.optional)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.e.dependencies),{asyncType:c.optional,observablesFactoryType:h.optional,eventGroupType:p.optional,errorHandler:d.optional});return t})(f.e);t.n=v},1833:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1832),s=n("knockout-lib"),o=n(1867),u=n(10),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.element=t.element;r.valueAccessor=t.valueAccessor;r.allBindingsAccessor=t.allBindingsAccessor;r.bindingContext=t.bindingContext;r.controlsDescendantBindings=!1;return r}t.init=function(e,t,n,r,i){var a=new u.n(o.e(i)),f=new(this.supportsDependencies?a.resolved(this):a.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});s.utils.domNodeDisposal.addDisposeCallback(e,function(){return f.dispose()});return{controlsDescendantBindings:f.controlsDescendantBindings}};t.dependencies=Object(r.__assign)({},i.n.dependencies);t.supportsVirtualElements=!1;t.supportsDependencies=!1;return t})(i.n);t.t=a},1834:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(1832),s=n(18),o=n(1933),u=n("knockout-lib");var a={init:function(e,t,n,r,i){u.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i);if(i){var s=i.$component;if(s){var o=u.utils.unwrapObservable(t());if(o){var a=s.__automationTypeBinding$elements;a||(a=s.__automationTypeBinding$elements={});var f=a[o];f||(f=a[o]=[]);f.push(e);u.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=f.indexOf(e);if(-1!==t){delete f[t];f.splice(t,1)}})}}}}},f=n(1833),l=n(29),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.element.getAttribute("class");n.element.setAttribute("class",n._expandIconClassNames(r));return n}t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),r=[],i=0,s=n;i<s.length;i++){var o=s[i];this._lastClassesAdded&&this._lastClassesAdded[o]||r.push(o);if(0===o.indexOf("ms-Icon--")){var u=o.substring(9),a=Object(l.C)(u);if(a&&-1===n.indexOf(a)){t[a]=!0;r.push(a)}}}this._lastClassesAdded=t;return r.join(" ")}return e};t.after=["css","class"];return t})(f.e),h=n(164),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.bindingHandlers={};r.automationId=t&&t.automationId||void 0;r.addBindingHandlers({automation:o.e,automationType:a,icon:c});return r}t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(s.format)(e,t)};t.prototype.addBindingHandlers=function(e){Object(h.e)(this.bindingHandlers,e)};return t})(i.n);t.t=p},1835:function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n("knockout-lib"),i=n(1142);function s(e){var t=e.tagName,n=e.template,i=e.viewModel,s=e.synchronous,o=void 0!==s&&s;r.components.register(t,{viewModel:i,template:n,synchronous:o});return e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.e.setText(n,t);document.head.appendChild(n)}},1839:function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});function r(e,t){return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;for(var n in e)if(e[n]!==t[n])return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0}function s(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}},1840:function(e,t,n){"use strict";n.d(t,"r",function(){return l});n.d(t,"i",function(){return c});n.d(t,"n",function(){return h});n.d(t,"t",function(){return p});var r=n(0),i=(n(1852),n(83)),s=n("knockout-lib");s.onError=function(e){i.e.log(e)};var o=n(486),u=n(175),a=n(1839),f=n(164);function l(e){return h(e)?e.peek():e}function c(e){return s.unwrap(e)}function h(e){return s.isObservable(e)}function p(e){return{defaultValue:e,reducer:function(e,t){return t}}}var d=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});this._owner=e.owner;this._asyncType=t.asyncType}Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!0,configurable:!0});e.prototype.subscribe=function(e,t,n){var r,i=(void 0===n?{}:n).isBeforeChange;void 0!==i&&i&&(r="beforeChange");return this.scope.attach(e.subscribe(t,this._owner,r))};e.prototype.create=function(e){return s.observable(e)};e.prototype.createArray=function(e){return s.observableArray(e)};e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,s=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return s(e,c(t))},c(i))});o.equalityComparer=a.n;return Object(f.e)(o,{register:function(e){var i,s=""+ ++t;n(Object(r.__assign)(Object(r.__assign)({},n.peek()),((i={})[s]=e,i)));return{dispose:function(){var e=n.peek(),t=s,i=(e[t],Object(r.__rest)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})};e.prototype.compute=function(e,t){var n=this,r={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i=(function(e){return"object"==typeof e})(e)?e:{read:e},o=s.utils.extend(r,i);t&&s.utils.extend(o,t);var u=s.computed(o);return this.scope.attach(u)};e.prototype.pureCompute=function(e,t){var n={pure:!0};t&&s.utils.extend(n,t);return this.compute(e,n)};e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};t&&s.utils.extend(n,t);return this._setupBackgroundTask(this.compute(e,n))};e.prototype.wrap=function(e){return h(e)?e:this.create(e)};e.prototype.peekUnwrap=function(e){return h(e)?e.peek():e};e.prototype.unwrap=function(e){return c(e)};e.prototype.isObservable=function(e){return h(e)};e.prototype.ignore=function(e){return(function(e){return s.ignoreDependencies(e)})(e)};e.prototype.dispose=function(){this._scope&&this._scope.dispose()};e.prototype._setupBackgroundTask=function(e){var t=this;this._backgroundTasks||(this._backgroundTasks=[]);this._backgroundTasks.push(e);this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()}));return e};e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId;delete this._backgroundTasks};e.prototype._getAsync=function(){var e=this._asyncType||u.e,t=this.scope.attach(new e(this));this._getAsync=function(){return t};return t};return e})();t.e=d},1852:function(e,t,n){"use strict";n("knockout-projections-lib")},1867:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var s=n(10),o=n(594),u=n(1880);function a(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var f={loadViewModel:function(e,t,n){n(function(n,f){void 0===n&&(n={});var l,c=i.contextFor(f.element),h=i.utils.unwrapObservable(n.resources)||a(c),p={owner:e,useFactoriesOnKeys:!0},d=h?new s.n(h,p):new s.n(p);n=Object(r.__assign)(Object(r.__assign)({},n),{resources:d});l=(function(e){return"function"==typeof e.createViewModel})(t)?t.createViewModel(n,f):new(d.injected(t))(n);var v=new u.e({name:e,viewModel:l,element:f.element,bindingContext:c});return Object(o.e)(l,function(){v.dispose();d.dispose()})})}};i.components.loaders.unshift(f)},1880:function(e,t,n){"use strict";var r=0,i=(function(){function e(e){var t=this._viewModel=e.viewModel,n=t.__ResourceComponentLoader$componentId=""+ ++r;t.__ResourceComponentLoader$componentBindingElement=e.element;t.__ResourceComponentLoader$childComponents={};t.__ResourceComponentLoader$componentName=e.name;for(var i=e.bindingContext;i&&(!i.$data||i.$data===t||!i.$data.__ResourceComponentLoader$childComponents);)i=i.$parentContext;if(i){var s=this._parentViewModel=i.$data;s.__ResourceComponentLoader$childComponents[n]=t;t.__ResourceComponentLoader$parentComponentViewModel=s}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e.__ResourceComponentLoader$componentId,r=t&&t.__ResourceComponentLoader$childComponents;n&&r&&delete r[n];if(e){delete e.__ResourceComponentLoader$parentComponentViewModel;delete e.__ResourceComponentLoader$childComponents;delete e.__ResourceComponentLoader$componentBindingElement;delete e.__ResourceComponentLoader$componentName}};return e})();t.e=i},1892:function(e,t,n){"use strict";var r=(function(){function e(){this.R=0;this.G=0;this.B=0;this.A=e.maxComponent}e.clone=function(t){return e.fromRgba(t.R,t.G,t.B,t.A)};e.equals=function(e,t){var n=!e,r=!t;return n||r?n&&r:e.R===t.R&&e.G===t.G&&e.B===t.B&&e.A===t.A};e.fromRgba=function(t,n,r,i){var s=new e;s.R=Math.round(t);s.G=Math.round(n);s.B=Math.round(r);s.A=null!=i?Math.round(i):e.maxComponent;return s};e.fromRgbaString=function(t){var n=new e;if(/^rgb.+/.test(t)){var r=t.match(/[\d.]+/g);n=e.fromRgba(Number(r[0]),Number(r[1]),Number(r[2]),4===r.length?Number(r[3])*e.maxComponent:null)}return n};e.fromHtmlColor=function(t){function n(e,t,n){return parseInt(e.charAt(t)+e.charAt(n),16)}var r=new e;if("string"==typeof t&&"#"===t.charAt(0))switch(t.length){case 9:r.A=n(t,1,2);r.R=n(t,3,4);r.G=n(t,5,6);r.B=n(t,7,8);break;case 7:r.R=n(t,1,2);r.G=n(t,3,4);r.B=n(t,5,6);break;case 4:r.R=n(t,1,1);r.G=n(t,2,2);r.B=n(t,3,3)}else/^rgb.+/.test(t)&&(r=e.fromRgbaString(t));return r};e.toHtmlString=function(t,n){function r(t){var n=Number(t);if(!(n>=0&&n<=e.maxComponent))throw new Error("Argument must be a Number in [0, 255]");var r=n.toString(16);n<16&&(r="0"+r);return r}return t.A<e.maxComponent&&!n?"rgba("+t.R.toString(10)+", "+t.G.toString(10)+", "+t.B.toString(10)+", "+(t.A/e.maxComponent).toFixed(2)+")":"#"+(n?r(t.A):"")+r(t.R)+r(t.G)+r(t.B)};e.maxComponent=255;return e})();t.e=r},1911:function(e,t,n){"use strict";var r=n(841);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},1916:function(e,t,n){"use strict";var r=n(74),i=n(262),s=(function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var n={callback:e,signal:null,canceled:!1,result:null};n.signal=new i.e(function(){n.canceled=!0;r.n.is(n.result)&&n.result.cancel()});this._queue.push(n);t=n.signal.getPromise()}return r.n.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e})();t.e=s},1933:function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r=n("knockout-lib");function i(e,t){var n=e.__automationBinding$elements;return n&&n[t]}t.e={init:function(e,t,n,i,s){r.applyBindingsToNode(e,{attr:{"data-automationId":t()}},s);if(s){var o=s.$component;if(o){var u=r.utils.unwrapObservable(t());if(u){var a=o.__automationBinding$elements;a||(a=o.__automationBinding$elements={});a[u]=e;r.utils.domNodeDisposal.addDisposeCallback(e,function(){a[u]&&delete a[u]})}}}}}},1969:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(764),i=n(119),s=Object(r.e)({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},i.e)},1979:function(e,t,n){"use strict";var r;(function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"})(r||(r={}));t.e=r},1987:function(e,t,n){"use strict";var r=(function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!==(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e})();t.e=r},1999:function(e,t,n){"use strict";n(1852);var r=n(594),i=n("knockout-lib"),s=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=i.observableArray();this._initializeGroups();Object(r.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),s=e._groupsByKeyId[r];if(s)s.values.push(t);else{s={key:n,values:i.observableArray([t])};e._groupsByKeyId[r]=s;e.groups.push(s)}return{mappedValue:r,dispose:function(){if(s.values.peek().length>1)s.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(s)}}}}})};return e})();t.e=s},2004:function(e,t,n){"use strict";var r=(function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e})();t.e=r},2042:function(e,t,n){"use strict";var r,i=n(1892),s=[.537,.349,.216,.184,.145,.082,.043,.027],o=[.537,.45,.349,.216,.184,.145,.082,.043],u=[.88,.77,.66,.55,.44,.33,.22,.11],a=[.11,.22,.33,.44,.55,.66,.77,.88],f=[.96,.84,.7,.4,.12],l=[.1,.24,.44];(function(e){e[e.Unshaded=0]="Unshaded";e[e.Shade1=1]="Shade1";e[e.Shade2=2]="Shade2";e[e.Shade3=3]="Shade3";e[e.Shade4=4]="Shade4";e[e.Shade5=5]="Shade5";e[e.Shade6=6]="Shade6";e[e.Shade7=7]="Shade7";e[e.Shade8=8]="Shade8"})(r||(r={}));function c(e,t){return{h:e.h,s:e.s,v:e.v-e.v*t}}function h(e,t){return{h:e.h,s:e.s-e.s*t,v:e.v+(100-e.v)*t}}function p(e,t,n){if(!e||t===r.Unshaded||!(function(e){return"number"==typeof e&&e>=r.Unshaded&&e<=r.Shade8})(t))return e;var p=h,d=c;if(n){p=c;d=h}var v=(function(e){var t,n,r=NaN,i=e.R,s=e.G,o=e.B,u=Math.max(i,s,o),a=Math.min(i,s,o),f=u-a;0===f?r=0:i===u?r=(s-o)/f%6:s===u?r=(o-i)/f+2:o===u&&(r=(i-s)/f+4);(r=Math.round(60*r))<0&&(r+=360);t=Math.round(100*(0===u?0:f/u));n=Math.round(u/255*100);return{h:r,s:t,v:n}})(e),m=(function(e){var t=e.h,n=e.s,r=e.v,i=(2-(n/=100))*(r/=100),s=n*r;return{h:t,s:100*(s=(s/=i<=1?i:2-i)||0),l:100*(i/=2)}})(v),g=t-1;return(function(e){var t=e.h,n=e.s,r=e.v,s=[],o=(r/=100)*(n/=100),u=t/60,a=o*(1-Math.abs(u%2-1)),f=r-o;switch(Math.floor(u)){case 0:s=[o,a,0];break;case 1:s=[a,o,0];break;case 2:s=[0,o,a];break;case 3:s=[0,a,o];break;case 4:s=[a,0,o];break;case 5:s=[o,0,a]}return i.e.fromRgba(Math.round(255*(s[0]+f)),Math.round(255*(s[1]+f)),Math.round(255*(s[2]+f)))})(v=(function(e){return 255===e.R&&255===e.G&&255===e.B})(e)?c(v,s[g]):(function(e){return 0===e.R&&0===e.G&&0===e.B})(e)?h(v,o[g]):m.l/100>.8?d(v,a[g]):m.l/100<.2?p(v,u[g]):g<f.length?p(v,f[g]):d(v,l[g-f.length]))}var d=(function(){function e(){}e.generateFabricColors=function(t,n){void 0===n&&(n=!1);var s={themeDarker:r.Shade8,themeDark:r.Shade7,themeDarkAlt:r.Shade6,themeLight:r.Shade3,themeLighter:r.Shade2,themeLighterAlt:r.Shade1,themePrimary:r.Unshaded,themeAccent:r.Unshaded,themeSecondary:r.Shade5,themeTertiary:r.Shade4},o=e._getDefaultThemeTokenMap(),u=i.e.fromRgba(t.R,t.G,t.B);for(var a in s){var f=s[a];o[a]=p(u,f,n)}var l=o.themeAccent;o.themeAccentTranslucent10=l?i.e.fromRgba(l.R,l.G,l.B,.1*i.e.maxComponent):null;if(n){var c={black:"#fff",blackTranslucent40:"#66ffffff",neutralDark:"#f4f4f4",neutralPrimary:"#fff",neutralPrimaryTranslucent50:"#7fffffff",neutralPrimaryAlt:"#dadada",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#6d6d6d",neutralQuaternary:"#4f4f4f",neutralQuaternaryAlt:"#484848",cmdbarSelected:"#4f4f4f",cmdbarSelectedHover:"#484848",neutralLight:"#3f3f3f",neutralLighter:"#313131",neutralLighterAlt:"#282828",white:"#1f1f1f",whiteTranslucent40:"#661f1f1f",error:"#f00",errorBackground:"#7e3333"};for(var h in c)c.hasOwnProperty(h)&&(o[h]=i.e.fromHtmlColor(c[h]))}return o};e._getDefaultThemeTokenMap=function(){return{backgroundOverlay:null,themeDarker:null,themeDark:null,themeDarkAlt:null,themePrimary:null,themeSecondary:null,themeTertiary:null,themeLight:null,themeLighter:null,themeLighterAlt:null,black:null,cmdbarSelected:null,cmdbarSelectedHover:null,neutralDark:null,neutralPrimary:null,neutralPrimaryAlt:null,neutralPrimaryTranslucent50:null,neutralSecondary:null,neutralSecondaryAlt:null,neutralTertiary:null,neutralTertiaryAlt:null,neutralQuaternary:null,neutralQuaternaryAlt:null,neutralLight:null,neutralLighter:null,neutralLighterAlt:null,white:null,blackTranslucent40:null,whiteTranslucent40:null,yellow:null,yellowLight:null,orange:null,orangeLight:null,redDark:null,red:null,magentaDark:null,magenta:null,magentaLight:null,purpleDark:null,purple:null,purpleLight:null,blueDark:null,blueMid:null,blue:null,blueLight:null,tealDark:null,teal:null,tealLight:null,greenDark:null,green:null,greenLight:null,error:null,errorBackground:null,success:null,successBackground:null,alert:null,alertBackground:null,infoBackground:null,info:null,orangeLighter:null}};return e})();t.e=d},2051:function(e,t,n){"use strict";var r,i=n(260),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},2098:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n("knockout-lib");function i(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}function s(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}}function o(e,t){var n=e.peek(),i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=r.computed(function(){!t()&&e()&&t(e())}),o=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){s.dispose();o.dispose();i.dispose()}}}},2144:function(e,t,n){"use strict";var r=n(2042),i=n(1892),s=n(78),o=(function(){function e(){}e.makeWebThemeRestUrl=function(e,t,n){var r=e;r&&"/"===r[r.length-1]&&(r=r.substring(0,r.length-1));r=s.e.escapeUrlForCallback(r);var i=s.e.escapeUrlForCallback(r)+"/_api/SP.Web.GetContextWebThemeData?noImages=true&lcid="+s.e.encodeURIComponent(t);n&&(i+="&ThemeOverride="+s.e.encodeURIComponent(n));return i};e.processWebThemeRestResponse=function(t){var n,r=JSON.parse(t);r&&r.d&&r.d.GetContextWebThemeData&&(n=JSON.parse(r.d.GetContextWebThemeData));return e.processRawThemeData(n)};e.processRawThemeData=function(t){if(t){var n,s=e.coerceToColor,o=e.SetColorIfMissing,u=t.Palette?t.Palette.Colors:{};n=e.convertColorsToRgba(u);var a=r.e.generateFabricColors(n.ContentAccent1,t.IsInverted),f=s(n.PageBackground)||s(t.IsInverted?"#1b1a19":"#ffffff"),l=s(n.BackgroundOverlay)||null,c=Math.round(.4*i.e.maxComponent);for(var h in a)o(n,h,a[h]);o(n,"white",f);o(n,"primaryBackground",i.e.clone(f));o(n,"primaryText",a.primaryText||s("#333"));o(n,"whiteTranslucent40",f&&i.e.fromRgba(f.R,f.G,f.B,c));o(n,"backgroundOverlay",l);o(n,"suiteBarBackground",s(n.SuiteBarBackground)||null);o(n,"suiteBarText",s(n.SuiteBarText)||null);o(n,"suiteBarDisabledText",s(n.SuiteBarDisabledText)||null);o(n,"topBarBackground",s(n.TopBarBackground)||null);o(n,"topBarText",s(n.TopBarText)||null);o(n,"topBarHoverText",s(n.TopBarHoverText)||null);o(n,"dialogBorder",s(n.DialogBorder)||null);return{backgroundImageUri:t.BackgroundImageUri,cacheToken:t.ThemeCacheToken,isDefault:t.IsDefault,isInverted:t.IsInverted,palette:n,version:t.Version}}return{backgroundImageUri:"",cacheToken:"",isDefault:!0,isInverted:!1,palette:{},version:""}};e.convertColorsToRgba=function(t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=e.coerceToColor(t[r]);i&&(n[r]=i)}return n};e.coerceToColor=function(t){var n;t?"string"==typeof t||t instanceof String?n=i.e.fromHtmlColor(String(t)):"DefaultColor"in t?n=e.coerceToColor(t.DefaultColor):"R"in t&&"G"in t&&"B"in t&&(n=i.e.fromRgba(t.R,t.G,t.B,t.A)):n=null;return n};e.SetColorIfMissing=function(e,t,n){e[t]||(e[t]=n)};return e})();t.e=o},2152:function(e,t,n){"use strict";var r=n(1892),i=n(123),s=n(79),o=(function(){function e(){}e.clearThemeCache=function(){var t=e.getThemeDataStore();t.remove("Data");t.remove("CacheToken");t.remove("CacheVersion")};e.getCachedTheme=function(t){var n,r=e.getThemeDataStore();try{t===r.getValue("CacheToken")&&"1.7"===r.getValue("CacheVersion")&&(n=r.getValue("Data"))}catch(e){}return n};e.updateThemeCache=function(t,n){var r=e.getThemeDataStore();r.setValue("Data",t);r.setValue("CacheToken",n||t.cacheToken);r.setValue("CacheVersion","1.7")};e.getThemeDataStore=function(){return new i.e("odTheme",s.e.local)};return e})(),u=n(74),a=n(41),f=n(119),l=(function(){function e(e){this._loadData=e}e.getBackgroundUrl=function(t){return t?e._makeCssUrl(t.backgroundImageUri):"none"};e._makeCssUrl=function(t){var n="none";t&&(n='url("'+e._escapeQuotesAndParentheses(t)+'")');return n};e._escapeQuotesAndParentheses=function(e){var t={"'":"%27",'"':"%22","(":"%28",")":"%29"},n=null;null!=e&&(n=e.replace(/(['"\(\)])/gm,function(e,n){return t[n]}));return n};e.prototype.loadThemeTokenMap=function(t,n){return this.loadThemeData(t,n).then(function(t){var n;if(t&&t.palette){n={};var i=t.palette;for(var s in i){var o=i[s];n[s]=o?r.e.toHtmlString(o):null}n.backgroundImageUri=e._makeCssUrl(t.backgroundImageUri)}return n},function(e){return null})};e.prototype.loadThemeData=function(e,t){if(!t&&this._dataPromise)return this._dataPromise;var n=this,r=null,i=a.e.Failure;this._dataPromise=f.e.instrumentPromise({name:"ThemeProvider.LoadData"},function(){return new u.n(function(s,f){var l=null;t||(l=o.getCachedTheme(e));l?s(l):n._loadData(t).done(function(t){if(t){t.cacheToken&&o.updateThemeCache(t,e);s(t)}else{r="NoData";f&&f("No model returned")}},function(e){if(u.n.isCanceled(e)){r="Canceled";i=a.e.ExpectedFailure}else r="ServerLoadFailure";f&&f(e)})})},null,function(e){if(u.n.isCanceled(e)){i=a.e.ExpectedFailure;r="Canceled"}var t=e;if(e){var n={name:e.name||void 0,message:e.message&&e.message.value||e.message||void 0,correlationId:e.correlationId||void 0};t=JSON.stringify(n)}return{resultType:i,resultCode:r||"Other",error:t}});return this._dataPromise};return e})();t.e=l},2284:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(r||(r={}));t.t=r},2356:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},2389:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"})(r||(r={}))},2414:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(18);function i(e){return new Date(e)}function s(e,t){void 0===t&&(t=!1);var n=new Date(e),i=n.getTimezoneOffset()<0,s=n.getFullYear()+"",o=Object(r.leftPad)(n.getMonth()+1+"",2),u=Object(r.leftPad)(n.getDate()+"",2),a=Object(r.leftPad)(n.getHours()+"",2),f=Object(r.leftPad)(n.getMinutes()+"",2),l=Object(r.leftPad)(n.getSeconds()+"",2),c=(i?"+":"-")+Object(r.leftPad)(i?(Math.ceil(n.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(n.getTimezoneOffset()/60)+"",2)+Object(r.leftPad)((n.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}},2567:function(e,t,n){"use strict";n.d(t,"e",function(){return y});n.d(t,"t",function(){return w});var r=n("react-lib"),i=n(1819),s=n(2192),o=n(2389),u=n(831),a=n(29),f=n(2423),l=n(18),c=n(1700),h=n(111),p=n(260),d={ODB:1306};var v=n(2990),m=n(44),g=new Date("0001-01-01T00:00:00-08:00"),y=function(e){var t,n,m,y,E=e.itemAnalytics,S=e.onClick,x=e.onLikeClick,T=(e.pageUrl,e.isLink),N=e.status,C=e.isCompact,k=e.disableViewerCount,L=void 0===k||k,A=e.ODBOptOutViewerList,O=void 0!==A&&A,M=e.itemKey,_=w();if(N===o.e.failed){var D=Object(a.O)();t=_.apiError&&(n="ErrorBadge",m=_.apiError,y={color:D.palette.redDark},r.createElement(r.Fragment,null,r.createElement(u.e,{iconName:n,className:"fileHoverCardErrorIcon_86ea3a8a",styles:{root:Object(a.H)([{paddingRight:"8px",position:"relative"},y])}}),m))}if(t)return null;if(!E||!E.viewCount||!E.viewerCount)return r.createElement(s.e,{className:"analyticsStats_86ea3a8a",isCompact:!0});var P=E.viewCount,H=E.viewerCount,B=E.activities,j=E.commentCount,F=E.likeCount,I=E.incompleteData&&E.incompleteData.missingDataBeforeDateTime&&new Date(E.incompleteData.missingDataBeforeDateTime).getTime()!==g.getTime(),q=E.incompleteData&&E.incompleteData.wasThrottled,R=I?f.fe:q?f.Ae:"",U=L?O?f.be:"":f.Ce,z=R||U,W=P>1?_.views:_.view,X=H>1?_.viewers:_.viewer,V=j&&j>1?_.comments:_.comment,$=F&&F>1?_.likes:_.like,J=j?""+l.format(V,j):"",K=F?""+l.format($,F):"",Q=p.e.isFeatureEnabled(d)?x:void 0,G=K&&b(K,Q),Y=J&&b(J,void 0,void 0);return C?T?r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",onClick:S},r.createElement(s.e,{activityPersonas:B&&0!==B.length?B.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:r.createElement("div",{className:"analyticsStatsLabel_86ea3a8a"},P&&r.createElement("div",{className:"analyticsStatsCount_86ea3a8a"},P+" "+W)),isCompact:!0})),K&&M?r.createElement(v.e,{likeLabel:K,itemKey:M}):G,Y):r.createElement("div",{className:"analyticsStatsContainer_86ea3a8a"},b(P+" "+W,void 0),b(H+" "+X,void 0),z&&r.createElement(c.e,{content:z,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsTeachingMessage_86ea3a8a",iconName:"Info","aria-describedby":z})),G,Y):r.createElement("div",{className:"analyticsStatsViews_86ea3a8a"},H+" "+X,r.createElement("span",{className:"analyticsStatsViewsDivider_86ea3a8a"}),P+" "+W,R&&r.createElement(c.e,{content:R,directionalHint:h.e.bottomCenter},r.createElement(u.e,{className:"analyticsStatsInfo_86ea3a8a",iconName:"Info","aria-describedby":R})))};y.defaultProps={isLink:!1};function b(e,t,n){var o=r.createElement(s.e,{activityDescription:r.createElement("div",{className:Object(m.e)("analyticsStatsLabel_86ea3a8a","analyticsStatsCount_86ea3a8a")},e),isCompact:!0});return t||n?r.createElement(i.e,{className:"analyticsStatsLink_86ea3a8a",href:n+"#comments",target:"_blank",onClick:t},o):r.createElement("div",{className:"analyticsStatsNoLink_86ea3a8a"},o)}function w(){return{details:f.Ne,viewer:f.Fe,viewers:f.Ie,view:f.Be,views:f.qe,comment:f.Ee,comments:f.Se,like:f.xe,likes:f.Te,apiError:f.te,suggestion:f.ke,unsupportMessage:f.He,accessActivity:f.Y,modifiedActivity:f.ye,activityTemplate:f.Z,inCompleteDataMessage:f.ae,throttledMessage:f.Le,trendingItem:f.Pe,loginUserYou:f.Re}}},2599:function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(119),i=n(41),s=!1,o=!1;function u(){if(!o){o=!0;(function(){if(s||!o)return;s=!0;new r.e({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:i.e.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}})()}}function a(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}},2657:function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(728),i=new r.n("Click",4),s=new r.n("KeyPress",4),o=new r.n("Drop",4)},3041:function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e,t,n){var r=e&&e.toLowerCase(),i=t&&t.toLowerCase(),s=n&&n.toLowerCase();return!(r!==i&&r!==s)}},3158:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(721),i=n(156),s=n(260),o=n(16);function u(e,t,n){if(e.type===i.t.OneNote)return!1;if(e.list||e.subsite)return!1;return!(!s.e.isFeatureEnabled({ODB:831,ODC:"UseDownloadMicroservice"})||n||!e.urls[r.e.downloadAsZip]||!e.urls[r.e.itemUrl]||0===e.childCount||e.type!==i.t.Folder)||!e.isRootFolder&&(!!t&&((!t||!t.list||t.list.templateType!==o.n.webPageLibrary)&&(e.type===i.t.File||e.type===i.t.Media||e.type===i.t.Unknown)))}},3383:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(149);function s(e,t,n){t?i.e.logData({name:e,isIntentional:!0,extraData:Object(r.__assign)({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},n)}):i.e.logData(Object(r.__assign)({name:e},n))}},3642:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n("react-lib"),s=n(1563),o=n(2567),u=n(1706),a=n(321),f=n(2389),l=n(1270),c=function(e){var t=e.items,n=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==f.e.unsupport&&c.status!==f.e.failed),m=e.itemKey?i.createElement(l.e,{className:"analyticsActionBar_43e4af34",commands:t,farCommands:n}):i.createElement(s.e,{className:"analyticsActionBar_43e4af34",items:t,farItems:n});return i.createElement("div",null,i.createElement("div",{className:"analyticsActionBarStats_43e4af34"},i.createElement(u.e,{width:"35%",isDataLoaded:v,shimmerElements:[{type:a.e.line,height:8}]},i.createElement(o.e,Object(r.__assign)({isLink:h,isCompact:!0},c)))),d&&(n.length>0||t.length>0)&&m)}},3820:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n("react-lib"),s=n(2067),o=n(1821),u=n(444),a=n(2192),f=n(1853),l=n(18),c=n(2567),h=n(2423),p=n(3041),d=function(e){var t=e.activity,n=e.loginUserEmail,r=e.userEmail,s=Object(c.t)(),o="";"Access"===t.activityType?o=s.accessActivity:"Modified"===t.activityType&&(o=s.modifiedActivity);var u=t&&t.actor&&t.actor.user,d=Object(p.e)(u&&u.email,n,r)?s.loginUserYou:u&&u.displayName||u&&u.email||h.oe,v=i.createElement("div",{className:"analyticsActivityUserName_f87f3312"},d),m=i.createElement("div",{className:"analyticsActivityUserAction_f87f3312"},o),g=s.activityTemplate&&l.formatToArray(s.activityTemplate,v,m),y=f.n.size24;return i.createElement(a.e,{activityPersonas:[{imageUrl:u.image,imageAlt:d,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:y}],activityDescription:i.createElement("div",{dir:"auto",className:"analyticsActivity_f87f3312"},g),timeStamp:t.activityDateTime,styles:{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}})},v=n(2599),m=n(2338),g=n(83),y=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};t.prototype.render=function(){return i.createElement(o.e,{size:u.e.large})};return t})(i.Component),b=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return e&&e.activity&&i.createElement("div",{className:"analyticsActivityListActivity_603257bf"},i.createElement(d,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?i.createElement(y,{onLoaded:n.props.onLoadMoreActivities}):void 0)};n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map(function(e){return{activity:e}}),itemAnalyticsData:t.itemAnalytics};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.itemAnalytics){this._updateActivities(e.itemAnalytics);this.props.pageContext&&this._updateAcronyms(e.itemAnalytics)}};t.prototype.render=function(){var e,t=this,n=this.props.showAnalyticsStats,r=void 0===n||n,o=this.state.itemAnalyticsData,u=Object(c.t)();o&&o.incompleteData&&o.incompleteData.wasThrottled&&(e=u.throttledMessage);if(o){v.t();return i.createElement("div",null,r&&i.createElement(c.e,{itemAnalytics:o,inComplete:!!e}),this.state.items&&i.createElement(s.e,{items:this.state.items,onRenderCell:this._onRenderCell,onShouldVirtualize:function(){return t.state.items.length>30}}))}return i.createElement(y,null)};t.prototype._updateActivities=function(e){this.setState(function(){return{itemAnalyticsData:e,items:e.activities.map(function(e){return{activity:e}})}})};t.prototype._updateAcronyms=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,3,,4]);if(!this.props.pageContext)return[3,2];t=e.activities.map(function(e){return e.actor.user.displayName});return[4,new m.e(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})];case 1:n=r.sent();i=n.reduce(function(e,t){t.text&&(e[t.text]=t);return e},{});this.setState(function(e){return{items:e.items.map(function(e){var t=i[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}})}});r.label=2;case 2:return[3,4];case 3:s=r.sent();g.e.logError(s);v.e(s);return[3,4];case 4:return[2]}})})};return t})(i.Component)},3877:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(149),i=(function(){function e(){}e.registerClicks=function(t){if(t&&!e._appDictionary[t]){e._appDictionary[t]=!0;document&&document.body&&document.body.addEventListener("click",function(e){var t=e.target;if(t){var n=t.getAttribute("data-logging-id");n&&r.e.logData({name:n+".Click"})}},!0)}};e._appDictionary={};return e})()},3879:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(155);function i(){Object(r.n)(".o365cs-base .o365cs-nav-contextMenu {    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base-visibility{  visibility: visible;}\n.o365cs-base .ms-fcl-tdr,.o365cs-base .ms-fcl-tdr-h:hover,.o365cs-base .ms-fcl-tdr-f:focus{    color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bgc-tdr,.o365cs-base .ms-bgc-tdr-h:hover,.o365cs-base .ms-bgc-tdr-f:focus{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-bcl-tdr,.o365cs-base .ms-bcl-tdr-h:hover,.o365cs-base .ms-bcl-tdr-f:focus{    border-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-base .ms-fcl-td,.o365cs-base .ms-fcl-td-h:hover,.o365cs-base .ms-fcl-td-f:focus{    color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bgc-td,.o365cs-base .ms-bgc-td-h:hover,.o365cs-base .ms-bgc-td-f:focus{    background-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-bcl-td,.o365cs-base .ms-bcl-td-h:hover,.o365cs-base .ms-bcl-td-f:focus{    border-color: '[theme:themeDark, default:#0d62aa]';}\n.o365cs-base .ms-fcl-tda,.o365cs-base .ms-fcl-tda-h:hover,.o365cs-base .ms-fcl-tda-f:focus{    color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bgc-tda,.o365cs-base .ms-bgc-tda-h:hover,.o365cs-base .ms-bgc-tda-f:focus{    background-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-bcl-tda,.o365cs-base .ms-bcl-tda-h:hover,.o365cs-base .ms-bcl-tda-f:focus{    border-color: '[theme:themeDarkAlt, default:#106ebe]';}\n.o365cs-base .ms-fcl-tp,.o365cs-base .ms-fcl-tp-h:hover,.o365cs-base .ms-fcl-tp-f:focus{    color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bgc-tp,.o365cs-base .ms-bgc-tp-h:hover,.o365cs-base .ms-bgc-tp-f:focus,.o365cs-base.ms-bgc-tp{    background-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-bcl-tp,.o365cs-base .ms-bcl-tp-h:hover,.o365cs-base .ms-bcl-tp-f:focus{    border-color: '[theme:themePrimary, default:#0078d7]';}\n.o365cs-base .ms-fcl-ts,.o365cs-base .ms-fcl-ts-h:hover,.o365cs-base .ms-fcl-ts-f:focus{    color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bgc-ts,.o365cs-base .ms-bgc-ts-h:hover,.o365cs-base .ms-bgc-ts-f:focus{    background-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-bcl-ts,.o365cs-base .ms-bcl-ts-h:hover,.o365cs-base .ms-bcl-ts-f:focus{    border-color: '[theme:themeSecondary, default:#2b88d8]';}\n.o365cs-base .ms-fcl-tt,.o365cs-base .ms-fcl-tt-h:hover,.o365cs-base .ms-fcl-tt-f:focus{    color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bgc-tt,.o365cs-base .ms-bgc-tt-h:hover,.o365cs-base .ms-bgc-tt-f:focus{    background-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-bcl-tt,.o365cs-base .ms-bcl-tt-h:hover,.o365cs-base .ms-bcl-tt-f:focus{    border-color: '[theme:themeTertiary, default:#71afe5]';}\n.o365cs-base .ms-fcl-tl,.o365cs-base .ms-fcl-tl-h:hover,.o365cs-base .ms-fcl-tl-f:focus{    color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bgc-tl,.o365cs-base .ms-bgc-tl-h:hover,.o365cs-base .ms-bgc-tl-f:focus{    background-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-bcl-tl,.o365cs-base .ms-bcl-tl-h:hover,.o365cs-base .ms-bcl-tl-f:focus{    border-color: '[theme:themeLight, default:#c7e0f4]';}\n.o365cs-base .ms-fcl-tlr,.o365cs-base .ms-fcl-tlr-h:hover,.o365cs-base .ms-fcl-tlr-f:focus{    color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bgc-tlr,.o365cs-base .ms-bgc-tlr-h:hover,.o365cs-base .ms-bgc-tlr-f:focus{    background-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-bcl-tlr,.o365cs-base .ms-bcl-tlr-h:hover,.o365cs-base .ms-bcl-tlr-f:focus{    border-color: '[theme:themeLighter, default:#deecf9]';}\n.o365cs-base .ms-fcl-tlra,.o365cs-base .ms-fcl-tlra-h:hover,.o365cs-base .ms-fcl-tlra-f:focus{    color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bgc-tlra,.o365cs-base .ms-bgc-tlra-h:hover,.o365cs-base .ms-bgc-tlra-f:focus{    background-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-bcl-tlra,.o365cs-base .ms-bcl-tlra-h:hover,.o365cs-base .ms-bcl-tlra-f:focus{    border-color: '[theme:themeLighterAlt, default:#eff6fc]';}\n.o365cs-base .ms-fcl-w,.o365cs-base .ms-fcl-w-h:hover,.o365cs-base .ms-fcl-w-f:focus{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bgc-w,.o365cs-base .ms-bgc-w-h:hover,.o365cs-base .ms-bgc-w-f:focus,.o365cs-base.ms-bgc-w{    background-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-bcl-w,.o365cs-base .ms-bcl-w-h:hover,.o365cs-base .ms-bcl-w-f:focus{    border-color: '[theme:white, default:#ffffff]';}\n.o365cs-base .ms-fcl-b,.o365cs-base .ms-fcl-b-h:hover,.o365cs-base .ms-fcl-b-f:focus{    color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-b.o365cs-nav-closeButton{    color: #000000;}\n.o365cs-base .ms-bgc-b,.o365cs-base .ms-bgc-b-h:hover,.o365cs-base .ms-bgc-b-f:focus,.o365cs-base.ms-bgc-b{    background-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-bcl-b,.o365cs-base .ms-bcl-b-h:hover,.o365cs-base .ms-bcl-b-f:focus{    border-color: '[theme:black, default:#000000]';}\n.o365cs-base .ms-fcl-nd,.o365cs-base .ms-fcl-nd-h:hover,.o365cs-base .ms-fcl-nd-f:focus{    color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bgc-nd,.o365cs-base .ms-bgc-nd-h:hover,.o365cs-base .ms-bgc-nd-f:focus{    background-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-bcl-nd,.o365cs-base .ms-bcl-nd-h:hover,.o365cs-base .ms-bcl-nd-f:focus{    border-color: '[theme:neutralDark, default:#212121]';}\n.o365cs-base .ms-fcl-np,.o365cs-base .ms-fcl-np-h:hover,.o365cs-base .ms-fcl-np-f:focus{    color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bgc-np,.o365cs-base .ms-bgc-np-h:hover,.o365cs-base .ms-bgc-np-f:focus{    background-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-bcl-np,.o365cs-base .ms-bcl-np-h:hover,.o365cs-base .ms-bcl-np-f:focus{    border-color: '[theme:neutralPrimary, default:#333333]';}\n.o365cs-base .ms-fcl-ns,.o365cs-base .ms-fcl-ns-h:hover,.o365cs-base .ms-fcl-ns-f:focus{    color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-ns.o365cs-nav-moduleLabel{    color: #666666;}\n.o365cs-base .ms-bgc-ns,.o365cs-base .ms-bgc-ns-h:hover,.o365cs-base .ms-bgc-ns-f:focus{    background-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-bcl-ns,.o365cs-base .ms-bcl-ns-h:hover,.o365cs-base .ms-bcl-ns-f:focus{    border-color: '[theme:neutralSecondary, default:#666666]';}\n.o365cs-base .ms-fcl-nsa,.o365cs-base .ms-fcl-nsa-h:hover,.o365cs-base .ms-fcl-nsa-f:focus{    color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bgc-nsa,.o365cs-base .ms-bgc-nsa-h:hover,.o365cs-base .ms-bgc-nsa-f:focus{    background-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-bcl-nsa,.o365cs-base .ms-bcl-nsa-h:hover,.o365cs-base .ms-bcl-nsa-f:focus{    border-color: '[theme:neutralSecondaryAlt, default:#767676]';}\n.o365cs-base .ms-fcl-nt,.o365cs-base .ms-fcl-nt-h:hover,.o365cs-base .ms-fcl-nt-f:focus{    color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bgc-nt,.o365cs-base .ms-bgc-nt-h:hover,.o365cs-base .ms-bgc-nt-f:focus{    background-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-bcl-nt,.o365cs-base .ms-bcl-nt-h:hover,.o365cs-base .ms-bcl-nt-f:focus{    border-color: '[theme:neutralTertiary, default:#a6a6a6]';}\n.o365cs-base .ms-fcl-nta,.o365cs-base .ms-fcl-nta-h:hover,.o365cs-base .ms-fcl-nta-f:focus{    color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bgc-nta,.o365cs-base .ms-bgc-nta-h:hover,.o365cs-base .ms-bgc-nta-f:focus{    background-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-bcl-nta,.o365cs-base .ms-bcl-nta-h:hover,.o365cs-base .ms-bcl-nta-f:focus{    border-color: '[theme:neutralTertiaryAlt, default:#c8c8c8]';}\n.o365cs-base .ms-fcl-nl,.o365cs-base .ms-fcl-nl-h:hover,.o365cs-base .ms-fcl-nl-f:focus{    color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bgc-nl,.o365cs-base .ms-bgc-nl-h:hover,.o365cs-base .ms-bgc-nl-f:focus{    background-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-bcl-nl,.o365cs-base .ms-bcl-nl-h:hover,.o365cs-base .ms-bcl-nl-f:focus{    border-color: '[theme:neutralLight, default:#eaeaea]';}\n.o365cs-base .ms-fcl-nlr,.o365cs-base .ms-fcl-nlr-h:hover,.o365cs-base .ms-fcl-nlr-f:focus{    color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bgc-nlr,.o365cs-base .ms-bgc-nlr-h:hover,.o365cs-base .ms-bgc-nlr-f:focus,.o365cs-base.ms-bgc-nlr{    background-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-bcl-nlr,.o365cs-base .ms-bcl-nlr-h:hover,.o365cs-base .ms-bcl-nlr-f:focus{    border-color: '[theme:neutralLighter, default:#f4f4f4]';}\n.o365cs-base .ms-fcl-nlra,.o365cs-base .ms-fcl-nlra-h:hover,.o365cs-base .ms-fcl-nlra-f:focus{    color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bgc-nlra,.o365cs-base .ms-bgc-nlra-h:hover,.o365cs-base .ms-bgc-nlra-f:focus,.o365cs-base.ms-bgc-nlra{    background-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .ms-bcl-nlra,.o365cs-base .ms-bcl-nlra-h:hover,.o365cs-base .ms-bcl-nlra-f:focus{    border-color: '[theme:neutralLighterAlt, default:#f8f8f8]';}\n.o365cs-base .o365cs-topnavLinkBackground-2{    background-color: transparent;}\n.o365cs-base .o365cs-topnavText,.o365cs-base .o365cs-topnavText:hover{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base .o365cs-appLauncherBackground{    background-color: '[theme:themeDarker, default:#104a7d]';}\n.o365cs-nav-header16 .o365cs-navMenuButton{    color: '[theme:white, default:#ffffff]';}\n.o365cs-base .o365cs-navMenuButton{    color: '[theme:suiteBarText, default:#ffffff]';}\n.o365cs-base.o365cs-topnavBGImage{    background-position: center top;    background-repeat: repeat-x;    background-image: none;}\n.o365cs-base.o365cs-topnavBGColor-2{    background-color: '[theme:suiteBarBackground, default:#000000]';}\n")}},3894:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(615),i="STS",s=[{registration:{id:i,swPrefetchManifestName:"stsserviceworkerprefetch"}},{registration:{id:"SPHome"}},{featureIds:[1966],registration:{id:"SitePages"}},{registration:{id:"Embed"}},{odc:!0,featureIds:["EnableODCServiceWorker"],registration:{id:"ODC"}},{featureIds:[60579],registration:{id:"CreateGroup"}}];function o(e){var t=r.n.isFeatureEnabled({ODC:!0}),n=s.filter(function(e){if(t===!e.odc)return!1;var n=!0;e.featureIds&&e.featureIds.forEach(function(e){n=n&&r.n.isFeatureEnabled(t?{ODC:e}:{ODB:e})});switch(e.registration.id){case i:return n&&!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/)}return n}).map(function(e){return e.registration}),o=JSON.stringify(n),u=!t&&r.n.isFeatureEnabled({ODB:1966})&&-1!==document.cookie.indexOf("SPClientSideFrameworkDevCookie-9076A2B0-2161-43C6-8BEA-9FECB7EA459B=");return(t?"/odc":"/_layouts/15/odsp")+"serviceworkerproxy.aspx?swManifestName="+(t?"odc":"sp")+"serviceworker&debug="+(u?"true":"false")+"&bypass="+(e?"true":"false")+"&applications="+encodeURIComponent(o)+(r.n.isFeatureEnabled({ODB:60448})?"&list=v2":"")}},3895:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(513);function i(){return Object(r.e)({data:{url:location.href,type:1}})}},3896:function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r;function i(){r||"function"!=typeof BroadcastChannel||(r=new BroadcastChannel("sw_broadcast"));return r}var s={OfflineNotification:"OfflineNotification",CheckOffline:"CheckOffline"}},4364:function(e,t,n){"use strict";n.r(t);n.d(t,"FileHoverCard",function(){return He});n.d(t,"CurrentFileHoverCard",function(){return Be});var r=n(0),i=n("react-lib"),s=n(3611),o=n(111),u=n(212),a=n(13),f=n(4),l=n(1186),c=n(29),h=n(500),p=n(1714),d=n(19),v=n(1064),m=n(356),g=n(28),y=n(179),b=n(44),w=n(3820),E=n(822),S=n(2774),x=n(831),T=n(1700),N=n(2067),C=n(1662),k=n(1705),L=n(2423),A=n(18),O=n(149),M=(function(){function e(e){this._engagementData={};this._engagement=e||O.e}Object.defineProperty(e.prototype,"engagementData",{set:function(e){this._engagementData=e},enumerable:!0,configurable:!0});e.prototype.logData=function(e,t){this._engagement.logData(Object(r.__assign)(Object(r.__assign)({name:e},this._engagementData),{extraData:Object(r.__assign)(Object(r.__assign)({},this._engagementData.extraData),t)}))};return e})(),_=i.createContext(new M),D=n(260),P=n(619),H={ODB:1588,OneDrive:!0},B={ODB:1883,OneDrive:!0},j={ODB:1020,OneDrive:!0},F={ODB:1015,OneDrive:!0},I=[P.u,P.n,P.s,".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf"];function q(){return D.e.isFeatureEnabled(B)}function R(){return D.e.isFeatureEnabled(F)}var U=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(e){n.context.logData("FileHoverCard.KeyPoints.Click");n.props.onKeyPointsClick&&n.props.onKeyPointsClick(e)};n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget;n.setState({showCallout:!0});n.context.logData("FileHoverCard.KeyPoints.ClickMoreIcon")};n.state={showCallout:!1};return n}t.prototype.render=function(){var e=this,t=L.ce,n=this.props.keyPointsData;return i.createElement("div",{className:"fileHoverCardInsideLook_2b6030ba",style:q()?{borderTop:0,paddingTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardInsideLookTitle_2b6030ba"},i.createElement("div",null,!q()&&L.le,i.createElement(T.e,{content:t,directionalHint:o.e.bottomCenter},i.createElement(x.e,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),this._ellipses()),this.state.showCallout&&i.createElement(k.e,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:Object(E.e)()?o.e.bottomLeftEdge:o.e.bottomRightEdge,items:[{key:"sendFeedback",name:L.q,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:L.h,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&i.createElement("div",{className:"fileHoverCardReadTimeContainer_2b6030ba",style:q()?{justifyContent:"space-between"}:{}},i.createElement("div",{className:"fileHoverCardReadTime_2b6030ba"},i.createElement(x.e,{className:"fileHoverCardReadTimeIcon_2b6030ba",iconName:"Clock","aria-describedby":t}),this._timeToReadMessage(n.readTime.minutes)),q()&&this._ellipses()),n&&n.keyPoints&&n.keyPoints.length>0&&(this.props.onKeyPointsClick?i.createElement(S.e,{className:"fileHoverCardKeyPointsButton_2b6030ba",onClick:this._onClick,styles:{flexContainer:{flexWrap:"wrap"}}},this._keyPointsContent(n)):i.createElement("div",{className:"fileHoverCardKeyPointsNonButton_2b6030ba"},this._keyPointsContent(n))))};t.prototype._keyPointsContent=function(e){return i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardKeyPointsAction_2b6030ba"},L.de),i.createElement(N.e,{renderCount:3,items:e.keyPoints,onRenderCell:this._onRenderCell,className:"fileHoverCardKeyPointsContent_2b6030ba"}))};t.prototype._onRenderCell=function(e){return e&&i.createElement("div",{className:"fileHoverCardKeyPointsCell_2b6030ba"},i.createElement("div",{className:"fileHoverCardKeyPointsBullet_2b6030ba"}),i.createElement("div",{dir:"auto",className:"fileHoverCardKeyPointsText_2b6030ba"},e.text))};t.prototype._ellipses=function(){return this.props.onSendFeedbackClick&&i.createElement(C.e,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:L.N,style:{marginTop:"2px"}})};t.prototype._timeToReadMessage=function(e){if(0===e)return L.De;if(e>60){var t=A.getLocalizedCountValue(L.Oe,L.Me,Math.floor(e/60));return t&&A.format(t,Math.floor(e/60))}return A.format(L._e,e)};return t})(i.Component);U.contextType=_;var z=n(1819),W=n(3041),X=n(887),V=n(1143),$=n(1607);function J(e){var t,n,r,i,s,o,u=e.lifeCycleSignalData,a=e.loginUserEmail,f=e.userEmail,l=e.createdBy,c=e.createdDateTime,h=e.onRenderLifeCycleSignal,p=u.signal;switch(u.key){case X.o:t=L.me;n="https://go.microsoft.com/fwlink/?linkid=862871";s=L.ve;break;case X.c:t=L.ze;r=e.onCheckIn;i=e.onDiscardCheckOut;s=e.onCheckIn?L.ie:void 0;o=e.onDiscardCheckOut?L.se:void 0;break;case X.f:t=u.title;break;case X.e:t=L.a;r=e.onViewPolicyTip;s=L.je;break;case X.u:t=L.ge;r=e.onAddMetadataNow;s=L.ee;break;case X.t:t=L.f;r=e.onViewPolicyTip;s=L.je;break;case X.l:t=u.title;break;case X.a:var d=c&&Object(V.t)(new Date(c));t=l&&l.email&&Object(W.e)(l.email,a,f)?A.format(L.Ue,d):A.format(L.we,d,l&&l.displayName);break;default:p=null}return(h?Object($.e)(h,K):K)({signal:p,content:t,action:r,actionName:s,secondaryAction:i,secondaryActionName:o,link:n})}function K(e){return e&&e.signal?i.createElement("div",{className:"fileHoverCardLifeCycle_7b573ea9"},e.signal,i.createElement("div",{className:"fileHoverCardLifeCycleMessage_7b573ea9"},e.content&&i.createElement("div",{className:"fileHoverCardLifeCycleTitle_7b573ea9"},e.content),(e.action||e.link)&&i.createElement(z.e,{className:"fileHoverCardLifeCycleAction_7b573ea9",href:e.link,target:e.link&&"_blank",onClick:e.action},e.actionName),e.secondaryAction&&" "+L._+" ",e.secondaryAction&&i.createElement(z.e,{className:"fileHoverCardLifeCycleAction_7b573ea9",onClick:e.secondaryAction},e.secondaryActionName))):null}var Q=n(2192),G=n(2414),Y=n(75),Z=n(3383),ee=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map(function(e){return e.email});t.props.onShareWith(e,n);Object(Z.e)("FileHoverCard.RecommendedActions.ShareWith",t.props.item)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,r=t.shareWith,s=this.props.shareWith&&this.props.shareWith.slice(0,2).map(function(e){return e.email});return r&&r.length>=2&&i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardShareWith_598162d9"},A.formatToArray(L.U,this._userNameJSX(r[0].displayName),this._userNameJSX(r[1].displayName))),this.props.onRenderShareWithPeople?i.createElement("div",{className:"fileHoverCardShareWithLink_598162d9"},this.props.onRenderShareWithPeople(s)):i.createElement(z.e,{className:"fileHoverCardShareWithLink_598162d9",onClick:this._handleClickShare},L.z),n&&n.map(function(t,n){return n<2&&i.createElement(Q.e,{key:n,activityIcon:i.createElement(x.e,{iconName:"Edit",className:"fileHoverCardRecommendedIcon_598162d9"}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})}))};t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=Object(W.e)(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?L.Re:e.actor.user.displayName;return i.createElement("div",{className:"fileHoverCardActivity_598162d9"},A.formatToArray(L.S,this._userNameJSX(n)))};t.prototype._userNameJSX=function(e){return i.createElement("div",{key:e,className:"fileHoverCardUserName_598162d9"},e)};return t})(i.Component),te=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._recommendedAction=function(e,t){var r=Object(V.t)(Object(G.t)(e.activityTimestamp)),s="",u="",a="";switch(e.recommendationEventType){case"Mentioned":s="Accounts";a=A.formatToArray(L.T,n._userNameJSX(e.actorDisplayName));u=L.H;break;case"Edited":s="Edit";a=L.p;u=L.M;var f=e.importantActorsAndActivities[0],l=f&&f.activityTimestamp;r=l&&Object(V.t)(Object(G.t)(l));var c=e.importantActorsAndActivities.map(function(e){return e.actorDisplayName});a=1===c.length?A.formatToArray(L.O,n._userNameJSX(c[0])):2===c.length?A.formatToArray(L.K,n._userNameJSX(c[0]),n._userNameJSX(c[1])):A.formatToArray(L.p,n._userNameJSX(c[0]),n._userNameJSX(c[1]),e.recentEditorCount-2);break;case"Commented":s="Chat";a=A.formatToArray(L.s,n._userNameJSX(e.actorDisplayName));u=L.Q}return i.createElement("div",{key:t},i.createElement("div",{className:"fileHoverCardRecommendedAction_598162d9"},i.createElement(Q.e,{activityIcon:i.createElement(x.e,{iconName:s,className:"fileHoverCardRecommendedIcon_598162d9"}),activityDescription:i.createElement("div",{className:"fileHoverCardRecommendedMessage_598162d9"},a),timeStamp:r}),i.createElement(T.e,{content:L.c,directionalHint:o.e.topCenter},i.createElement(C.e,{className:"fileHoverCardCancelIcon_598162d9",iconProps:{iconName:"Cancel"},onClick:function(){return n._handleClickDismiss(t)}}))),i.createElement(z.e,{className:"fileHoverCardRecommendedLink_598162d9",href:n._getNavLink(e.navigationId),target:"_blank",onClick:function(){n.context.logData("FileHoverCard.RecommendedActions."+e.recommendationEventType,{})}},u))};n._getNavLink=function(e){if(n.props.pageUrl&&e){var t=new Y.t(n.props.pageUrl);t.setQueryParameter("nav",e);t.setQueryParameter("commentId",e);return t.toString()}return n.props.pageUrl};n._recommendedActionRef=function(e){var t=n.state.recommendedActions;n.context.logData("FileHoverCard.RecommendedActions.Render",{activityType:t&&t.length>0?"HighActivities":"LowActivities"})};n.state={recommendedActions:n.props.actions.recommendedActions};return n}t.prototype.render=function(){var e=this.state.recommendedActions;return e&&e.length>0&&i.createElement("div",{ref:this._recommendedActionRef,className:"fileHoverCardRecommendedSection_598162d9",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardRecommendedTitle_598162d9"},L.D),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):i.createElement(ee,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))};t.prototype._userNameJSX=function(e){return i.createElement("span",{className:"fileHoverCardUserName_598162d9"},e)};t.prototype._handleClickDismiss=function(e){this.context.logData("FileHoverCard.RecommendedActions.Dismiss",{recommendedActionId:this.state.recommendedActions[e].recommendationId});this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e);this.state.recommendedActions.splice(e,1);this.setState({recommendedActions:this.state.recommendedActions})};return t})(i.Component);te.contextType=_;var ne=n(871),re=n(1422),ie=n(3485),se=n(383),oe=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._conversation=function(e,n){var r=t._context(e),s=e.deepLink,o=t._getIconName(e.conversationType),u=t._participants(e),a=e.referencePreview,f=Object(V.t)(new Date(e.activityTimestamp));return i.createElement("div",{key:n},i.createElement("div",{className:"fileHoverCardConversation_11349dc8",onClick:function(){var e=window.open(s,"_blank");e&&e.focus();t.context.logData("FileHoverCard.Conversations.ClickDeepLink",{})}},i.createElement(Q.e,{activityIcon:i.createElement(x.e,{iconName:o,className:"fileHoverCardConversationIcon_11349dc8"}),activityDescription:u,comments:i.createElement(i.Fragment,null,r,i.createElement("div",{className:"fileHoverCardConversationReferencePreview_11349dc8"},a)),timeStamp:f})))};return t}t.prototype.render=function(){var e=this.props.conversations;return i.createElement("div",{className:"fileHoverCardConversationsSection_11349dc8",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardConversationsTitle_11349dc8"},L.o),e.slice(0,3).map(this._conversation))};t.prototype._context=function(e){var t=e.context,n=i.createElement(i.Fragment,null),r="fileHoverCardConversationContext_11349dc8";if(e.conversationType===ie.e.CalendarEvent){t=A.format(L.x,e.context);n=i.createElement(x.e,{iconName:"Event",className:"fileHoverCardConversationsMeetingIcon_11349dc8"});r="fileHoverCardMeetingConversationContext_11349dc8"}var s=0===t.length?i.createElement(i.Fragment,null):i.createElement("div",{className:r},t);return i.createElement(i.Fragment,null,n,s)};t.prototype._participants=function(e){var t,n=this;t=e.participants.filter(function(t){return t.identity.displayName&&!n._isSharedByUser(t.identity.email,e.sharedByUserEmail,t.identity.displayName,e.sharedByUserDisplayName)}).map(function(e){return Object(W.e)(e.identity.email,n.props.loginUserEmail,n.props.userEmail)?L.Re:e.identity.displayName}).join(", ");var r=e.isSharedByMe?L.Re:e.sharedByUserDisplayName;return i.createElement("div",{className:"fileHoverCardConversationParticipants_11349dc8"},i.createElement("span",{className:"fileHoverCardConversationSharedByUser_11349dc8"},0===t.length?r:r+", "),t)};t.prototype._isSharedByUser=function(e,t,n,r){return e.toLowerCase()===t.toLowerCase()||n.toLowerCase()===r.toLowerCase()};t.prototype._getIconName=function(e){var t=e===ie.e.CalendarEvent||e===ie.e.Mail?Object(se.n)({extension:"",brand:"outlook"}):Object(se.n)({extension:"",brand:"teams"});if(t)return t.iconName};return t})(i.PureComponent);oe.contextType=_;var ue=n(152),ae=n(176),fe=n(1653),le=n(116),ce=n(31),he=n(7),pe=n(1686),de=n(168),ve=n(516);function me(e){return i.createElement("div",{className:"fileHoverCardRelatedFilesSection_048e12ce",style:q()?{borderTop:0}:{}},!q()&&i.createElement("div",{className:"fileHoverCardRelatedFilesTitle_048e12ce"},L.P),e.relatedFilesKeys.slice(0,3).map(function(e,t){return(function(e,t){return i.createElement(u.e,{key:t},function(n){var r,s=n.itemCache,o=s.demandItemFacet(f.h,e),u=(function(e){if(!e)return;var t=Object(pe.n)({extension:e,size:16});return t?t.iconName:void 0})(null===(r=o)||void 0===r?void 0:r.split(".")[1]),a=Object(de.r)(s,i.createElement(ve.e,{itemKey:e,engagement:{name:"FileHoverCard.RelatedFiles.ClickDeepLink"}}));return i.createElement(d.n,{action:a},function(e){var n=e.execute;return i.createElement("div",{key:"relatedFile_"+t},i.createElement("div",{className:"fileHoverCardRelatedFile_048e12ce",onClick:function(){n()}},i.createElement(Q.e,{activityIcon:i.createElement(x.e,{iconName:u,className:"fileHoverCardRelatedFileIcon_048e12ce"}),activityDescription:i.createElement(i.Fragment,null,i.createElement("div",{className:"fileHoverCardRelatedFilesName_048e12ce"},o)),isCompact:!0})))})})})(e,t)}))}function ge(e){var t=e.itemKey,n=i.useContext(_),s=i.useRef(null),o=Object(i.useState)(!1),a=o[0],c=o[1],h=Object(i.useState)(!0),m=h[0],E=h[1],S=Object(i.useState)(!1),N=S[0],C=S[1],k=Object(i.useState)(!0),A=k[0],M=k[1],P=Object(i.useState)(!1),H=P[0],B=P[1],F=Object(i.useState)(!0),I=F[0],U=F[1],z=Object(i.useState)(!1),W=z[0],V=z[1],$=Object(i.useState)(!0),K=$[0],Q=$[1],G=Object(i.useState)(!1),Y=G[0],Z=G[1],ee=Object(i.useState)(!0),te=ee[0],ie=ee[1];i.useEffect(function(){s.current&&e.onCardExpand(s.current.clientHeight)});function se(e,t,r,i,s,o){i(!r);if(s){n.logData(e,t);o(!1)}}return i.createElement(u.e,null,function(n){var o=n.itemCache,u=(function(e,t){var n,r=e.demandItemFacet(f.n,t),i=r&&r.itemKey,s=e.demandItemFacet(l.h,i),o=e.demandItemFacet(l.p,i),u=e.demandItemFacet(l.o,i),a=e.demandItemFacet(l.e,i),c=e.demandItemFacet(l.s,i),h=e.demandItemFacet(l.u,i),p=e.demandItemFacet(g.C,y.e),d=e.demandItemFacet(f.d,t),v=a&&a.filter(function(e){return void 0!==e.access}),m=e.demandItemFacet(l.l,i),b=e.demandItemFacet(l.n,i);if(R()){var w=e.demandItemFacet(f.H,t),E=e.demandItemFacet(he.e,w&&w.itemKey);n=E&&E.itemKeys}return{analyticsKey:r,itemAnalyticsKey:i,viewCount:s,viewerCount:o,isTrending:u,activities:a,incompleteData:c,keyPointsData:h,loginUser:p,itemName:d,viewActivities:v,actions:m,conversations:b,relatedItemKeys:n}})(o,t),h=u.itemAnalyticsKey,S=u.viewCount,k=u.viewerCount,_=u.isTrending,P=u.incompleteData,F=u.keyPointsData,z=u.loginUser,$=u.itemName,G=u.viewActivities,ee=u.actions,pe=u.conversations,de=u.relatedItemKeys,ve=Object(X.r)(o,t,2,!0),ge=o.isItemFacetResolved(l.u,h)&&o.isItemFacetResolved(l.l,h)&&o.isItemFacetResolved(l.n,h)&&(!R()||o.isItemFacetResolved(f.H,t)),Ne=o.isItemFacetResolved(ue.e,h),Ce=ye(F),ke=$&&t&&be($.extension,ee),Le=we(pe),Ae=Ee(G),Oe=Se(de),Me={keyPoints:Ce,recommendedActions:!!ke,conversations:Le,viewers:!!Ae,relatedFiles:Oe};if(ge||Ne)return i.createElement("div",{ref:s,className:Object(b.e)("fileHoverCardExpandedCard_2526b7ce",{isFluent:!0})},!!(z&&t&&h)&&ve.map(function(e){return(function(e,t,n,s,o){var u,a=Object(r.__assign)({},v.e.pack(function(){return{itemKeys:[n]}})),c=o.demandItemFacet(ne.e,n),h=ne.e.evaluate(c)(o,{itemKey:n}),m=h.checkInAction,g=h.undoCheckOutAction,y=h.policyTipAction,b=h.addMetadataAction,w={checkIn:m,undoCheckOut:g,viewPolicyTip:y,addMetadata:b},E=o.demandItemFacet(l.r,s),S=o.demandItemFacet(l.i,s);if(E){var x=o.demandItem({displayName:f.h,email:ae.e,image:ae.r,id:ae.i},E.itemKey);u={email:x.email||"",displayName:x.displayName||"",image:x.image||"",id:x.id||""}}var T=o.demandItemFacet(re.e,n),N=re.e.evaluate(T)(o,{itemKey:n,signalData:e}).onRenderLifeCycleSignal,C=Object(le.n)(o).telemetry,k=Object(ce.n)(o,{itemKey:n,engagement:{isIntentional:!0}});return i.createElement(p.e,{controlHandlers:a},i.createElement(d.r,{actions:w},function(n){var s=n.actions,o=s.checkIn,a=s.undoCheckOut,f=s.viewPolicyTip,l=s.addMetadata;return i.createElement(J,{lifeCycleSignalData:e,createdBy:u,createdDateTime:S,loginUserEmail:t.userLoginName,userEmail:t.userEmail,onViewPolicyTip:function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.ViewPolicyTip"},k));f&&f.execute()},onAddMetadataNow:function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.AddMetadata"},k));l&&l.execute()},onCheckIn:o&&o.isAvailable?function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.FileCheckIn"},k));o&&o.execute()}:void 0,onDiscardCheckOut:a&&a.isAvailable?function(){C(O.e).logData(Object(r.__assign)({name:"FileHoverCard.LifeCycle.DiscardCheckOut"},k));a&&a.execute()}:void 0,onRenderLifeCycleSignal:N})}))})(e,z,t,h,o)}),i.createElement("div",{className:"fileHoverCardExpandedCardScrollableSection_2526b7ce"},q()&&i.createElement("div",{className:"collapsedFileCardTooltip_2526b7ce"},i.createElement(T.e,{content:L.i},i.createElement(x.e,{iconName:"info"}))),!!(Ce&&F&&t)&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.le,menuIconProps:{iconName:a?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.KeyPointsExpanded",Me,a,c,m,E)}}),a&&xe(o,{keyPointsData:F,itemKey:t})):xe(o,{keyPointsData:F,itemKey:t})),ke&&h&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.D,menuIconProps:{iconName:N?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.RecommendedActionsExpanded",Me,N,C,A,M)}}),N&&Te(o,{target:e.target,itemKey:t,itemAnalyticsKey:h})):Te(o,{target:e.target,itemKey:t,itemAnalyticsKey:h})),D.e.isFeatureEnabled(j)&&de&&Oe&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||Oe?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.P,menuIconProps:{iconName:Y?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.RelatedFilesExpanded",Me,Y,Z,te,ie)}}),Y&&i.createElement(me,{relatedFilesKeys:de,itemKey:t})):i.createElement(me,{relatedFilesKeys:de,itemKey:t})),pe&&z&&Le&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||ke?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.o,menuIconProps:{iconName:H?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.ConversationsExpanded",Me,H,B,I,U)}}),H&&i.createElement(oe,{conversations:pe,loginUserEmail:z.userLoginName,userEmail:z.userEmail})):i.createElement(oe,{conversations:pe,loginUserEmail:z.userLoginName,userEmail:z.userEmail})),!(!Ae||!z)&&(q()?i.createElement("div",{className:"fileCardExpandSectionContainer_2526b7ce",style:Ce||ke||Le?{}:{border:0}},i.createElement(fe.e,{className:"fileCardExpandSectionButton_2526b7ce",text:L.Ie,menuIconProps:{iconName:W?"ChevronUp":"ChevronDown"},onClick:function(){return se("FileHoverCard.ViewersExpanded",Me,W,V,K,Q)}}),W&&i.createElement("div",{className:"fileHoverCardActivitiesSection_2526b7ce",style:{borderTop:0}},i.createElement(w.e,{itemAnalytics:{activities:G||[],viewCount:S,viewerCount:k,isTrending:_,incompleteData:P},loginUserEmail:z.userLoginName,userEmail:z.userEmail}))):i.createElement("div",{className:"fileHoverCardActivitiesSection_2526b7ce"},i.createElement(w.e,{itemAnalytics:{activities:G||[],viewCount:S,viewerCount:k,isTrending:_,incompleteData:P},loginUserEmail:z.userLoginName,userEmail:z.userEmail})))))})}function ye(e){var t=e&&e.readTime&&e.readTime.minutes;return!!(e&&e.keyPoints&&e.keyPoints.length>0)||!!t}function be(e,t){return Boolean(t&&t.length>0)&&(function(e,t){var n=e||t;return!!n&&I.indexOf(n)>-1})(void 0,e)}function we(e){return Boolean(e&&e.length>0)}function Ee(e){return Boolean(e&&e.length>=1)}function Se(e){return Boolean(e&&e.length>0)}function xe(e,t){var n=t.keyPointsData,r=t.itemKey,s=e.demandItemFacet(ne.e,r),o=ne.e.evaluate(s)(e,{itemKey:r}),u={showKeyPoints:o.showKeyPointsPane,showFeedback:o.showFeedbackPane};return i.createElement(d.r,{actions:u},function(e){var t=e.actions,r=t.showKeyPoints,s=t.showFeedback,o=r&&r.isAvailable?r.execute:void 0,u=s&&s.isAvailable?s.execute:void 0;return i.createElement(U,{keyPointsData:n,onKeyPointsClick:o,onSendFeedbackClick:u})})}function Te(e,t){var n=t.target,r=t.itemKey,s=t.itemAnalyticsKey,o=e.demandItemFacet(l.l,s),u=[],a=e.demandItemFacet(f.O,r),c=e.demandItemFacet(l.e,s),v=e.demandItemFacet(g.C,y.e),b=c&&c.filter(function(e){return void 0!==e.edit}),w=e.demandItemFacet(ne.e,r),E=ne.e.evaluate(w)(e,{itemKey:r}).onDismiss;return i.createElement(p.e,{controlHandlers:m.e.pack(function(){return{defaultRecipients:u?u.map(function(e){return e.email}):[]}})},i.createElement(d.n,{action:i.createElement(h.ItemShareAction,{itemKeys:[r]})},function(e){var t=e.execute;return o&&E&&i.createElement(te,{actions:{recommendedActions:o,shareWith:u,editActivities:b},loginUserEmail:v&&v.userLoginName,userEmail:v&&v.userEmail,pageUrl:a,onDismiss:E,onShareWith:function(e,r){e.target=n;e.persist();t({event:e})}})}))}var Ne=n(1340),Ce=n(1112),ke=n(3642);function Le(e){var t=e.itemKey,n=i.useRef(null);i.useEffect(function(){n.current&&e.updateCardHeight(n.current.clientHeight)});return i.createElement(u.e,null,function(s){var o,u=s.itemCache,a=u.demandItemFacet(f.d,t),c=a&&a.name,m=a&&a.extension,g=u.demandItemFacet(f.n,t),y=g&&g.itemKey,w=i.createElement("div",{className:Object(b.e)("fileHoverCardCompactCardTitle_2526b7ce",(o={},o.titleNotExpanded_2526b7ce=!n.current,o)),id:"ms-FileHoverCard-title","aria-label":A.format(L.ue,c)},c),E=i.createElement("div",{className:"fileHoverCardCompactCardTitleRegion_2526b7ce"},i.createElement(Ce.e,{className:"fileHoverCardCompactCardFileIcon_2526b7ce",extension:m,size:32}),w);return i.createElement("div",{ref:n,className:Object(b.e)("fileHoverCardCompactCard_2526b7ce",{isFluent:!0})},E,!(!t||!y)&&(function(e,t,n,s){var o=e.demandItemFacet(l.h,n),u=e.demandItemFacet(l.p,n),a=e.demandItemFacet(l.f,n),c=e.demandItemFacet(l.t,n),m=e.demandItemFacet(f.O,t),g=e.demandItemFacet(l.e,n),y=g&&g.filter(function(e){return void 0!==e.access}),b=Object(le.n)(e).telemetry,w=Object(ce.n)(e,{itemKey:t,engagement:{isIntentional:!0}}),E=e.isItemFacetResolved(l.h,n)||e.isItemFacetResolved(ue.e,n)?{activities:y||[],viewCount:o,viewerCount:u,likeCount:a,commentCount:c}:void 0,S=e.demandItemFacet(ne.e,t),x=ne.e.evaluate(S)(e,{itemKey:t}),T=x.showDetailsPane,N=x.showFileAnalytics,C={showDetails:T,showItemAnalytics:N,shareAction:i.createElement(h.ItemShareAction,{itemKeys:[t]})},k=Object(r.__assign)({},v.e.pack(function(){return{itemKeys:[t]}}));return i.createElement(p.e,{controlHandlers:k},i.createElement(d.r,{actions:C},function(e){var n=e.actions,o=n.showDetails,u=n.showItemAnalytics,a=n.shareAction,f=o&&o.execute?function(){b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.SeeDetailsClick"},w));o.execute().catch(function(){})}:void 0,l=u&&u.execute?function(){b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.ViewCountClick"},w));u.execute().catch(function(){})}:void 0,c=a&&a.isAvailable?function(e){if(e&&s){e.target=s;e.persist();a.execute({event:e});b(O.e).logData(Object(r.__assign)({name:"FileHoverCard.CommandBar.ShareClick"},w))}}:void 0,h=Object(r.__spreadArrays)(o&&o.isAvailable?[{key:"details",title:L.Ne,name:L.Ne,ariaLabel:L.Ne,onClick:f}]:[]),p={key:"share",iconProps:{iconName:"share"},title:L.R,onClick:c},d={itemAnalytics:E,isCompact:!0,isLink:u&&u.isAvailable,pageUrl:m,onClick:l,itemKey:t},v=[];c&&v.push(p);D.e.isFeatureEnabled(H)&&Ne.e.action&&Ne.e.onClick&&v.unshift(Object(r.__assign)(Object(r.__assign)({},Ne.e),{iconOnly:!0,name:void 0}));return i.createElement(ke.e,{itemKey:t,analyticsStats:d,items:v,withFacePile:!0,farItems:h})}))})(u,t,y,e.target))})}var Ae=n(41),Oe=n(119),Me=n(1587),_e=n(481),De=n(42),Pe=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._dynamicCompactCardHeight=function(e){n.state.compactCardHeight!==e&&n.setState({compactCardHeight:e})};n._dynamicExpandedCardHeight=function(e){var t=n.state.expandedCardHeight;e&&t!==e&&n.setState({expandedCardHeight:e})};n.state={visible:!1,expandedCardHeight:1,compactCardHeight:131};n._isFirstTimeOpenCard=!0;return n}t.prototype.componentDidCatch=function(e,t){this._hoverCardRenderQos&&this._hoverCardRenderQos.end({error:e.name+"_"+e.message,extraData:{stack:e.stack,errorInfo:JSON.stringify(t)},resultCode:e.name,resultType:Ae.e.Failure})};t.prototype.render=function(){var e=this,t=this.props,n=t.itemKey,a=t.cardDismissDelay,f=void 0===a?300:a,h=t.directionalHint,p=void 0===h?o.e.rightTopEdge:h,d=t.gapSpace,v=void 0===d?8:d,m=t.target;if(!n||!m)return null;var g,y,b,w,E,S={expandedCardScroll:"fileHoverCardExpandedCardHostScroll_2526b7ce"},x=Object(r.__assign)({root:{boxShadow:Object(c.O)().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},S),T=new M(this.props.telemetry(O.e));return i.createElement(u.e,null,function(t){var r=t.itemCache;if(e.state.visible){var o=e._demandFacets(r),u=o.itemAnalyticsKey,a=o.keyPointsData,c=o.itemName,h=o.recommendedActions,d=o.conversations,S=o.viewActivities,N=o.relatedItemKeys,C=r.isItemFacetResolved(l.h,u),k=r.isItemFacetResolved(ue.e,u),L=k?r.demandItemFacet(ue.e,u):void 0;e._errorMessage=L&&L.message;e._isViewCountDataError=k&&!C;g=ye(a);y=!!c&&be(c.extension,h);b=we(d);w=Ee(S);E=Se(N);if(r.demandItemFacet(ue.e,n,{suppressGetItems:!0}))return null}var A=Object(ce.n)(r,{itemKey:n,engagement:{isIntentional:!0}});T.engagementData=A;var O={onRenderCompactCard:function(){return i.createElement(Le,{itemKey:n,target:m,updateCardHeight:e._dynamicCompactCardHeight})},onRenderExpandedCard:function(){return i.createElement(ge,{itemKey:n,target:m,onCardExpand:function(t){return e._onCardExpand(t,A)}})},compactCardHeight:e.state.compactCardHeight,expandedCardHeight:e.state.expandedCardHeight,directionalHint:p,directionalHintFixed:!1,gapSpace:v,styles:x};return i.createElement(le.e,{withContext:{component:"FileHoverCard"}},i.createElement(_.Provider,{value:T},i.createElement(s.e,{expandingCardProps:O,cardDismissDelay:f,expandedCardOpenDelay:500,target:e.props.target,onCardVisible:function(){return e._onCardOpen(A)},onCardHide:function(){return e._onCardHide(A,g,y,b,w,E)},trapFocus:!0})))})};t.prototype._demandFacets=function(e){var t,n=e.demandItemFacet(f.n,this.props.itemKey),r=n&&n.itemKey,i=e.demandItemFacet(l.u,r),s=e.demandItemFacet(f.d,this.props.itemKey),o=e.demandItemFacet(l.l,r),u=e.demandItemFacet(l.n,r),a=e.demandItemFacet(l.e,r),c=a&&a.filter(function(e){return void 0!==e.access});if(R()){var h=e.demandItemFacet(f.H,this.props.itemKey),p=e.demandItemFacet(he.e,h&&h.itemKey);t=p&&p.itemKeys}return{analyticsKey:n,itemAnalyticsKey:r,keyPointsData:i,itemName:s,recommendedActions:o,conversations:u,activities:a,viewActivities:c,relatedItemKeys:t}};t.prototype._onCardOpen=function(e){var t=this,n=this.props.itemCacheDispatch;n(Object(Me.e)(function(e){return t._demandFacets(e)},{flushOperationQueue:!0}));n(Object(_e.e)());this.props.telemetry(O.e).logData(Object(r.__assign)({name:"FileHoverCard.CompactCardOpen"},e));this._cardOpenTimeStamp=Date.now();this.setState({visible:!0});this._isFirstTimeOpenCard&&(this._hoverCardRenderQos=new(this.props.telemetry(Oe.e))({name:"ItemScope_FileHoverCardRender"}))};t.prototype._onCardHide=function(e,t,n,i,s,o){var u=Date.now()-this._cardOpenTimeStamp,a=this.state.expandedCardHeight>1,f=a&&u>2500?"FileHoverCard.DwellTimeLong":"FileHoverCard.DwellTime";this.props.telemetry(O.e).logData(Object(r.__assign)(Object(r.__assign)({name:f},e),{extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData),{time:u,compactCardOpen:1===this.state.expandedCardHeight,expandedCardOpen:a,keyPoints:t,recommendedActions:n,conversations:i,viewers:s,relatedFiles:o})}));if(this._isFirstTimeOpenCard){this._hoverCardRenderQos.end({resultType:Ae.e.Success});this._isFirstTimeOpenCard=!1}this.setState({visible:!1})};t.prototype._onCardExpand=function(e,t){this._dynamicExpandedCardHeight(e);if(!this._isCardExpanded&&e>1){this.props.telemetry(O.e).logData(Object(r.__assign)({name:"FileHoverCard.ExpandedCardOpen"},t));this._isCardExpanded=!0}if(this._isFirstTimeOpenCard){this._isViewCountDataError?this._hoverCardRenderQos.end({resultType:Ae.e.Failure,resultCode:"NoViewCount",error:this._errorMessage}):this._hoverCardRenderQos.end({resultType:Ae.e.Success});this._isFirstTimeOpenCard=!1}};t.defaultProps={itemKey:""};return t})(i.Component),He=Object(De.e)()(Object(le.i)()(Pe)),Be=Object(a.e)()(He)}}]);