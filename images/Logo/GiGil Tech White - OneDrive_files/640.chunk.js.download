(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[640],{1143:function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"i",function(){return N});n.d(t,"s",function(){return k});n.d(t,"e",function(){return L});n.d(t,"n",function(){return A});n.d(t,"o",function(){return O});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(624),v=n(2052),m=n(403),g=n(18),y=n(260),b=n(350),w=n(305),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.e.language),t)}function T(e,t,n,r,i,s){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var o=Date.now()-e.getTime(),u=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),a=H(u,-1),f=H(u,-6),l=i||{},c=l.displayMinutesToOneHour,h=void 0===c||c,p=l.displayHoursToOneDay,g=void 0===p||p,y=l.displayHoursInDates,E=void 0===y||y,S=l.displayShortenedWeekday,x=void 0===S||S,T=M(s||m.e.language);if(h&&o<-5*w.n)return e.toLocaleDateString(T,j({month:"short",day:"numeric"},r));if(o<w.o)return n?v.n:v.t;if(h&&o<w.t)return B(o,v.i,w.n);if(w.l(u,e))return g?B(o,v.r,w.t):b.t("Today",n);if(e>=a)return t||!E?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r)));if(e>=f){var N=e.toLocaleDateString(T,j({weekday:"short"},r));return t?N:x||E?d.RelativeDateTime_DayAndTime.replace("{0}",N).replace("{1}",e.toLocaleTimeString(T,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(T,j({weekday:"long"},r))}return w.c(u,e)?T.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(T,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(T,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.e.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e,n,r)}function O(e,t){return w.p(e,M(m.e.language),t)}function M(e){if(void 0===E)try{E=y.e.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.e.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},1832:function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"i",function(){return h});n.d(t,"r",function(){return p});n.d(t,"e",function(){return v});var r=n(0),i=n(10),s=n(147),o=n(194),u=n(175),a=n(1840),f=n(263),l="@ms/odsp-shared/lib/base/BaseModel",c=new i.t({name:l+".asyncType",factory:new i.e(u.e)}),h=new i.t({name:l+".observablesFactoryType",factory:new s.r(a.e,{asyncType:c.optional})}),p=new i.t({name:l+".eventGroupType",factory:new i.e(o.t)}),d=new i.t({name:l+".errorHandler"}),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.id,s=void 0===i?"":i;r.id=s;r._BaseModel_dependencies=n;return r}Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!0,configurable:!0});t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})};t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)};t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)};t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)};t.prototype.addDisposable=function(e){return this.scope.attach(e)};t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.wrapObservable=function(e){return this.observables.wrap(e)};t.prototype.peekUnwrapObservable=function(e){return Object(a.r)(e)};t.prototype.createObservable=function(e){return this.observables.create(e)};t.prototype.unwrapObservable=function(e){return Object(a.i)(e)};t.prototype.isObservable=function(e){return Object(a.n)(e)};t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getAsync=function(){return e};return e};t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getEvents=function(){return e};return e};t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});this._BaseModel_getObservables=function(){return e};return e};t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(c.optional)||u.e};t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.t};t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(h.optional)||Object(i.i)(a.e,{asyncType:this._BaseModel_getAsyncType()}))||a.e};t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(d.optional)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.e.dependencies),{asyncType:c.optional,observablesFactoryType:h.optional,eventGroupType:p.optional,errorHandler:d.optional});return t})(f.e);t.n=v},1839:function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});function r(e,t){return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;for(var n in e)if(e[n]!==t[n])return!1;for(var n in t)if(e[n]!==t[n])return!1;return!0}function s(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}},1840:function(e,t,n){"use strict";n.d(t,"r",function(){return l});n.d(t,"i",function(){return c});n.d(t,"n",function(){return h});n.d(t,"t",function(){return p});var r=n(0),i=(n(1852),n(83)),s=n("knockout-lib");s.onError=function(e){i.e.log(e)};var o=n(486),u=n(175),a=n(1839),f=n(164);function l(e){return h(e)?e.peek():e}function c(e){return s.unwrap(e)}function h(e){return s.isObservable(e)}function p(e){return{defaultValue:e,reducer:function(e,t){return t}}}var d=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});this._owner=e.owner;this._asyncType=t.asyncType}Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!0,configurable:!0});e.prototype.subscribe=function(e,t,n){var r,i=(void 0===n?{}:n).isBeforeChange;void 0!==i&&i&&(r="beforeChange");return this.scope.attach(e.subscribe(t,this._owner,r))};e.prototype.create=function(e){return s.observable(e)};e.prototype.createArray=function(e){return s.observableArray(e)};e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,s=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return s(e,c(t))},c(i))});o.equalityComparer=a.n;return Object(f.e)(o,{register:function(e){var i,s=""+ ++t;n(Object(r.__assign)(Object(r.__assign)({},n.peek()),((i={})[s]=e,i)));return{dispose:function(){var e=n.peek(),t=s,i=(e[t],Object(r.__rest)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})};e.prototype.compute=function(e,t){var n=this,r={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i=(function(e){return"object"==typeof e})(e)?e:{read:e},o=s.utils.extend(r,i);t&&s.utils.extend(o,t);var u=s.computed(o);return this.scope.attach(u)};e.prototype.pureCompute=function(e,t){var n={pure:!0};t&&s.utils.extend(n,t);return this.compute(e,n)};e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};t&&s.utils.extend(n,t);return this._setupBackgroundTask(this.compute(e,n))};e.prototype.wrap=function(e){return h(e)?e:this.create(e)};e.prototype.peekUnwrap=function(e){return h(e)?e.peek():e};e.prototype.unwrap=function(e){return c(e)};e.prototype.isObservable=function(e){return h(e)};e.prototype.ignore=function(e){return(function(e){return s.ignoreDependencies(e)})(e)};e.prototype.dispose=function(){this._scope&&this._scope.dispose()};e.prototype._setupBackgroundTask=function(e){var t=this;this._backgroundTasks||(this._backgroundTasks=[]);this._backgroundTasks.push(e);this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()}));return e};e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId;delete this._backgroundTasks};e.prototype._getAsync=function(){var e=this._asyncType||u.e,t=this.scope.attach(new e(this));this._getAsync=function(){return t};return t};return e})();t.e=d},1844:function(e,t,n){"use strict";var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t,n){return e.call(this,t,n)||this}return t})(n(2050).e);t.e=i},1852:function(e,t,n){"use strict";n("knockout-projections-lib")},1872:function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},1911:function(e,t,n){"use strict";var r=n(841);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},1948:function(e,t,n){"use strict";n.d(t,"f",function(){return b});n.d(t,"l",function(){return E});n.d(t,"r",function(){return x});n.d(t,"i",function(){return T});n.d(t,"t",function(){return k});n.d(t,"a",function(){return L});n.d(t,"o",function(){return A});n.d(t,"u",function(){return O});var r,i,s,o,u,a=n(619),f=n(1844),l=n(128);n.d(t,"e",function(){return a.t});n.d(t,"n",function(){return a.n});n.d(t,"s",function(){return a.r});n.d(t,"c",function(){return a.s});n.d(t,"h",function(){return a.o});n.d(t,"p",function(){return a.u});var c="ms-word",h="onenote|UsePlain",p="ms-powerpoint",d="ms-excel",v="ms-visio",m="ms-publisher",g="ms-project",y=((r={})[c]=l.OpenInWordOnline,r[h]=l.OpenInOneNoteOnline,r[p]=l.OpenInPowerPointOnline,r[d]=l.OpenInExcelOnline,r[v]=l.OpenInVisioOnline,r);function b(e){return y[e]||""}var w=((i={})[c]=l.OpenInWord,i[h]=l.OpenInOneNote,i[p]=l.OpenInPowerPoint,i[d]=l.OpenInExcel,i[v]=l.OpenInVisio,i[m]=l.OpenInPublisher,i[g]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function E(e){return w[e]}var S=((s={})[c]="Word",s[h]="OneNote",s[p]="PowerPoint",s[g]="Project",s[v]="Visio",s[d]="Excel",s);function x(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":S[e.appMap]||"Word"}function T(e){return S[e]}var N=((o={})[c]="WordLogo",o[h]="OneNoteLogo",o[p]="PowerPointLogo",o[d]="ExcelLogo",o[v]="VisioLogo",o[m]="Page",o),C=((u={})[c]="svg/word_16x1.svg",u[h]="svg/onenote_16x1.svg",u[p]="svg/powerpoint_16x1.svg",u[d]="svg/excel_16x1.svg",u[v]="svg/visio_16x1.svg",u[m]="Page",u),k={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function L(e){var t=N[e];return t&&new f.e(t)}function A(e){var t=C[e];return t&&new f.e(t)}function O(e){var t=a.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}},1952:function(e,t,n){"use strict";var r;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(r||(r={}));t.e=r},1997:function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return o});n.d(t,"n",function(){return u});var r,i=n(153),s=n(1148);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function o(e,t){var n;switch(e.size){case r.Large:n=3;break;case r.Medium:n=2;break;default:n=1}return Object(s.getUserPhotoUrl)(e.userLoginName,n,t)}function u(e,t,n){var r=Object(s.getUserPhotoUrl)(t,void 0,n);if(!e||!r||0===r.indexOf("http"))return r;try{return new i.e(e).authority+r}catch(e){return r}}},2050:function(e,t,n){"use strict";var r=n(1170),i=(function(){function e(e,t){this.value=e;this.extraClasses=t}e.prototype.getClass=function(){var e=this.value?Object(r.e)(this.value):void 0;0;return"ms-Icon ms-Icon--"+this.value+" "+(e||"")+(this.extraClasses?" "+this.extraClasses:"")};e.prototype.getExtraClasses=function(){return this.extraClasses};e.prototype.toString=function(){return this.value};return e})();t.e=i},2051:function(e,t,n){"use strict";var r,i=n(260),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},2284:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(r||(r={}));t.t=r},2317:function(e,t,n){"use strict";n.r(t);n.d(t,"previewImageUrl",function(){return i});n.d(t,"previewImageUrlFromProps",function(){return s});n.d(t,"previewImageUrlFromUrl",function(){return o});var r=n(1911);function i(e,t,n,r){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,u=e.WebId||e.webId||n.webId,a=e.UniqueId||e.UniqueID||e.uniqueId,f=e.Url||e.url||e.Path;return a&&i&&u&&!r?s(i,u,a,t,n):o(f,t,n)}}function s(e,t,n,r,i){if(i.isSPO){var s;n&&(s=u(function(s){var o=s?"":"&resolution=Width1024";return r+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o}));return s}}function o(e,t,n){if(n.isSPO){var r;e&&(r=u(function(r){var i=r?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i}));return r}}function u(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===r.t.name),width:0,height:0}}}}},2356:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},2438:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"n",function(){return f});n.d(t,"i",function(){return l});n.d(t,"s",function(){return c});var r=n(2018),i=n(1997),s=n(18);function o(e){return e?s.format(r.O,e):""}function u(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function a(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.t)({userLoginName:t.email})}}function f(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function l(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}function c(e){return e&&"0x0120"===e.slice(0,6)}},2587:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(10),i=n(147),s=new r.t({name:"ShortcutLinkDataSource.key",loader:new i.t(function(){return n.ee([562],2775).then(function(e){return e.resourceKey})})})},2590:function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function s(e){return!!e&&i[e.toLowerCase()]}function o(e){return r.indexOf(e)>=0}},2913:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(10).t)("vroom.dataContext")},3080:function(e,t,n){"use strict";n.d(t,"e",function(){return Q});var r=n(0),i=n(1832),s=n(721),o=n(2317),u=n(26),a=n(75),f=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],l=n(836),c=n(446),h=n(1952),p=n(10),d=n(147),v=new p.t({name:"ListItemTrendingStatusProcessor.key",loader:new d.t(function(){return n.ee([547],4494).then(function(e){return e.resourceKey})})}),m=n(210),g=n(1143),y=n(1130),b=n(2587),w=n(2051),E=n(2284),S=n(32),x=n(1948),T=n(2438),N=n(78),C=n(81),k=n(16),L=n(82),A=n(2590),O=n(54),M=n(2913),_=n(110),D=n(1872),P=n(1146),H=n(299),B=n(1193),j=n(633),F=n(164),I=n(1791),q=n(1171),R=n(83),U=n(1192),z=n(2356);function W(e){var t={};t.isCommentDisabled=(function(e){if(void 0===e||null==e)return!0;return(1&e)>0})(e);return t}var X=n(30),V=n(1057),$=!n(14).e.isActivated("D37CEDFE-59E8-4BE8-BC71-8553A7CA6D58","11/12/2021","Use pageContext corresponding to item to contruct getpreview thumbnail urls"),J=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._listContext=n.listContext;r._navigation=n.navigation;r._microServiceDataSource=n.microServiceDataSource;r._vroomUrlHelper=n.vroomUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._vroomDataContext=n.vroomDataContext;r._shortcutLinkDataSource=n.shortcutLinkDataSource;r._allowWrsVisio=!1;r._htmlDecodeDiv=document.createElement("textarea");return r}t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){R.e.log(e,"ListItemBuilder.getItemResult");throw e}};t.prototype._getItemResult=function(e){var t,n,i,f,p,d=e.itemFromServer;if(!d)return null;var b,L=e.microServiceDataSource||this._microServiceDataSource,O=this._urlDataSource,M=e.requestKey,_=e.parentItemKey,H=e.queryType,B=void 0===H?O.getQueryType():H,j=e.groupBy,R=e.itemGroups,U=e.contentTypes,V=e.supportsNestedGroups,$=e.isItemDataOnly,J=e.listTemplateType,Q=void 0===J?this._listContext.listTemplateType:J,G=e.observer,Y=e.isMetaDataSearch,Z=O.getKeyParams(M),ee=this._itemUrlHelper.getUrlParts({path:d.id||d.FileRef||d.ServerRelativeUrl,listUrl:Z.listurl});b=((t={}).id=ee.serverRelativeItemUrl,t.listurl=ee.normalizedListUrl,t);var te=d.File_x0020_Type,ne=te?"."+te:"",re=this._parseMediaServiceMetadata(d.MediaServiceFastMetadata),ie=this._parseMediaServiceMetadata(d.MediaServiceMetadata),se=this._getItemType({itemFromServer:d,listTemplateType:Q,microServiceDataSource:L,mediaServiceFastMetadata:re});if(se===m.e.Folder){var oe=Z.id===b.id,ue=O.getItemTypeFilter(Z),ae={};if(oe)ae=((n={}).view=Z.view,n.q=Z.q,n.typeFilters=Z.typeFilters,n);else{B!==u.e.Search&&(ae=((i={}).view=B,i));ue&&F.e(ae,O.saveItemTypeFilter(ue))}F.e(b,ae);Y&&F.e(b,((f={}).searchid=Z.searchid,f))}var fe=O.getKey(b),le={key:fe,extension:ne},ce=d.id||d.FileRef;le.id=ce;var he,pe,de=E.t.fromHexString(d.PermMask),ve=X.e.hasPermission(de,X.e.openItems),me=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!ve,ge=d[".spItemUrl"];if(ge){var ye=this._vroomUrlHelper.getUrlParts(ge);he=ye.itemId;pe=ye.driveId}else he=d["name.FileSystemItemId"]||(d.isRootFolder?"root":void 0);this._vroomDataContext&&he&&this._vroomDataContext.setFileSystemIdMapping(he,ce);var be=d[".etag"];be&&(le.eTag=be);le.itemId=P.optional(he);var we=Q===k.t.mySiteDocumentLibrary;le.graph=P.optional(he&&{itemId:he,driveId:pe,driveType:Q?we?"business":"documentLibrary":void 0});var Ee=Number(d._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(Ee=Number(d.ID)%6);le.policyTip=P.optional(Ee);var Se=Object(A.t)(ne);(Se||".ai"===ne||".eps"===ne||".psd"===ne)&&L.getThumbnail({fileExtension:ne,item:d,itemKey:fe,mediaServiceMetadata:re})&&(se=m.e.Media);if(z.t(ne))le.htmlConversion={};else if(z.e(ne)){if(xe=L.getHtmlConversionUrl({fileExtension:ne,item:d,mediaServiceMetadata:re})){se=m.e.Media;le.htmlConversion={url:xe+"&inlineImages=true"}}}if(Object(S.isFeatureEnabled)(S.EnableZipFilePreviewing)&&(".zip"===ne||".rar"===ne)){var xe=L.getZipMetaDataUrl({fileExtension:ne,item:d,mediaServiceMetadata:re}),Te=L.getDownloadZipContentsUrl(d);if(xe&&Te){se=m.e.Media;le.zip={zipMetaDataUrl:xe,downloadZipContentsUrl:Te}}}var Ne,Ce,ke,Le,Ae,Oe,Me={},_e=L.getDownloadAsZipUrl(d),De=Object(S.isFeatureEnabled)(S.EnableOpenInImmersiveReader)&&L.getImmersiveReaderUrl({fileExtension:ne,item:d});_e&&(Me[s.t.downloadAsZip]=_e);De&&(Me[s.t.immersiveReaderUrl]=De);ge&&(Me[s.t.itemUrl]=ge);var Pe=this._listContext,He=Number(d.File_x0020_Size)||Number(d.FileSizeDisplay)||void 0,Be=re&&re.video,je=".ts"===ne&&He<1<<19&&!Be;je&&(se=m.e.File);var Fe=re&&re.media,Ie=ee.fullItemUrl,qe=Ie?c.e(Ie):void 0;if(se===m.e.Folder)Ne=d.ProgId&&"sharepoint.documentset"===d.ProgId.toLowerCase();else if(se!==m.e.Media&&!re||Object(k.o)(Q))se===m.e.File&&Pe&&void 0!==Pe.isDocLib&&!Pe.isDocLib&&(Ce={});else{var Re=l.t(ne),Ue=re&&re.photo||(Se||"photo"===Re?{}:void 0),ze=Be||("video"===Re?{}:void 0),We=re&&re.audio||("audio"===Re?{}:void 0);if(Ue){ke={originalUrl:P.optional("photo"===Re?qe:void 0),width:Ue.width||0,height:Ue.height||0};Object(S.isFeatureEnabled)(S.Image360Viewer)&&he&&(Le=this._getImage360(d,re,Ue,ie))}ze&&(Ae={fourCC:P.optional(ze.fourCC||(".mp4"===ne.toLowerCase()?"H264":void 0)),bitrate:P.optional(ze.encodingBitrate),width:ze.frameWidth||0,height:ze.frameHeight||0,duration:K(Fe&&Fe.duration),audioFormat:P.optional(We&&We.format),manifestMetadata:ze.manifestMetadata,altManifestMetadata:ze.altManifestMetadata});We&&(Oe={duration:K(Fe&&Fe.duration)})}var Xe=Fe&&Fe.title;le.caption=P.optional(Xe);le.photo=P.optional(ke);le.image360=P.optional(Le);le.video=P.optional(Ae);le.audio=P.optional(Oe);le.listItem=P.optional(Ce);_&&(le.parentKey=_);le.isDocSet=P.optional(Ne);ee.serverRelativeItemUrl===ee.serverRelativeListUrl&&(le.isRootFolder=!0);var Ve,$e=I.e.getItemName(d,se,Pe);le.name=P.optional($e);le.displayName=P.optional($e);var Je,Ke=!0;if(d.Modified&&"21"===this._pageContext.webTemplate&&Object(S.isFeatureEnabled)(S.RequestDatesInUtc))try{var Qe=new Date(d.Modified);le.dateModifiedTime=Qe;le.dateModifiedValue=Qe.getTime();Ve=Object(g.s)(Qe);Ke=!1}catch(e){}if(Ke){le.dateModifiedValue=P.optional(d.Modified);Ve=d["Modified.FriendlyDisplay"]?Object(y.e)(d["Modified.FriendlyDisplay"]):d.Modified?""+d.Modified:""}le.dateModified=P.optional(Ve||void 0);le.permissions=P.optional(de);if(R&&j&&j.length>0)if(V){R[0]||(R[0]=[]);var Ge=R[0]&&R[0].length>0?R[0][R[0].length-1]:null,Ye=j[0],Ze=j[1];if(Ye&&"1"===d[Ye+".newgroup"]){var et=Ge?Ge.startIndex+Ge.count:0,tt=q.e.buildGroup(Pe,d,Ye,0,!1,et),nt=this._convertToODNGroup(tt);R[0].push(nt);Ge=nt}if(Ze&&"1"===d[Ze+".newgroup"]){var rt=Ge&&Ge.children&&Ge.children.length>0?Ge.children[Ge.children.length-1]:null;et=rt?rt.startIndex+rt.count:Ge?Ge.startIndex:0;q.e.buildGroup(Pe,d,Ze,1,!1,et,Ge);var it=Ge.children.pop();Ge.children.push(this._convertToODNGroup(it))}}else for(var st=0;st<j.length;st++){var ot=j[st];if(ot){var ut=R[st]&&R[st].length>0?R[st][R[st].length-1]:null;if("1"===d[ot+".newgroup"]){et=ut?ut.startIndex+ut.count:0,nt=q.e.buildGroup(Pe,d,ot,st,!1,et);R[st]||(R[st]=[]);R[st].push(this._convertToODNGroup(nt))}}}if(U&&U.length>0&&d.ContentTypeId)for(var at=0,ft=U;at<ft.length;at++){var lt=ft[at];if(d.ContentTypeId===lt.contentTypeId){Je=!1;if(lt.requiredFields)for(var ct=0,ht=lt.requiredFields.split(",");ct<ht.length;ct++){var pt=d[ht[ct]];if(!pt||Array.isArray(pt)&&0===pt.length){Je=!0;break}}}}le.hasMissingMetadata=P.optional(Je);le.contentTypeId=P.optional(d.ContentTypeId);var dt,vt,mt,gt,yt,bt=d.folder,wt=[];if(bt){le.folder={};le.isDropEnabled=!0;dt=[];if(bt.children){for(var Et=0,St=bt.children,xt=St.length,Tt=0,Nt=0;Nt<xt;Nt++){var Ct=this.getItemResult({requestKey:M,queryType:B,itemFromServer:St[Nt],groupBy:j,itemGroups:wt,contentTypes:U,listTemplateType:Q,supportsNestedGroups:V,isItemDataOnly:$,observer:G,isMetaDataSearch:Y,pageContext:e.pageContext});if(Ct){dt[Nt]=Ct.item;Tt<10&&Ct.itemType===m.e.Media&&Et++;Tt++}}xt>0&&(Et>=10||Et>=xt)&&(le.displayType=u.e.Photos)}}else{mt=(mt=d["serverurl.progid"])?mt.substring(1):qe;Me[s.t.original]=mt;if(Object(S.isFeatureEnabled)(S.ShortcutLink)&&w.e.isShortcutItem({key:fe,extension:ne})){se=m.e.Shortcut;if(d._ShortcutUrl){le.shortcutInfo={shortcutLinkRewritten:!0};Me[s.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,d._ShortcutUrl,d._ShortcutSiteId,d._ShortcutWebId,d._ShortcutUniqueId);d._ShortcutUniqueId&&(vt=o.previewImageUrl({url:d._ShortcutUrl,siteId:d._ShortcutSiteId,webId:d._ShortcutWebId,uniqueId:d._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{le.shortcutInfo=P.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(fe,e.itemFromServer.ID);Me[s.t.shortcutTarget]=a.t.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+N.e.encodeURIComponent(d.FileRef)}}Me[s.t.open]=mt;gt=d["File_x0020_Type.mapapp"]||d["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];if(ee.isCrossDomain&&ee.isCrossList){var kt=d[".fileType"],Lt=x.u(kt||"");gt=void 0===Lt?kt?void 0:gt:Lt;"OneNote.Notebook"===d.HTML_x0020_File_x0020_Type&&(gt="onenote|UsePlain");"pdf"===d.File_x0020_Type&&(gt=void 0)}le.size=P.optional(He);le.totalSize=P.optional(Number(d.SMTotalSize)||void 0);vt||(vt=this._getThumbnail({itemFromServer:d,listTemplateType:Q,extension:ne,key:fe,type:se,mediaServiceFastMetadata:re,microServiceDataSource:L,pageContext:e.pageContext}));le.openUrl=mt;var At=d["IconOverlay.mapoly"];At&&(le.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+At);le.thumbnail=vt;var Ot=this._getPdfConversionFacet({extension:ne,blockDownload:me,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re});Ot&&(le.pdfConversion=Ot);var Mt=this._get3dFacet({extension:ne,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re});Mt&&(le.model3d=Mt);if(se===m.e.Folder){var _t=Number(d.ItemChildCount)+Number(d.FolderChildCount);le.childCount=_t;var Dt=Number(d.SMTotalFileCount);le.folder={totalCount:Dt>0?Dt:_t,childCount:_t};le.isDropEnabled=!0}var Pt=d.ServerRedirectedEmbedUrl;Pt&&(this._itemUrlHelper.getUrlParts({path:Pt}).isCrossDomain||(yt=Pt))}le.previewIFrameUrl=yt;le.type=se;le.appMap=P.optional(gt);this._pageContext.blockDownloadsExperienceEnabled&&(le.type===m.e.Media||mt&&gt)?le.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&se!==m.e.Folder?le.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(le.itemStatus=4);var Ht={};for(var Bt in d)d.hasOwnProperty(Bt)&&(Ht[Bt]=d[Bt]);var jt=C.e.normalizeLower(d.UniqueId)||void 0;jt&&(Ht.uniqueId=jt);var Ft=d.RemoteItem;le.remoteItem=Ft&&JSON.parse(Ft);le.reputationProperties=this.getReputationProperties(d);var It,qt=$e;ne&&(qt=$e.substring(0,$e.toLowerCase().lastIndexOf(ne.toLowerCase())));le.sharingRole=0;It=Number(d.PrincipalCount)>0?h.e.Shared:void 0===d.PrincipalCount?S.isOneDrive?void 0:h.e.Unknown:h.e.Private;le.sharingType=P.optional(It);Ht.FileName=qt;var Rt=l.n({extension:ne,isDocSet:Ne,listItem:Ce,sharingType:It,type:se,textEditorMimeType:je?"text/typescript":void 0,panorama:Le,isMountPoint:!!Ft});le.iconName=Rt;var Ut="ms-powerpoint"===gt,zt="ms-visio"===gt,Wt="ms-word"===gt;if(mt&&(Wt||"ms-excel"===gt||Ut||zt)){var Xt=this._getOfficeBundleFacet({isWord:Wt,extension:ne,itemUrlParts:ee,isPowerPoint:Ut,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re});!Xt||zt&&!this._allowWrsVisio||(le.officeBundle=Xt);Xt&&(Wt||Ut)&&(Me[s.t.viewInBrowser]=L.getPdfConversionUrl({fileExtension:ne,item:d,mediaServiceMetadata:re},!0));le.wopiFrameUrl=mt}le.defaultSubText=T.e(T.t(d.Editor));le.isPlaceholder=!d.PermMask;le.queryType=B;le.displayType=P.backup(le.queryType);le.isDraggable=le.queryType===u.e.Files;d.folder||(Ht.modifiedByUser=T.r(d.Editor));Ht.MediaServiceOCR=T.i(d.MediaServiceOCR);le.properties=Ht;le.lifeCycleStatus=P.optional(this._getItemLifeCycleStatus(d));le.comments={settings:W(d._CommentFlags)};le.urls=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Me),this._getVideoUrl({extension:ne,itemFromServer:d,microServiceDataSource:L,mediaServiceFastMetadata:re})),((p={})[s.t.mediaBaseUrl]=L.getMediaBaseUrl({fileExtension:ne,item:d,mediaServiceMetadata:re}),p));le.searchProperties={isMetadataSearch:Y};null==G||G.update([new D.e(fe).succeed({item:le})]);G&&Object(S.isFeatureEnabled)(S.ItemAnalytics)&&Object(S.isFeatureEnabled)(S.EnableTrendingSignalInListView)&&fe&&this.resources.consumeAsync(v).then(function(e){e.queueNewItem(fe)});var Vt=this._getGroupings({itemFromServer:d,supportsNestedGroups:V,groupBy:j,groups:wt}),$t=Vt.groupings,Jt=Vt.totalChildren;return{item:{key:fe},itemPatch:le,itemType:se,children:dt,groupings:$t,totalChildren:Jt,nextRequestToken:d.nextRequestToken}};t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;Object(S.isFeatureEnabled)(S.EnableATPFilesListView)&&0!==n&&3!==n&&(t.isMalwareDetected=!0);return t};t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,r=e.supportsNestedGroups,i=e.groupBy,s=e.groups,o=null,u=this._listContext.groupLevel,a=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==u)if(n.groups){var f=[],l=0;if(r){var c=q.e.buildCollapsedGroups(n.groups,this._listContext,i),h=c.groups,p=c.totalCount;f=h.map(function(e){return t._convertToODNGroup(e)});l=p}else for(var d=0,v=n.groups;d<v.length;d++){var m=v[d],g=i[u];if(m[g+".newgroup"]){var y=q.e.buildGroup(this._listContext,m,g,u,!0,l);f.push(this._convertToODNGroup(y));l+=y.count}}if(f&&f.length>0){o=[{name:void 0,itemGroups:f,isAllCollapsed:this.createObservable(!0)}];a=l}}else s&&s.length>0&&s[u]&&s[u].length>0&&(o=[{name:void 0,itemGroups:s[u],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:a}};t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,r=[],i=n.folder.children,s=n.nextRequestToken?2:0,o=i.length+s,u=0;u<o;u++){var a=i[u];if(a){if(!(this._getItemTypeOneNoteOrFolder(a)===m.e.Folder)){t=u;break}}}(void 0===t&&o>0||t>0)&&r.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&r.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return r.length?[{name:"FoldersDocumentsPhotos",itemGroups:r,isAllCollapsed:this.createObservable(!1)}]:void 0};t.prototype._getImage360=function(e,t,n,r){var i,s=t&&t.panorama,o=!1;if(s&&"equirectangular"===s.projectionType){i={projectionType:s.projectionType};o=!0}else e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0);if(o&&r){var u=r.panorama;if(u)i={projectionType:P.optional(s.projectionType||void 0),croppedAreaImageHeightPixels:P.optional(u.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:P.optional(u.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:P.optional(u.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:P.optional(u.croppedAreaTopPixels||void 0),fullPanoHeightPixels:P.optional(u.fullPanoHeightPixels||void 0),fullPanoWidthPixels:P.optional(u.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:P.optional(u.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:P.optional(u.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:P.optional(u.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:P.optional(u.initialViewPitchDegrees||void 0),initialViewRollDegrees:P.optional(u.initialViewRollDegrees||void 0),poseHeadingDegrees:P.optional(u.poseHeadingDegrees||void 0),posePitchDegrees:P.optional(u.posePitchDegrees||void 0),poseRollDegrees:P.optional(u.poseRollDegrees||void 0)};else{var a=r.photo;if(a&&a.cameraModel){var f=a.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro â€“ 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(f)>=0&&(i={projectionType:"equirectangular"})}}}return i};t.prototype.getReputationProperties=function(e){for(var t={},n=0,r=f;n<r.length;n++){var i=r[n];t[i]=P.optional(e[i])}return t};t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&V.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}};t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=U.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}};t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,r=e.itemUrlParts,i=e.isPowerPoint,s=e.itemFromServer,o=e.microServiceDataSource,u=e.mediaServiceFastMetadata,a=r.isCrossDomain;if(!a&&("21"===this._pageContext.webTemplate||Object(S.isFeatureEnabled)(S.EnableWrsPreviewOutsideODB))){var f,l,c,h=!a&&(t&&Object(S.isFeatureEnabled)(S.EnableWordWrsPreview)||i&&Object(S.isFeatureEnabled)(S.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:s,mediaServiceMetadata:u}):"",d=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:s,mediaServiceMetadata:u}),v=!1,m="",g=s[".ctag"],y=u&&u.officeBundle;if(y){f=y.ctag;c=y.version;v=y.fatalError||!1;y.generationTime&&(l=new Date(y.generationTime));m=y.errorInfo||""}return{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:d,bundleCTag:f,bundleVersion:c,hasBundleGenerationFailed:v,bundleErrorInfo:m,generationTime:l,cTag:g,enableDefaultClick:h}}};t.prototype._getThumbnail=function(e){if(e.type!==m.e.Folder){var t=e.itemFromServer;if(Object(k.o)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===k.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(A.e)(e.extension)){if(this._listContext.remoteParentWeb){var r=new a.t(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(a.e.authority),i=encodeURI(t.FileRef);return o.previewImageUrlFromUrl(N.e.encodeURIComponent(r+i),this._pageContext.webAbsoluteUrl,this._pageContext)}var s=e.pageContext;return $&&s&&s.webAbsoluteUrl&&s.siteId&&s.webId?o.previewImageUrlFromProps(s.siteId,s.webId,t.UniqueId,s.webAbsoluteUrl,s):o.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};t&&(n[s.t.video]=t);return n};t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,r=e.microServiceDataSource,i=e.mediaServiceFastMetadata,s=this._getItemTypeOneNoteOrFolder(t);if(s===m.e.Unknown){var o=t.File_x0020_Type,u=o?"."+o:"";if(Object(S.isFeatureEnabled)(S.ShortcutLink)&&w.e.isShortcutFileType(o))return m.e.Shortcut;if(Object(S.isFeatureEnabled)(S.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:u,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:r})))return m.e.Media;if(this._get3dFacet({itemFromServer:t,extension:u,microServiceDataSource:r,mediaServiceFastMetadata:i}))return m.e.Media;if("audio"===l.t(u))return m.e.Media;if(i)return m.e.Media;if((s=l.r(u))===m.e.Unknown)return Object(k.s)(n)?m.e.File:Object(k.o)(n)?m.e.Media:s}return s||m.e.File};t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=m.e.Folder;else if("1"===e.FSObjType||e.RemoteItem){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r=e["File_x0020_Type.mapapp"];t=r&&"onenote"===r.substring(0,7)||n&&-1!==n.indexOf("onenote")?m.e.OneNote:m.e.Folder}else t=m.e.Unknown;return t};t.prototype._convertToODNGroup=function(e){var t=this,n=e;n.state=this.createObservable({isCollapsed:e.isCollapsed});n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return n};t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;if("&"===e[1]){this._htmlDecodeDiv.innerHTML=e;t=this._htmlDecodeDiv.innerText}return JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{pageContext:O.h,urlDataSource:L.ve,listContext:O.o,navigation:_.e,microServiceDataSource:j.e,vroomUrlHelper:B.e,itemUrlHelper:H.o,vroomDataContext:M.e.optional,shortcutLinkDataSource:b.e});return t})(i.n);function K(e){return"number"==typeof e?e/1e4:e}var Q=Object(d.s)("ListItemBuilder",J)},3667:function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return j});var r=n(0),i=n(894),s=n(10),o=n(210),u=n(1),a=n(177),f=n(585),l=n(773),c=n(389),h=n(1095),p=n(57),d=n(132),v=n(498),m=n(412),g=n(15),y=n(26),b=n(286),w=n(3080),E=n(1146),S=n(550),x=n(1196),T=n(703),N=n(420),C=n(1284),k=n(152),L=n(2162),A=n(455),O=n(2),M=n(23),_=n(14),D=n(652),P=_.e.isActivated("191A252F-AEC7-4D12-808A-EC962D5DE884","10/26/2021","Assign spWeb parent to root IOneDriveItems"),H=_.e.isActivated("9814CFF0-F58E-4ADD-A122-497BD64443E9","10/27/2021","Generated the KO store key from the itemKey, not the defaultItemSetKey"),B=_.e.isActivated("85FD492D-7BC4-4F39-9DA3-4AC03BAAD99B","11/08/2021","Use the appropriate MicroServiceDataSource instance belonging to an spItem root, not the global data source"),j=new s.t({name:"OneDriveItemControlHandler",factory:{dependencies:{listItemBuilder:w.e,microServiceDataSourceStore:D.e},create:function(e){var t=e.listItemBuilder,n=e.microServiceDataSourceStore;return{instance:function(e,s){var w,S=s.itemKey;if(!s.item)return{};var x=e.demandItemFacet(u.pt,S),N=e.demandItemFacet(f.e,S),_=e.demandItemFacet(l.e,S),D=e.demandItemFacet(c.e,S),j=e.demandItemFacet(m.e,S),I=e.demandItemFacet(v.e,S),q=e.demandItemFacet(h.e,S),R=e.demandItemFacet(g.c,S),U=e.demandItemFacet(u.At,S),z=e.demandItemFacet(b.t,H?Object(i.e)(e,{itemKey:S}):S),W={};W.permissions=Object(r.__assign)({},x);if(N||_||D||q||R||I||j){if(N){var X=Object(M.e)(e,{enableLibrariesDropdown:u.j}).enableLibrariesDropdown;W.queryType=W.displayType=X?y.e.DefaultDocLib:y.e.DocumentLibraries;W.subsite={serverRelativeUrl:N.webAbsoluteUrl}}else if(_){W.queryType=W.displayType=y.e.DocumentLibraries;W.subsite={serverRelativeUrl:_.webAbsoluteUrl}}else if(D)W.queryType=W.displayType=y.e.Subsites;else if(I||j)W.queryType=W.displayType=y.e.Search;else if(R){var V=R.queryType;W.queryType=W.displayType=V}W.folder={};W.type=o.e.Folder}W.error=(function(e,t){var n=e.demandItemFacet(k.e,t);if(!n)return;if(!(n instanceof A.e))return;var r=Object(O.r)({errorData:u.Wt},n.facets).errorData,i=parseInt((r.code||"").split(",")[0],10);if(isNaN(i))return;var s=r&&r.correlationId,o={ItemNotFoundTitle:L.l,ItemNotFoundSubText:L.f,InvalidViewTitle:L.a,InvalidViewSubText:L.u,InvalidListTitle:L.o,InvalidListSubText:L.s,QueryThrottledSubText:L.h,QueryThrottledLinkText:L.c,FailedOfflineTitle:L.i,FailedOfflineSubText:L.r,DefaultTitle:L.n,DefaultSubText:L.t};return{type:2,data:Object(C.e)(i,o,s)}})(e,S);if(z){var $=z.key,J=e.demandItemFacet(p.e,S),K=void 0;if(!B){var Q=J&&p.e.serialize({webAbsoluteUrl:J.webAbsoluteUrl,listFullUrl:J.listFullUrl,rootFolder:""}),G=e.demandItemFacet(b.t,Q,{suppressGetItems:!0}),Y=null==G?void 0:G.key;K=Y&&n.getOrCreateMicroServiceDataSource(Y)}var Z=J?e.demandItemFacet(u.ln,T.e.serialize(J)):void 0;if(U){var ee=t.getItemResult({itemFromServer:Object(r.__assign)({},U),requestKey:$,pageContext:Z,queryType:y.e.Files,supportsNestedGroups:!1,microServiceDataSource:K}).itemPatch;W=Object(E.default)(W,ee)}if(e.demandItemFacet(u.Pe,S)&&J){var te=d.e.serialize(J),ne=e.demandItemFacet(u.Re,te);if(ne){var re=F(e.demandItemFacet(a.t,te)),ie=re.sessionToken,se=re.sessionTokenV21,oe=re.driveId;if(!ie&&!se){var ue=null==Z?void 0:Z.driveInfo;ue&&(ie=(w=F(ue)).sessionToken,se=w.sessionTokenV21,oe=w.driveId)}W=Object(E.default)(W,{itemId:E.backup("root"),graph:{itemId:E.backup("root"),driveId:oe,sessionToken:E.optional(ie),sessionTokenV21:E.optional(se)},type:o.e.Folder,name:E.optional(ne.title),displayName:E.optional(ne.title),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:E.optional(J&&J.rootFolder?void 0:ne.newWOPIDocumentEnabled),list:ne,properties:{commandsSupported:E.optional(ne.canShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}})}if(!P){var ae=f.e.serialize({webAbsoluteUrl:J.webAbsoluteUrl}),fe=e.demandItemFacet(b.t,ae,{suppressGetItems:!0}),le=fe&&fe.key;le&&(W=Object(E.default)(W,{parentKey:le}))}}}return{item:W}}}}}});function F(e){var t,n,r,i=e[".driveAccessTokenV21"],s=void 0===i?void 0:i,o=e[".driveAccessToken"],u=void 0===o?void 0:o,a=e[".driveUrl"],f=void 0===a?void 0:a,l=e[".driveUrlV21"],c=void 0===l?void 0:l;if(u){t={accessToken:(h=Object(S.e)(u)).access_token,proofToken:h.prooftoken,tokenUrl:f};if(f){(p=Object(N.e)(f))&&(r=p.driveId)}}if(s){var h;n={accessToken:(h=Object(S.e)(s)).access_token,proofToken:h.prooftoken,tokenUrl:c};if(c&&!r){var p;(p=Object(N.e)(c))&&(r=p.driveId)}}t&&Object(x.e)({authToken:t.accessToken,proofToken:t.proofToken})&&(t=void 0);n&&Object(x.e)({authToken:n.accessToken,proofToken:n.proofToken})&&(n=void 0);return{driveId:r,sessionToken:t,sessionTokenV21:n}}}}]);